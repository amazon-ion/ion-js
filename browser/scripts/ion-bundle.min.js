!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ion=e()}(function(){return function n(i,s,a){function o(t,e){if(!s[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=s[t]={exports:{}},i[t][0].call(r.exports,function(e){return o(i[t][1][e]||e)},r,r.exports,n,i,s,a)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)o(a[e]);return o}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AbstractWriter=void 0;const n=e("./IonTypes");r.AbstractWriter=class{constructor(){this._annotations=[]}addAnnotation(e){if(!this._isString(e))throw new Error("Annotation must be of type string.");this._annotations.push(e)}setAnnotations(e){if(null==e)throw new Error("Annotations were undefined or null.");if(!this._validateAnnotations(e))throw new Error("Annotations must be of type string[].");this._annotations=e}writeValues(e){this._writeValues(e)}writeValue(e){this._writeValue(e)}_clearAnnotations(){this._annotations=[]}_writeValues(e){let t=e.type();for(null===t&&(t=e.next());null!==t;)this._writeValue(e),t=e.next()}_writeValue(e){var t=e.type();if(null!==t){if(this._isInStruct()){var r=e.fieldName();if(null===r)throw new Error("Cannot call writeValue() when the Writer is in a Struct but the Reader is not.");this.writeFieldName(r)}if(this.setAnnotations(e.annotations()),e.isNull())this.writeNull(t);else{switch(t){case n.IonTypes.BOOL:this.writeBoolean(e.booleanValue());break;case n.IonTypes.INT:this.writeInt(e.bigIntValue());break;case n.IonTypes.FLOAT:this.writeFloat64(e.numberValue());break;case n.IonTypes.DECIMAL:this.writeDecimal(e.decimalValue());break;case n.IonTypes.TIMESTAMP:this.writeTimestamp(e.timestampValue());break;case n.IonTypes.SYMBOL:this.writeSymbol(e.stringValue());break;case n.IonTypes.STRING:this.writeString(e.stringValue());break;case n.IonTypes.CLOB:this.writeClob(e.uInt8ArrayValue());break;case n.IonTypes.BLOB:this.writeBlob(e.uInt8ArrayValue());break;case n.IonTypes.LIST:this.stepIn(n.IonTypes.LIST);break;case n.IonTypes.SEXP:this.stepIn(n.IonTypes.SEXP);break;case n.IonTypes.STRUCT:this.stepIn(n.IonTypes.STRUCT);break;default:throw new Error("Unrecognized type "+(null!==t?t.name:t))}t.isContainer&&(e.stepIn(),this._writeValues(e),this.stepOut(),e.stepOut())}}}_validateAnnotations(t){if(!Array.isArray(t))return!1;for(let e=0;e<t.length;e++)if(!this._isString(t[e]))return!1;return!0}_isString(e){return"string"==typeof e}}},{"./IonTypes":29}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BigIntSerde=void 0;class n{static toSignedIntBytes(e,t){let r=this.toUnsignedIntBytes(e);return 128<=r[0]&&((e=new Uint8Array(r.length+1)).set(r,1),r=e),t&&(r[0]+=128),r}static fromUnsignedBytes(t){let r=0n;for(let e=0;e<t.length;e++){var n=BigInt(t[e]);r=r<<this.BITS_PER_BYTE|n}return r}static toUnsignedIntBytes(t){var r=this.getUnsignedIntSizeInBytes(t=t<0n?-t:t),n=new Uint8Array(r);for(let e=r-1;0<=e;e--){var i=Number(t&this.BYTE_MAX_VALUE);t>>=this.BITS_PER_BYTE,n[e]=i}return n}static getUnsignedIntSizeInBytes(t){for(let e=0;e<this.SIZE_THRESHOLDS.length;e++){const r=this.SIZE_THRESHOLDS[e];if(t<=r)return e+1}let e=this.SIZE_THRESHOLDS.length,r=this.calculateSizeThreshold(e);for(;t>r;)e++,r=this.calculateSizeThreshold(e);return e}static calculateSizeThresholds(){var t=[];for(let e=1;e<=this.SERIALIZED_BIGINT_SIZES_TO_PRECOMPUTE;e++)t.push(this.calculateSizeThreshold(e));return t}static calculateSizeThreshold(e){return 2n**(BigInt(e)*this.BITS_PER_BYTE)-1n}}(r.BigIntSerde=n).SERIALIZED_BIGINT_SIZES_TO_PRECOMPUTE=64,n.BITS_PER_BYTE=8n,n.BYTE_MAX_VALUE=BigInt(255),n.SIZE_THRESHOLDS=n.calculateSizeThresholds()},{}],3:[function(e,t,r){"use strict";var i,n;Object.defineProperty(r,"__esModule",{value:!0}),r.ComparisonResult=r.ComparisonResultType=void 0,(n=i=r.ComparisonResultType||(r.ComparisonResultType={})).EQUAL="EQUAL",n.NOT_EQUAL="NOT_EQUAL",n.ERROR="ERROR";r.ComparisonResult=class{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i.EQUAL,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;this.result=e,this.message=t,this.actualIndex=r,this.expectedIndex=n}}},{}],4:[function(e,t,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.IntSize=void 0,(i=n=r.IntSize||(r.IntSize={}))[i.Number=0]="Number",i[i.BigInt=1]="BigInt",r.default=n},{}],5:[function(e,M,t){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=function(e){return e&&e.__esModule?e:{default:e}},s=(Object.defineProperty(t,"__esModule",{value:!0}),t.dom=t.IntSize=t.dumpPrettyText=t.dumpText=t.dumpBinary=t.makeBinaryWriter=t.makePrettyWriter=t.makeTextWriter=t.makeReader=void 0,s(e("./IntSize")));t.IntSize=s.default;const a=e("./IonBinaryReader"),o=e("./IonBinaryWriter"),l=e("./IonConstants"),u=e("./IonLocalSymbolTable"),h=e("./IonPrettyTextWriter"),_=e("./IonSpan"),c=e("./IonTextReader"),p=e("./IonTextWriter"),d=e("./IonUnicode"),T=e("./IonWriteable");function f(){return new p.TextWriter(new T.Writeable)}function m(e){return new h.PrettyTextWriter(new T.Writeable,e)}function y(){var e=u.defaultLocalSymbolTable();return new o.BinaryWriter(e,new T.Writeable)}function g(e,t){for(const r of t)O.Value.from(r).writeTo(e);return e.close(),e.getBytes()}t.makeReader=function(e,t){return"string"==typeof e?new c.TextReader(new _.StringSpan(e),t):function(t){if(!(t.length<4)){for(let e=0;e<4;e++)if(t[e]!==l.IVM.binary[e])return;return 1}}(e=new Uint8Array(e))?new a.BinaryReader(new _.BinarySpan(e),t):new c.TextReader(new _.StringSpan(d.decodeUtf8(e)),t)},t.makeTextWriter=f,t.makePrettyWriter=m,t.makeBinaryWriter=y,t.dumpBinary=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(y(),t)},t.dumpText=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d.decodeUtf8(g(f(),t))},t.dumpPrettyText=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d.decodeUtf8(g(m(),t))};var I=e("./IonCatalog"),w=(Object.defineProperty(t,"Catalog",{enumerable:!0,get:function(){return I.Catalog}}),e("./IonDecimal")),b=(Object.defineProperty(t,"Decimal",{enumerable:!0,get:function(){return w.Decimal}}),e("./IonLocalSymbolTable")),v=(Object.defineProperty(t,"defaultLocalSymbolTable",{enumerable:!0,get:function(){return b.defaultLocalSymbolTable}}),e("./IonType")),S=(Object.defineProperty(t,"IonType",{enumerable:!0,get:function(){return v.IonType}}),e("./IonTypes")),E=(Object.defineProperty(t,"IonTypes",{enumerable:!0,get:function(){return S.IonTypes}}),e("./IonSharedSymbolTable")),C=(Object.defineProperty(t,"SharedSymbolTable",{enumerable:!0,get:function(){return E.SharedSymbolTable}}),e("./IonTimestamp")),N=(Object.defineProperty(t,"TimestampPrecision",{enumerable:!0,get:function(){return C.TimestampPrecision}}),Object.defineProperty(t,"Timestamp",{enumerable:!0,get:function(){return C.Timestamp}}),e("./IonText")),A=(Object.defineProperty(t,"toBase64",{enumerable:!0,get:function(){return N.toBase64}}),e("./IonUnicode"));Object.defineProperty(t,"decodeUtf8",{enumerable:!0,get:function(){return A.decodeUtf8}});const O=r(e("./dom"));t.dom=O;var L=e("./dom"),V=(Object.defineProperty(t,"load",{enumerable:!0,get:function(){return L.load}}),Object.defineProperty(t,"loadAll",{enumerable:!0,get:function(){return L.loadAll}}),e("./events/IonEvent")),B=(Object.defineProperty(t,"IonEventType",{enumerable:!0,get:function(){return V.IonEventType}}),Object.defineProperty(t,"IonEventFactory",{enumerable:!0,get:function(){return V.IonEventFactory}}),e("./events/IonEventStream")),U=(Object.defineProperty(t,"IonEventStream",{enumerable:!0,get:function(){return B.IonEventStream}}),e("./events/EventStreamError")),R=(Object.defineProperty(t,"EventStreamError",{enumerable:!0,get:function(){return U.EventStreamError}}),e("./ComparisonResult"));Object.defineProperty(t,"ComparisonResult",{enumerable:!0,get:function(){return R.ComparisonResult}}),Object.defineProperty(t,"ComparisonResultType",{enumerable:!0,get:function(){return R.ComparisonResultType}})},{"./ComparisonResult":3,"./IntSize":4,"./IonBinaryReader":7,"./IonBinaryWriter":8,"./IonCatalog":9,"./IonConstants":10,"./IonDecimal":11,"./IonLocalSymbolTable":13,"./IonPrettyTextWriter":17,"./IonSharedSymbolTable":18,"./IonSpan":19,"./IonText":24,"./IonTextReader":25,"./IonTextWriter":26,"./IonTimestamp":27,"./IonType":28,"./IonTypes":29,"./IonUnicode":30,"./IonWriteable":31,"./dom":51,"./events/EventStreamError":52,"./events/IonEvent":53,"./events/IonEventStream":54}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TB_ANNOTATION=r.TB_STRUCT=r.TB_SEXP=r.TB_LIST=r.TB_BLOB=r.TB_CLOB=r.TB_STRING=r.TB_SYMBOL=r.TB_TIMESTAMP=r.TB_DECIMAL=r.TB_FLOAT=r.TB_NEG_INT=r.TB_INT=r.TB_BOOL=r.TB_NULL=r.LEN_NULL=r.LEN_VAR=r.LEN_MASK=r.BYTE_SHIFT=r.TYPE_SHIFT=r.BYTE_MASK=r.NIBBLE_MASK=void 0,r.NIBBLE_MASK=15,r.BYTE_MASK=255,r.TYPE_SHIFT=4,r.BYTE_SHIFT=8,r.LEN_MASK=15,r.LEN_VAR=14,r.LEN_NULL=15,r.TB_NULL=0,r.TB_BOOL=1,r.TB_INT=2,r.TB_NEG_INT=3,r.TB_FLOAT=4,r.TB_DECIMAL=5,r.TB_TIMESTAMP=6,r.TB_SYMBOL=7,r.TB_STRING=8,r.TB_CLOB=9,r.TB_BLOB=10,r.TB_LIST=11,r.TB_SEXP=12,r.TB_STRUCT=13,r.TB_ANNOTATION=14},{}],7:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.BinaryReader=void 0;const i=n(e("./IntSize")),s=e("./IonCatalog"),a=e("./IonConstants"),o=e("./IonLocalSymbolTable"),l=e("./IonParserBinaryRaw"),u=e("./IonSymbols"),h=e("./IonTypes"),_=e("./util");function c(e){switch(e){case 0:return h.IonTypes.NULL;case 1:return h.IonTypes.BOOL;case 2:case 3:return h.IonTypes.INT;case 4:return h.IonTypes.FLOAT;case 5:return h.IonTypes.DECIMAL;case 6:return h.IonTypes.TIMESTAMP;case 7:return h.IonTypes.SYMBOL;case 8:return h.IonTypes.STRING;case 9:return h.IonTypes.CLOB;case 10:return h.IonTypes.BLOB;case 11:return h.IonTypes.LIST;case 12:return h.IonTypes.SEXP;case 13:return h.IonTypes.STRUCT;default:return null}}r.BinaryReader=class{constructor(e,t){this._annotations=null,this._parser=new l.ParserBinaryRaw(e),this._cat=t||new s.Catalog,this._symtab=o.defaultLocalSymbolTable(),this._raw_type=-2}position(){return this._parser.source().position()}next(){if(this._annotations=null,-1===this._raw_type)return null;for(this._raw_type=this._parser.next();0===this.depth();this._raw_type=this._parser.next())if(7===this._raw_type){if(this._parser._getSid()!==a.IVM.sid)break;this._symtab=o.defaultLocalSymbolTable()}else{if(13!==this._raw_type)break;if(!this._parser.hasAnnotations())break;if(this._parser.getAnnotation(0)!==u.ion_symbol_table_sid)break;this._symtab=u.makeSymbolTable(this._cat,this,this._symtab)}return c(this._raw_type)}stepIn(){if(!c(this._raw_type).isContainer)throw new Error("Can't step in to a scalar value");this._parser.stepIn(),this._raw_type=-2}stepOut(){this._parser.stepOut(),this._raw_type=-2}type(){return c(this._raw_type)}depth(){return this._parser.depth()}fieldName(){return this.getSymbolString(this._parser.getFieldId())}hasAnnotations(){return this._parser.hasAnnotations()}annotations(){return this._loadAnnotations(),null!==this._annotations?this._annotations:[]}getAnnotation(e){return this._loadAnnotations(),this._annotations[e]}isNull(){return 0===this._raw_type||this._parser.isNull()}uInt8ArrayValue(){return this._parser.uInt8ArrayValue()}booleanValue(){return this._parser.booleanValue()}decimalValue(){return this._parser.decimalValue()}bigIntValue(){return this._parser.bigIntValue()}intSize(){return _.isSafeInteger(this.bigIntValue())?i.default.Number:i.default.BigInt}numberValue(){return this._parser.numberValue()}stringValue(){var e=this._parser;switch(c(this._raw_type)){case h.IonTypes.NULL:return null;case h.IonTypes.STRING:return this.isNull()?null:e.stringValue();case h.IonTypes.SYMBOL:if(this.isNull())return null;var t=e._getSid();if(null!==t)return this.getSymbolString(t)}throw new Error("Current value is not a string or symbol.")}timestampValue(){return this._parser.timestampValue()}value(){var e=this.type();if(e&&e.isContainer){if(this.isNull())return null;throw new Error("Unable to provide a value for "+e.name+" containers.")}switch(e){case h.IonTypes.NULL:return null;case h.IonTypes.BLOB:case h.IonTypes.CLOB:return this.uInt8ArrayValue();case h.IonTypes.BOOL:return this.booleanValue();case h.IonTypes.DECIMAL:return this.decimalValue();case h.IonTypes.INT:return this.bigIntValue();case h.IonTypes.FLOAT:return this.numberValue();case h.IonTypes.STRING:case h.IonTypes.SYMBOL:return this.stringValue();case h.IonTypes.TIMESTAMP:return this.timestampValue();default:throw new Error("There is no current value.")}}_loadAnnotations(){null===this._annotations&&(this._annotations=[],this._parser.getAnnotations().forEach(e=>{this._annotations.push(this.getSymbolString(e))}))}getSymbolString(e){let t=null;if(null===e)return null;if(0<e){if(void 0===(t=this._symtab.getSymbolText(e)))throw new Error("symbol is unresolvable")}else{if(0===e)throw new Error("Symbol ID zero is unsupported");if(e<0)throw new Error("Negative symbol ID: "+e+" is illegal.")}return t}}},{"./IntSize":4,"./IonCatalog":9,"./IonConstants":10,"./IonLocalSymbolTable":13,"./IonParserBinaryRaw":15,"./IonSymbols":22,"./IonTypes":29,"./util":55}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.NullNode=r.LeafNode=r.AbstractNode=r.BinaryWriter=void 0;var n,i,s=e("./AbstractWriter");const a=e("./BigIntSerde"),o=e("./IonLowLevelBinaryWriter"),l=e("./IonTimestamp"),u=e("./IonTypes"),h=e("./IonUnicode"),_=e("./IonWriteable"),c=e("./util"),p=new Uint8Array;(e=n=n||{})[e.VALUE=0]="VALUE",e[e.STRUCT_FIELD=1]="STRUCT_FIELD",e[e.STRUCT_VALUE=2]="STRUCT_VALUE",e[e.CLOSED=3]="CLOSED",(e=i=i||{})[e.NULL=0]="NULL",e[e.BOOL=1]="BOOL",e[e.POSITIVE_INT=2]="POSITIVE_INT",e[e.NEGATIVE_INT=3]="NEGATIVE_INT",e[e.FLOAT=4]="FLOAT",e[e.DECIMAL=5]="DECIMAL",e[e.TIMESTAMP=6]="TIMESTAMP",e[e.SYMBOL=7]="SYMBOL",e[e.STRING=8]="STRING",e[e.CLOB=9]="CLOB",e[e.BLOB=10]="BLOB",e[e.LIST=11]="LIST",e[e.SEXP=12]="SEXP",e[e.STRUCT=13]="STRUCT",e[e.ANNOTATION=14]="ANNOTATION";class d extends s.AbstractWriter{constructor(e,t){super(),this.datagram=[],this.containers=[],this.state=n.VALUE,this.symbolTable=e,this.writer=new o.LowLevelBinaryWriter(t)}getBytes(){return this.writer.getBytes()}writeBlob(e){c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.BLOB):this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.BLOB,this.encodeAnnotations(this._annotations),e))}writeBoolean(e){c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.BOOL):this.addNode(new I(this.writer,this.getCurrentContainer(),this.encodeAnnotations(this._annotations),e))}writeClob(e){c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.CLOB):this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.CLOB,this.encodeAnnotations(this._annotations),e))}writeDecimal(e){var t,r,n;c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.DECIMAL):(t=e.getExponent(),0n===(n=e.getCoefficient())&&!e.isNegative()&&0===t&&1===c._sign(t)?this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.DECIMAL,this.encodeAnnotations(this._annotations),new Uint8Array(0))):(n=(r=(e=e.isNegative())||0n!==n)?a.BigIntSerde.toSignedIntBytes(n,e):p,e=o.LowLevelBinaryWriter.getVariableLengthSignedIntSize(t)+(r?n.length:0),(e=new o.LowLevelBinaryWriter(new _.Writeable(e))).writeVariableLengthSignedInt(t),r&&e.writeBytes(n),this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.DECIMAL,this.encodeAnnotations(this._annotations),e.getBytes()))))}writeFloat32(t){if(c._assertDefined(t),this.checkWriteValue(),null===t)this.writeNull(u.IonTypes.FLOAT);else{let e;var r;e=Object.is(t,0)?new Uint8Array(0):(r=new ArrayBuffer(4),new DataView(r).setFloat32(0,t,!1),new Uint8Array(r)),this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.FLOAT,this.encodeAnnotations(this._annotations),e))}}writeFloat64(t){if(c._assertDefined(t),this.checkWriteValue(),null===t)this.writeNull(u.IonTypes.FLOAT);else{let e;var r;e=Object.is(t,0)?new Uint8Array(0):(r=new ArrayBuffer(8),new DataView(r).setFloat64(0,t,!1),new Uint8Array(r)),this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.FLOAT,this.encodeAnnotations(this._annotations),e))}}writeInt(e){c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.INT):this.addNode(new w(this.writer,this.getCurrentContainer(),this.encodeAnnotations(this._annotations),e))}writeNull(e){null==e&&(e=u.IonTypes.NULL),this.checkWriteValue(),this.addNode(new v(this.writer,this.getCurrentContainer(),e,this.encodeAnnotations(this._annotations)))}writeString(e){c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.STRING):this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.STRING,this.encodeAnnotations(this._annotations),h.encodeUtf8(e)))}writeSymbol(e){var t;c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.SYMBOL):(e=this.symbolTable.addSymbol(e),(t=new o.LowLevelBinaryWriter(new _.Writeable(o.LowLevelBinaryWriter.getUnsignedIntSize(e)))).writeUnsignedInt(e),this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.SYMBOL,this.encodeAnnotations(this._annotations),t.getBytes())))}writeTimestamp(e){var t,r;c._assertDefined(e),this.checkWriteValue(),null===e?this.writeNull(u.IonTypes.TIMESTAMP):((t=new o.LowLevelBinaryWriter(new _.Writeable(12))).writeVariableLengthSignedInt(e.getLocalOffset()),r=e.getDate(),t.writeVariableLengthUnsignedInt(r.getUTCFullYear()),e.getPrecision()>=l.TimestampPrecision.MONTH&&t.writeVariableLengthUnsignedInt(r.getUTCMonth()+1),e.getPrecision()>=l.TimestampPrecision.DAY&&t.writeVariableLengthUnsignedInt(r.getUTCDate()),e.getPrecision()>=l.TimestampPrecision.HOUR_AND_MINUTE&&(t.writeVariableLengthUnsignedInt(r.getUTCHours()),t.writeVariableLengthUnsignedInt(r.getUTCMinutes())),e.getPrecision()>=l.TimestampPrecision.SECONDS&&(t.writeVariableLengthUnsignedInt(e.getSecondsInt()),0!==(r=e._getFractionalSeconds()).getExponent())&&(t.writeVariableLengthSignedInt(r.getExponent()),0n!==r.getCoefficient())&&t.writeBytes(a.BigIntSerde.toSignedIntBytes(r.getCoefficient(),r.isNegative())),this.addNode(new b(this.writer,this.getCurrentContainer(),u.IonTypes.TIMESTAMP,this.encodeAnnotations(this._annotations),t.getBytes())))}stepIn(e){switch(this.checkWriteValue(),e){case u.IonTypes.LIST:case u.IonTypes.SEXP:this.addNode(new m(this.writer,this.getCurrentContainer(),e,this.encodeAnnotations(this._annotations)));break;case u.IonTypes.STRUCT:this.addNode(new y(this.writer,this.getCurrentContainer(),this.encodeAnnotations(this._annotations))),this.state=n.STRUCT_FIELD;break;default:throw new Error("Unrecognized container type")}}stepOut(){if(0===this.depth())throw new Error("Not currently in a container");if(this.state===n.STRUCT_VALUE)throw new Error("Cannot exit a struct with a partially written field");this.containers.pop(),0<this.depth()?this.state=this.getCurrentContainer()instanceof y?n.STRUCT_FIELD:n.VALUE:this.state=n.VALUE}_isInStruct(){return this.getCurrentContainer()instanceof y}writeFieldName(e){if(c._assertDefined(e),this.state!==n.STRUCT_FIELD)throw new Error("Cannot write a field name outside of a struct");this.fieldName=this.encodeAnnotations([e]),this.state=n.STRUCT_VALUE}depth(){return this.containers.length}close(){if(this.checkClosed(),0<this.depth())throw new Error("Writer has one or more open containers; call stepOut() for each container prior to close()");this.writeIvm();var e=this.datagram;this.datagram=[],this.writeSymbolTable();for(const t of e)t.write();this.state=n.CLOSED}writeIvm(){this.writer.writeByte(224),this.writer.writeByte(1),this.writer.writeByte(0),this.writer.writeByte(234)}encodeAnnotations(e){if(0===e.length)return new Uint8Array(0);var t=new _.Writeable,r=new o.LowLevelBinaryWriter(t);for(const i of e){var n=this.symbolTable.addSymbol(i);r.writeVariableLengthUnsignedInt(n)}return this._clearAnnotations(),t.getBytes()}getCurrentContainer(){return this.containers[this.containers.length-1]}addNode(e){0===this.depth()?this.datagram.push(e):this.state===n.STRUCT_VALUE?(this.getCurrentContainer().addChild(e,this.fieldName),this.state=n.STRUCT_FIELD):this.getCurrentContainer().addChild(e),e.isContainer()&&(this.containers.push(e),this.state=n.VALUE)}checkWriteValue(){if(this.checkClosed(),this.state===n.STRUCT_FIELD)throw new Error("Expected a struct field name instead of a value, call writeFieldName(string) with the desired name before calling stepIn(IonType) or writeIonType()")}checkClosed(){if(this.state===n.CLOSED)throw new Error("Writer is closed, no further operations are available")}writeSymbolTable(){var e="$ion"!=this.symbolTable.import.symbolTable.name,t=0<this.symbolTable.symbols.length;if(e||t){if(this.setAnnotations(["$ion_symbol_table"]),this.stepIn(u.IonTypes.STRUCT),e&&(this.writeFieldName("imports"),this.stepIn(u.IonTypes.LIST),this.writeImport(this.symbolTable.import),this.stepOut()),t){this.writeFieldName("symbols"),this.stepIn(u.IonTypes.LIST);for(const r of this.symbolTable.symbols)void 0!==r&&this.writeString(r);this.stepOut()}this.stepOut(),this.datagram[0].write()}}writeImport(e){e&&(this.writeImport(e.parent),this.stepIn(u.IonTypes.STRUCT),this.writeFieldName("name"),this.writeString(e.symbolTable.name),this.writeFieldName("version"),this.writeInt(e.symbolTable.version),this.writeFieldName("max_id"),this.writeInt(e.length),this.stepOut())}}r.BinaryWriter=d;class T{constructor(e,t,r,n){this._writer=e,this.parent=t,this._type=r,this.annotations=n}get typeCode(){return this._type.binaryTypeId}get writer(){return this._writer}static getLengthLength(e){return e<14?0:o.LowLevelBinaryWriter.getVariableLengthUnsignedIntSize(e)}writeTypeDescriptorAndLength(e,t,r){let n=e<<4;t?(n|=15,this.writer.writeByte(n)):r<14?(n|=r,this.writer.writeByte(n)):(n|=14,this.writer.writeByte(n),this.writer.writeVariableLengthUnsignedInt(r))}getContainedValueLength(){var e=this.getValueLength();return 1+T.getLengthLength(e)+e}getAnnotatedContainerLength(){var e=this.annotations.length;return e+o.LowLevelBinaryWriter.getVariableLengthUnsignedIntSize(e)+this.getContainedValueLength()}getAnnotationsLength(){var e,t,r;return this.hasAnnotations()?(e=this.annotations.length,t=o.LowLevelBinaryWriter.getVariableLengthUnsignedIntSize(e),r=this.getContainedValueLength(),1+T.getLengthLength(r+e+t)+t+e):0}getLength(){return this.getAnnotationsLength()+this.getContainedValueLength()}writeAnnotations(){var e;this.hasAnnotations()&&(e=this.getAnnotatedContainerLength(),this.writeTypeDescriptorAndLength(i.ANNOTATION,!1,e),this.writer.writeVariableLengthUnsignedInt(this.annotations.length),this.writer.writeBytes(new Uint8Array(this.annotations)))}hasAnnotations(){return 0<this.annotations.length}}class f extends(r.AbstractNode=T){constructor(e,t,r,n){super(e,t,r,n)}isContainer(){return!0}}class m extends f{constructor(e,t,r,n){super(e,t,r,n),this.children=[]}addChild(e,t){this.children.push(e)}write(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.getValueLength());for(const e of this.children)e.write()}getValueLength(){let e=0;for(const t of this.children)e+=t.getLength();return e}getLength(){return void 0===this.length&&(this.length=super.getLength()),this.length}}class y extends f{constructor(e,t,r){super(e,t,u.IonTypes.STRUCT,r),this.fields=[]}addChild(e,t){if(null==t)throw new Error("Cannot add a value to a struct without a field name");this.fields.push({name:t,value:e})}getValueLength(){let e=0;for(const t of this.fields)e=(e+=t.name.length)+t.value.getLength();return e}getLength(){return void 0===this.length&&(this.length=super.getLength()),this.length}write(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.getValueLength());for(const e of this.fields)this.writer.writeBytes(new Uint8Array(e.name)),e.value.write()}}class g extends T{addChild(e,t){throw new Error("Cannot add a child to a leaf node")}isContainer(){return!1}}class I extends(r.LeafNode=g){constructor(e,t,r,n){super(e,t,u.IonTypes.BOOL,r),this.value=n}write(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.value?1:0)}getValueLength(){return 0}}class w extends g{constructor(t,e,r,n){if(super(t,e,u.IonTypes.INT,r),this.value=n,"number"!=typeof this.value&&"bigint"!=typeof this.value)throw new Error("Expected "+this.value+" to be a number or bigint");if(0n<this.value){this.intTypeCode=i.POSITIVE_INT;const t=new o.LowLevelBinaryWriter(new _.Writeable(o.LowLevelBinaryWriter.getUnsignedIntSize(this.value)));t.writeUnsignedInt(this.value),this.bytes=t.getBytes()}else if(this.value<0n){this.intTypeCode=i.NEGATIVE_INT;let e;e="bigint"==typeof n?n<0n?-n:n:Math.abs(n);const t=new o.LowLevelBinaryWriter(new _.Writeable(o.LowLevelBinaryWriter.getUnsignedIntSize(e)));t.writeUnsignedInt(e),this.bytes=t.getBytes()}else this.intTypeCode=i.POSITIVE_INT,this.bytes=new Uint8Array(0)}write(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.intTypeCode,!1,this.bytes.length),this.writer.writeBytes(this.bytes)}getValueLength(){return this.bytes.length}}class b extends g{constructor(e,t,r,n,i){super(e,t,r,n),this.value=i}write(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.value.length),this.writer.writeBytes(this.value)}getValueLength(){return this.value.length}}class v extends g{constructor(e,t,r,n){super(e,t,r,n)}write(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!0,0)}getValueLength(){return 0}}r.NullNode=v},{"./AbstractWriter":1,"./BigIntSerde":2,"./IonLowLevelBinaryWriter":14,"./IonTimestamp":27,"./IonTypes":29,"./IonUnicode":30,"./IonWriteable":31,"./util":55}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Catalog=void 0;const n=e("./IonSystemSymbolTable");r.Catalog=class{constructor(){this.symbolTables={},this.add(n.getSystemSymbolTable())}add(e){if(void 0===e.name||null===e.name)throw new Error("SymbolTable name must be defined.");void 0===this.symbolTables[e.name]&&(this.symbolTables[e.name]=[]),this.symbolTables[e.name][e.version]=e}getVersion(e,t){e=this.symbolTables[e];if(!e)return null;let r=e[t];return(r=r||e[e.length])||null}getTable(e){e=this.symbolTables[e];return void 0===e?null:e[e.length-1]}}},{"./IonSystemSymbolTable":23}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IVM=r.EOF=void 0,r.EOF=-1,r.IVM={text:"$ion_1_0",binary:new Uint8Array([224,1,0,234]),sid:2}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Decimal=void 0;const n=e("./util");class a{constructor(e,t){let r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e)return a.parse(e);if(!n._hasValue(t))throw new Error("Decimal's constructor was called with a numeric coefficient but no exponent.");if("number"==typeof e)return a._fromNumberCoefficient(e,t);if("bigint"==typeof e)return n._hasValue(r)?r!=e<0n&&(e*=-1n):r=e<0n,a._fromBigIntCoefficient(r,e,t);throw new Error(`Unsupported parameter set (${e}, ${t}, ${r} passed to Decimal constructor.`)}static _fromNumberCoefficient(e,t){var r;if(Number.isInteger(e))return r=e<0||Object.is(e,-0),this._fromBigIntCoefficient(r,BigInt(e),t);throw new Error("The provided coefficient was not an integer. ("+e+")")}static _fromBigIntCoefficient(e,t,r){var n=Object.create(this.prototype);return n._initialize(e,t,r),n}static parse(e){let t=0;if("null"===e||"null.decimal"===e)return null;var r=e.match("[d|D]");let n=e.length;null!=r&&(t=Number(e.substring(r.index+1,e.length)),n=r.index);var i=e.match("\\.");let s;s=i?(r=r?r.index-1-i.index:e.length-1-i.index,t-=r,e.substring(0,i.index)+e.substring(i.index+1,n)):e.substring(0,n);r=BigInt(s),i=r<0n||s.startsWith("-0");return a._fromBigIntCoefficient(i,r,t)}isNegative(){return this._isNegative}numberValue(){return this._isNegativeZero()?-0:Number(this._coefficient)*Math.pow(10,this._exponent)}intValue(){return Math.trunc(this.numberValue())}toString(){let e=this._coefficient.toString();var t=(e="-"===e[0]?e.substring(1,e.length):e).length,r=this._exponent+(t-1);let n="";return this._exponent<=0&&-6<=r?0===this._exponent?n+=e:e.length<=-this._exponent?(e="0".repeat(-this._exponent-e.length+1)+e,n+=e.substring(0,1)+"."+e.substring(1)):n+=e.substring(0,t+this._exponent)+"."+e.substring(t+this._exponent):(n+=e[0],1<e.length&&(n+="."+e.substring(1)),n+="E"+(0<r?"+":"")+r),(this.isNegative()?"-":"")+n}toJSON(){return this.numberValue()}getCoefficient(){return this._coefficient}getExponent(){return this._exponent}equals(e){return this.getExponent()===e.getExponent()&&n._sign(this.getExponent())===n._sign(e.getExponent())&&this.isNegative()===e.isNegative()&&this.getCoefficient()===e.getCoefficient()}compareTo(e){if(0n===this._coefficient&&0n===e._coefficient)return 0;var t=this.isNegative();if(t!==e.isNegative())return t?-1:1;let[r,n,i]=this._compareToParams(),[s,a,o]=e._compareToParams();if(o<i)return t?-1:1;if(i<o)return t?1:-1;r.length<s.length?r+="0".repeat(a-n):r.length>s.length&&(s+="0".repeat(n-a));var e=BigInt(r),l=BigInt(s);return l<e?t?-1:1:e<l?t?1:-1:0}_initialize(e,t,r){this._isNegative=e,this._coefficient=t,Object.is(-0,r)&&(r=0),this._exponent=r}_isNegativeZero(){return this.isNegative()&&0n==this._coefficient}_compareToParams(){var e=this.isNegative()?this._coefficient.toString().substring(1):this._coefficient.toString(),t=e.length;let r=t+this._exponent;return r<=0&&--r,[e,t,r=0n===this._coefficient?-1/0:r]}}(r.Decimal=a).ZERO=new a(0,0),a.ONE=new a(1,0)},{"./util":55}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Import=void 0;r.Import=class{constructor(e,t,r){this._parent=e,this._symbolTable=t,this._offset=this.parent?this.parent.offset+this.parent.length:1,this._length=r||this.symbolTable.numberOfSymbols}get parent(){return this._parent}get offset(){return this._offset}get length(){return this._length}get symbolTable(){return this._symbolTable}getSymbolText(e){if(void 0===this.parent)throw new Error("Illegal parent state.");if(null!==this.parent){var t=this.parent.getSymbolText(e);if(t)return t}t=e-this.offset;if(0<=t&&t<this.length)return this.symbolTable.getSymbolText(t)}getSymbolId(e){let t;return null!==this.parent&&(t=this.parent.getSymbolId(e))?t:null!==(t=this.symbolTable.getSymbolId(e))&&void 0!==t&&t<this.length?t+this.offset:void 0}}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultLocalSymbolTable=r.LocalSymbolTable=void 0;const n=e("./IonSystemSymbolTable");class i{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.index=Object.create(null),this._symbols=[],this._import=null===e?n.getSystemSymbolTableImport():e,this.offset=this._import.offset+this._import.length;for(const r of t)this.assignSymbolId(r)}get symbols(){return this._symbols}get maxId(){return this.offset+this._symbols.length-1}get import(){return this._import}getSymbolId(e){return this._import.getSymbolId(e)||this.index[e]}addSymbol(e){if(null!==e){var t=this.getSymbolId(e);if(void 0!==t)return t}t=this.offset+this.symbols.length;return this.symbols.push(e),null!==e&&(this.index[e]=t),t}assignSymbolId(e){var t=this.offset+this.symbols.length;return this.symbols.push(e),null!==e&&void 0===this.getSymbolId(e)&&(this.index[e]=t),t}getSymbolText(e){if(e>this.maxId)throw new Error("Symbol $"+e.toString()+" greater than maxID.");var t=this.import.getSymbolText(e);return void 0!==t?t:(t=e-this.offset,this.symbols[t])}numberOfSymbols(){return this._symbols.length}}r.LocalSymbolTable=i,r.defaultLocalSymbolTable=function(){return new i(n.getSystemSymbolTableImport())}},{"./IonSystemSymbolTable":23}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LowLevelBinaryWriter=void 0;const s=e("./BigIntSerde");class a{constructor(e){this.writeable=e}static getSignedIntSize(e){return 0===e?1:(e=Math.abs(e),e=Math.ceil(Math.log2(e+1)),Math.ceil((e+1)/8))}static getUnsignedIntSize(e){return"bigint"==typeof e?s.BigIntSerde.getUnsignedIntSizeInBytes(e):0===e?1:(e=Math.floor(Math.log2(e))+1,Math.ceil(e/8))}static getVariableLengthSignedIntSize(e){var t,e=Math.abs(e);return 0===e?1:(e=Math.floor(Math.log2(e))+1,t=Math.floor(e/7),Math.ceil((e+t+1+1)/8))}static getVariableLengthUnsignedIntSize(e){var t;return 0===e?1:(e=Math.floor(Math.log2(e))+1,t=Math.ceil(e/7),Math.ceil((e+t)/8))}writeSignedInt(e){var t=a.getSignedIntSize(e);let r=Math.abs(e);var n=new Uint8Array(t);let i=n.length;for(;128<=r;)n[--i]=255&r,r>>>=8;n[--i]=255&r,1/e<0&&(n[0]|=128),this.writeable.writeBytes(n)}writeUnsignedInt(r){if("bigint"==typeof r)n=s.BigIntSerde.toUnsignedIntBytes(r),this.writeable.writeBytes(n);else{var n=a.getUnsignedIntSize(r),i=new Uint8Array(n);let e=r,t=i.length;for(;0<e;)i[--t]=e%256,e=Math.trunc(e/256);this.writeable.writeBytes(i)}}writeVariableLengthSignedInt(e){var t=new Uint8Array(a.getVariableLengthSignedIntSize(e));let r=Math.abs(e),n=t.length-1;for(;64<=r;)t[n--]=127&r,r>>>=7;t[n]=r,1/e<0&&(t[n]|=64),t[t.length-1]|=128,this.writeable.writeBytes(t)}writeVariableLengthUnsignedInt(e){var t=new Uint8Array(a.getVariableLengthUnsignedIntSize(e));let r=e,n=t.length;for(t[--n]=127&r|128,r>>>=7;0<r;)t[--n]=127&r,r>>>=7;this.writeable.writeBytes(t)}writeByte(e){this.writeable.writeByte(e)}writeBytes(e){this.writeable.writeBytes(e)}getBytes(){return this.writeable.getBytes()}}r.LowLevelBinaryWriter=a},{"./BigIntSerde":2}],15:[function(e,t,r){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.ParserBinaryRaw=void 0;const o=e("./BigIntSerde"),l=s(e("./IonBinary"));s=e("./IonConstants");const _=e("./IonDecimal"),c=e("./IonTimestamp"),u=e("./IonTypes"),h=e("./IonUnicode"),p=a(e("./SignAndMagnitudeInt"));function d(e){return e>>l.TYPE_SHIFT&l.NIBBLE_MASK}const T=[],f=s.IVM.sid;s.IVM.binary[0];const m=s.IVM.binary[1],y=s.IVM.binary[2],g=s.IVM.binary[3];class I{constructor(e,t){this.type=e,this.length=t}}class w{constructor(e){this._raw_type=-1,this._len=-1,this._curr=void 0,this._null=!1,this._fid=null,this._as=-1,this._ae=-1,this._a=[],this._ts=[new I(20,0)],this._in_struct=!1,this._in=e}static _readFloatFrom(e,t){let r;switch(t){case 0:return 0;case 4:return(r=new DataView(e.chunk(4).buffer)).getFloat32(0,!1);case 8:return(r=new DataView(e.chunk(8).buffer)).getFloat64(0,!1);case 15:return null;default:throw new Error("Illegal float length: "+t)}}static _readVarUnsignedIntFrom(e){let t=0;var r;let n=0;for(;;)if(r=e.next(),n=n<<7|127&r,t+=7,128&r)break;if(31<t)throw new Error("VarUInt values larger than 31 bits must be read using SignAndMagnitudeInt.");return n}static _readVarSignedIntFrom(e){let t=e.next(),r;var n=64&t;let i=128&t,s=(t&=63,6);for(;!i;)r=e.next(),i=128&r,r&=127,t=t<<7|r,s+=7;if(32<s)throw new Error("VarInt values larger than 32 bits must be read using SignAndMagnitudeInt");return n?-t:t}static _readSignedIntFrom(e,t){var r;return 0==t?new p.default(0n):(t=128==(128&(e=e.view(t))[0]),(r=Array.prototype.slice.call(e))[0]=127&e[0],e=o.BigIntSerde.fromUnsignedBytes(r),new p.default(e,t))}static _readUnsignedIntAsBigIntFrom(e,t){return o.BigIntSerde.fromUnsignedBytes(Array.prototype.slice.call(e.view(t)))}static _readUnsignedIntAsNumberFrom(e,t){let r=0,n=0;var i,s=e.getRemaining();if(t<1)return 0;if(6<t)throw new Error(`Attempted to read a ${t}-byte unsigned integer,`+" which is too large for a to be stored in a number without losing precision.");if(s<t)throw new Error(`Attempted to read a ${t}-byte unsigned integer,`+` but only ${s} bytes were available.`);for(;n<t;)i=e.next(),n++,t<4?r<<=8:r*=256,r+=i;return r}static readDecimalValueFrom(e,t){var r=e.position(),n=w._readVarSignedIntFrom(e),t=t-(e.position()-r),r=w._readSignedIntFrom(e,t),e=r.isNegative,t=e?-r.magnitude:r.magnitude;return _.Decimal._fromBigIntCoefficient(e,t,n)}source(){return this._in}next(){return void 0===this._curr&&0<this._len&&this._in.skip(this._len),this.clear_value(),this._in_struct&&(this._fid=this.readVarUnsignedInt()),this.load_next()}stepIn(){var e,t=this;switch(t._raw_type){case l.TB_STRUCT:case l.TB_LIST:case l.TB_SEXP:break;default:throw new Error("you can only 'stepIn' to a container")}e=t._in.getRemaining()-t._len,e=new I(t._raw_type,e),t._ts.push(e),t._in_struct=t._raw_type===l.TB_STRUCT,t._in.setRemaining(t._len),t.clear_value()}stepOut(){var e,t,r=this;if(r._ts.length<2)throw new Error("Cannot stepOut any further, already at top level");e=r._ts.pop().length,t=r._ts[r._ts.length-1].type,r._in_struct=t===l.TB_STRUCT,r.clear_value(),t=r._in.getRemaining(),r._in.skip(t),r._in.setRemaining(e)}isNull(){return this._null}depth(){return this._ts.length-1}getFieldId(){return this._fid}hasAnnotations(){return 0<=this._as}getAnnotations(){return void 0!==this._a&&0!==this._a.length||this.load_annotation_values(),this._a}getAnnotation(e){return void 0!==this._a&&0!==this._a.length||this.load_annotation_values(),this._a[e]}ionType(){var e=this._raw_type;switch(e){case l.TB_NULL:return u.IonTypes.NULL;case l.TB_BOOL:return u.IonTypes.BOOL;case l.TB_INT:case l.TB_NEG_INT:return u.IonTypes.INT;case l.TB_FLOAT:return u.IonTypes.FLOAT;case l.TB_DECIMAL:return u.IonTypes.DECIMAL;case l.TB_TIMESTAMP:return u.IonTypes.TIMESTAMP;case l.TB_SYMBOL:return u.IonTypes.SYMBOL;case l.TB_STRING:return u.IonTypes.STRING;case l.TB_CLOB:return u.IonTypes.CLOB;case l.TB_BLOB:return u.IonTypes.BLOB;case l.TB_SEXP:return u.IonTypes.SEXP;case l.TB_LIST:return u.IonTypes.LIST;case l.TB_STRUCT:return u.IonTypes.STRUCT;default:throw new Error("Unrecognized type code "+e)}}_getSid(){return this.load_value(),this._raw_type!=l.TB_SYMBOL||void 0===this._curr||null===this._curr?null:this._curr}byteValue(){return this.uInt8ArrayValue()}uInt8ArrayValue(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_CLOB:case l.TB_BLOB:return this.isNull()?null:(this.load_value(),this._curr);default:throw new Error("Current value is not a blob or clob.")}}booleanValue(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_BOOL:return this.isNull()?null:this._curr}throw new Error("Current value is not a Boolean.")}decimalValue(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_DECIMAL:return this.isNull()?null:(this.load_value(),this._curr)}throw new Error("Current value is not a decimal.")}bigIntValue(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_INT:case l.TB_NEG_INT:var e;return this.isNull()?null:(this.load_value(),"bigint"!=typeof this._curr?(e=this._curr,BigInt(e)):this._curr);default:throw new Error("bigIntValue() was called when the current value was not an int.")}}numberValue(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_INT:case l.TB_NEG_INT:var e;return this.isNull()?null:(this.load_value(),"bigint"==typeof this._curr?(e=this._curr,Number(e)):this._curr);case l.TB_FLOAT:return this.isNull()?null:(this.load_value(),this._curr);default:throw new Error("Current value is not a float or int.")}}stringValue(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_STRING:case l.TB_SYMBOL:return this.isNull()?null:(this.load_value(),this._curr)}throw new Error("Current value is not a string or symbol.")}timestampValue(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_TIMESTAMP:return this.isNull()?null:(this.load_value(),this._curr)}throw new Error("Current value is not a timestamp.")}read_binary_float(){return w._readFloatFrom(this._in,this._len)}readVarUnsignedInt(){return w._readVarUnsignedIntFrom(this._in)}readVarSignedInt(){return w._readVarSignedIntFrom(this._in)}readUnsignedIntAsBigInt(){return w._readUnsignedIntAsBigIntFrom(this._in,this._len)}readUnsignedIntAsNumber(){return w._readUnsignedIntAsNumberFrom(this._in,this._len)}read_decimal_value(){return w.readDecimalValueFrom(this._in,this._len)}read_timestamp_value(){if(!(0<this._len))return null;let e,t=null,r=null,n=null,i=null,s=null,a=_.Decimal.ZERO,o=c.TimestampPrecision.YEAR;var l=this._in.position()+this._len,u=this.readVarSignedInt();if(!(this._in.position()<l))throw new Error("Timestamps must include a year.");if(e=this.readVarUnsignedInt(),this._in.position()<l&&(t=this.readVarUnsignedInt(),o=c.TimestampPrecision.MONTH),this._in.position()<l&&(r=this.readVarUnsignedInt(),o=c.TimestampPrecision.DAY),this._in.position()<l){if(n=this.readVarUnsignedInt(),this._in.position()>=l)throw new Error("Timestamps with an hour must include a minute.");i=this.readVarUnsignedInt(),o=c.TimestampPrecision.HOUR_AND_MINUTE}if(this._in.position()<l&&(s=this.readVarUnsignedInt(),o=c.TimestampPrecision.SECONDS),this._in.position()<l){var h=this.readVarSignedInt();let e=0n,t=!1;this._in.position()<l&&(l=w._readSignedIntFrom(this._in,l-this._in.position()),t=l._isNegative,e=l._magnitude);var l=_.Decimal._fromBigIntCoefficient(t,e,h),[,h]=c.Timestamp._splitSecondsDecimal(l);a=_.Decimal.parse(s+"."+h)}l=Date.UTC(e,t?t-1:0,r||1,n||0,i||0,s||0,0),l=c.Timestamp._adjustMsSinceEpochIfNeeded(e,l),h=new Date(l);return c.Timestamp._valueOf(h,u,a,o)}read_string_value(){return h.decodeUtf8(this._in.chunk(this._len))}clear_value(){this._raw_type=-1,this._curr=void 0,this._a=T,this._as=-1,this._null=!1,this._fid=null,this._len=-1}load_length(e){var t=this;switch(t._len=e&l.NIBBLE_MASK,t._len){case 1:d(e)===l.TB_STRUCT&&(t._len=this.readVarUnsignedInt()),t._null=!1;break;case l.LEN_VAR:t._null=!1,t._len=this.readVarUnsignedInt();break;case l.LEN_NULL:t._null=!0,t._len=0;break;default:t._null=!1}}load_next(){var e=this;let t,r;if(e._as=-1,!e._in.is_empty()){switch(r=e._in.next(),t=d(r),e.load_length(r),t=t===l.TB_ANNOTATION?e._len<1&&0===e.depth()?e.load_ivm():e.load_annotations():t){case l.TB_NULL:e._null=!0;break;case l.TB_BOOL:0!==e._len&&1!==e._len||(e._curr=1===e._len,e._len=0)}return e._raw_type=t}e.clear_value()}load_annotations(){var e=this;let t,r,n;return r=e._len<1&&0===e.depth()?e.load_ivm():(n=this.readVarUnsignedInt(),e._as=e._in.position(),e._in.skip(n),e._ae=e._in.position(),t=e._in.next(),e.load_length(t),d(t))}load_ivm(){var e=this._in;if(e.next()!==m)throw new Error("invalid binary Ion at "+e.position());if(e.next()!==y)throw new Error("invalid binary Ion at "+e.position());if(e.next()!==g)throw new Error("invalid binary Ion at "+e.position());return this._curr=f,this._len=0,l.TB_SYMBOL}load_annotation_values(){let e,t,r,n,i;if(!((r=this._as)<0)){for(i=[],n=this._ae,e=0;r<n;)if(t=this._in.valueAt(r),r++,e=e<<7|127&t,0!=(128&t)){if(0===e)throw new Error("Symbol ID zero is unsupported.");i.push(e),e=0}this._a=i}}_readIntegerMagnitude(){return 0===this._len?0n:this._len<6?this.readUnsignedIntAsNumber():this.readUnsignedIntAsBigInt()}load_value(){if(null==this._curr&&!this.isNull())switch(this._raw_type){case l.TB_BOOL:break;case l.TB_INT:this._curr=this._readIntegerMagnitude();break;case l.TB_NEG_INT:var e=this._readIntegerMagnitude();this._curr=-e;break;case l.TB_FLOAT:this._curr=this.read_binary_float();break;case l.TB_DECIMAL:0===this._len?this._curr=_.Decimal.ZERO:this._curr=this.read_decimal_value();break;case l.TB_TIMESTAMP:this._curr=this.read_timestamp_value();break;case l.TB_SYMBOL:this._curr=this.readUnsignedIntAsNumber();break;case l.TB_STRING:this._curr=this.read_string_value();break;case l.TB_CLOB:case l.TB_BLOB:this.isNull()||(this._curr=this._in.chunk(this._len));break;default:throw new Error("Unexpected type: "+this._raw_type)}}}r.ParserBinaryRaw=w},{"./BigIntSerde":2,"./IonBinary":6,"./IonConstants":10,"./IonDecimal":11,"./IonTimestamp":27,"./IonTypes":29,"./IonUnicode":30,"./SignAndMagnitudeInt":32}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ParserTextRaw=r.get_ion_type=void 0;const o=e("./IonText"),a=e("./IonSymbolToken"),n=e("./IonTypes"),i="/".charCodeAt(0),s='"'.charCodeAt(0);const l="{".charCodeAt(0);const u=s,h=[105,110,102];function _(e,t){return 13==e||10==e?t:!(!o.is_whitespace(e)&&e<32)}r.get_ion_type=function(e){switch(e){case-1:case-2:return null;case 1:return n.IonTypes.NULL;case 2:return n.IonTypes.BOOL;case 3:case 4:return n.IonTypes.INT;case 5:case 6:return n.IonTypes.FLOAT;case 7:return n.IonTypes.DECIMAL;case 8:return n.IonTypes.TIMESTAMP;case 9:case 10:case 11:return n.IonTypes.SYMBOL;case 12:case 13:return n.IonTypes.STRING;case 14:case 15:return n.IonTypes.CLOB;case 16:return n.IonTypes.BLOB;case 17:return n.IonTypes.SEXP;case 18:return n.IonTypes.LIST;case 19:return n.IonTypes.STRUCT;default:throw new Error("Unknown type: "+String(e)+".")}};r.ParserTextRaw=class{constructor(e){this._value_null=!1,this._curr_null=!1,this._read_value_helper_minus=function(e,t,r){let n,i=this._peek();105==i?(i=this._peek("inf"),o.isNumericTerminator(i)?n=this._read_minus_inf:t&&(n=this._read_operator_symbol)):o.is_digit(i)?n=this._read_number:t&&(n=this._read_operator_symbol),null!=n?(this._ops.unshift(n),this._unread(e)):this._error("operator symbols are not valid outside of sexps")},this._read_string_helper=function(e,t){var r;for(this._start=this._in.position();;)if(92==(r=this._read()))this._read_string_escape_sequence();else{if(r==e)break;if(!_(r,t))throw new Error("invalid character "+r+" in string")}},this._in=e,this._ops=[this._read_datagram_values],this._value_type=-2,this._value=[],this._start=-1,this._end=-1,this._esc_len=-1,this._curr=-1,this._ann=[],this._msg="",this._fieldname=null,this._fieldnameType=null;const i={40:this._read_value_helper_paren,91:this._read_value_helper_square,123:this._read_value_helper_curly,43:this._read_value_helper_plus,45:this._read_value_helper_minus,39:this._read_value_helper_single,34:this._read_value_helper_double};function t(e,t){let r=e.length,n;for(;0<r;)r--,n=e.charCodeAt(r),i[n]=t}t("0123456789",this._read_value_helper_digit),t("_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",this._read_value_helper_letter),t("!#%&*+-./;<=>?@^`|~",this._read_value_helper_operator),i[43]=this._read_value_helper_plus,i[45]=this._read_value_helper_minus,this._read_value_helper_helpers=i}fieldName(){return this._fieldname}fieldNameType(){return this._fieldnameType}source(){return this._in}annotations(){return this._ann}clearFieldName(){this._fieldname=null,this._fieldnameType=null}isNull(){return this._curr_null}bigIntValue(){if(this.isNull())return null;var e=this.get_value_as_string(this._curr).toLowerCase();switch(this._curr){case 3:case 4:return e.startsWith("-")?-BigInt(e.slice(1)):BigInt(e);default:throw new Error("intValue() was called when the current value was not an integer.")}}numberValue(){if(this.isNull())return null;var e=this.get_value_as_string(this._curr);switch(this._curr){case 3:case 4:return Number(BigInt(e));case 5:return Number(e);case 6:if("+inf"==e)return Number.POSITIVE_INFINITY;if("-inf"==e)return Number.NEGATIVE_INFINITY;if("nan"==e)return Number.NaN;default:throw new Error("can't convert to number")}}booleanValue(){if(this.isNull())return null;var e=this.get_value_as_string(2);if("true"===e)return!0;if("false"===e)return!1;throw new Error("Unrecognized Boolean value '"+e+"'")}get_value_as_string(t){let r,n,i="";switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:for(r=this._start;r<this._end;r++)i+=String.fromCharCode(this._in.valueAt(r));break;case 16:for(r=this._start;r<this._end;r++)n=this._in.valueAt(r),o.is_base64_char(n)&&(i+=String.fromCharCode(n));break;case 11:case 12:case 13:for(r=this._start;r<this._end;r++){let e=!1;if(92==(n=this._in.valueAt(r))&&(n=this._read_escape_sequence(r,this._end),r+=this._esc_len,e=!0),this.isHighSurrogate(n)){r++;let e=this._in.valueAt(r);if(92==e&&(e=this._read_escape_sequence(r,this._end),r+=this._esc_len),!this.isLowSurrogate(e))throw new Error("expected a low surrogate, but found: "+n);var s=n,a=e;i+=String.fromCodePoint(65536+((1023&s)<<10)+(1023&a))}else{if(this.isLowSurrogate(n))throw new Error("unexpected low surrogate: "+n);13===t&&39===n&&!e&&this.verifyTriple(r)?r=this._skip_triple_quote_gap(r,this._end,!0):0<=n&&(e?i+=String.fromCodePoint(n):(13===t&&13===n&&10===this._in.valueAt(r+1)&&(n=10,r++),i+=String.fromCharCode(n)))}}break;default:throw new Error("can't get this value as a string")}return i}get_value_as_uint8array(e){var t=[];switch(e){case 14:for(let e=this._start;e<this._end;e++){var r=this._in.valueAt(e);if(92===r)t.push(this.readClobEscapes(e,this._end)),e+=this._esc_len;else{if(!(r<128))throw new Error("Non-Ascii values illegal within clob.");t.push(r)}}break;case 15:for(let e=this._start;e<this._end;e++){var n=this._in.valueAt(e);if(92===n){var i=this.readClobEscapes(e,this._end);0<=i&&t.push(i),e+=this._esc_len}else if(39===n)this.verifyTriple(e)?e=this._skip_triple_quote_gap(e,this._end,!1):t.push(n);else{if(!(n<128))throw new Error("Non-Ascii values illegal within clob.");t.push(n)}}break;default:throw new Error("can't get this value as a Uint8Array")}return Uint8Array.from(t)}next(){this.clearFieldName(),this._ann=[],-2===this._value_type&&this._run(),this._curr=this._value_pop();let e;if(-2!==this._curr)return e=this._curr,this._curr_null=this._value_null,this._value_null=!1,e;this._value.push(-2)}_read_datagram_values(){-1==this._peek()?this._value_push(-1):(this._ops.unshift(this._read_datagram_values),this._ops.unshift(this._read_value))}_read_sexp_values(){var e=this._read_after_whitespace(!0);if(41==e)this._value_push(-1);else{if(-1===e)throw new Error("Expected closing ).");this._unread(e),this._ops.unshift(this._read_sexp_values),this._ops.unshift(this._read_sexp_value)}}_read_list_values(){var e=this._read_after_whitespace(!0);93==e?this._value_push(-1):(this._unread(e),this._ops.unshift(this._read_list_comma),this._ops.unshift(this._read_value))}_read_struct_values(){let e=this._done_with_error,t=this._read_after_whitespace(!0);switch(t){case 39:e=this._read_string1,-2!=this._peek("''")&&(e=this._read_string3);break;case s:e=this._read_string2;break;case 125:return void this._value_push(-1);default:o.is_letter(t)&&(e=this._read_symbol)}e===this._done_with_error?this._error("expected field name (or close struct '}') not found"):(e.call(this),this._load_field_name(),58!=this._read_after_whitespace(!0)?this._error("expected ':'"):(this._ops.unshift(this._read_struct_comma),this._ops.unshift(this._read_value)))}_read_list_comma(){let e=this._read_after_whitespace(!0);44==e?93==(e=this._read_after_whitespace(!0))?this._value_push(-1):(this._unread(e),this._ops.unshift(this._read_list_comma),this._ops.unshift(this._read_value)):93==e?this._value_push(-1):this._error("expected ',' or ']'")}_read_struct_comma(){let e=this._read_after_whitespace(!0);44==e?125==(e=this._read_after_whitespace(!0))?this._value_push(-1):(this._unread(e),this._ops.unshift(this._read_struct_values)):125==e?this._value_push(-1):this._error("expected ',' or '}'")}_load_field_name(){this._fieldnameType=this._value_pop();var e=this.get_value_as_string(this._fieldnameType);switch(this._fieldnameType){case 9:if(o.is_keyword(e))throw new Error("can't use '"+e+"' as a fieldname without quotes");case 11:case 12:case 13:this._fieldname=e;break;default:throw new Error("invalid fieldname"+e)}}_read_value(){this._read_value_helper(!1,this._read_value)}_read_sexp_value(){this._read_value_helper(!0,this._read_sexp_value)}_read_value_helper(e,t){var r,n=this._read_after_whitespace(!0);-1==n?this._read_value_helper_EOF(n,e,t):null!=(r=this._read_value_helper_helpers[n])?r.call(this,n,e,t):this._error("unexpected character '"+o.asAscii(n)+"'")}_read_value_helper_EOF(e,t,r){this._ops.unshift(this._done)}_read_value_helper_paren(e,t,r){this._value_push(17),this._ops.unshift(this._read_sexp_values)}_read_value_helper_square(e,t,r){this._value_push(18),this._ops.unshift(this._read_list_values)}_read_value_helper_curly(e,t,r){var n,i=this._read();i==l?39==(n=this._read_after_whitespace(!1))?this._ops.unshift(this._read_clob_string3):n==s?this._ops.unshift(this._read_clob_string2):(this._unread(n),this._ops.unshift(this._read_blob)):(this._unread(i),this._value_push(19),this._ops.unshift(this._read_struct_values))}_read_value_helper_plus(e,t,r){var n=this._peek("inf");this._unread(e),o.isNumericTerminator(n)?this._ops.unshift(this._read_plus_inf):t?this._ops.unshift(this._read_operator_symbol):this._error("unexpected '+'")}_read_value_helper_digit(e,t,r){var n=this._peek_4_digits(e);this._unread(e),84==n||45==n?this._ops.unshift(this._readTimestamp):this._ops.unshift(this._read_number)}_read_value_helper_single(e,t,r){let n;-2!=this._peek("''")?(n=this._read_string3).call(this):((n=this._read_string1).call(this),this._test_string_as_annotation(n)&&this._ops.unshift(r))}_read_value_helper_double(e,t,r){this._ops.unshift(this._read_string2)}_read_value_helper_letter(e,t,r){this._read_symbol();var n=this._value_pop();if(9!=n)throw new Error("Expecting symbol here.");let i=this.get_value_as_string(n);if(o.is_keyword(i)){let e=function(e){if("null"===e)return 1;if("true"===e)return 2;if("false"===e)return 2;if("nan"===e)return 6;if("+inf"===e)return 6;if("-inf"===e)return 6;throw new Error("Unknown keyword: "+e+".")}(i);if(1===e){if(this._value_null=!0,46===this._peek()){this._read();n=this._read();if(!0!==o.is_letter(n))throw new Error("Expected type name after 'null.'");if(this._read_symbol(),9!==this._value_pop())throw new Error("Expected type name after 'null.'");i=this.get_value_as_string(9),e=function(e){if("null"===e)return 1;if("bool"===e)return 2;if("int"===e)return 3;if("float"===e)return 5;if("decimal"===e)return 7;if("timestamp"===e)return 8;if("symbol"===e)return 9;if("string"===e)return 12;if("clob"===e)return 14;if("blob"===e)return 16;if("sexp"===e)return 17;if("list"===e)return 18;if("struct"===e)return 19;throw new Error("Unknown type: "+e+".")}(i)}this._start=-1,this._end=-1}this._value_push(e)}else{n=this._read_after_whitespace(!0);if(58==n&&58==this._peek()){this._read();var s=this._parseSymbolId(i);if(0===s)throw new Error("Symbol ID zero is not supported.");isNaN(s)?this._ann.push(new a.SymbolToken(i)):this._ann.push(new a.SymbolToken(null,s)),this._ops.unshift(r)}else this._unread(n),this._value_push(9)}}_read_value_helper_operator(e,t,r){t?(this._unread(e),this._ops.unshift(this._read_operator_symbol)):this._error("unexpected operator character")}_done(){this._value_push(-1)}_done_with_error(){throw this._value_push(-2),new Error(this._error_msg)}_read_number(){let e,t;if(this._start=this._in.position(),48==(e=45==(e=this._read())?this._read():e)){if(120==(e=this._peek())||88==e)return void this._read_hex_int();o.is_digit(e)&&this._error("leading zeros are not allowed"),e=48}t=3,46==(e=this._read_required_digits(e))&&(t=7,e=this._read_optional_digits(this._read())),o.isNumericTerminator(e)||(100==e||68==e?(t=7,e=this._read_exponent()):101!=e&&69!=e&&102!=e&&70!=e||(t=5,e=this._read_exponent())),o.isNumericTerminator(e)?(this._unread(e),this._end=this._in.position(),this._value_push(t)):this._error("invalid character after number")}_read_hex_int(){let e=this._read();120!=e&&88!=e||(e=this._read(),e=this._read_required_hex_digits(e)),o.isNumericTerminator(e)?(this._unread(e),this._end=this._in.position(),this._value_push(4)):this._error("invalid character after number")}_read_exponent(){let e=this._read();return 45!=e&&43!=e||(e=this._read()),e=this._read_required_digits(e)}_read_plus_inf(){this._start=this._in.position(),43==this._read()?this._read_inf_helper():this._error("expected +inf")}_read_minus_inf(){this._start=this._in.position(),45==this._read()?this._read_inf_helper():this._error("expected -inf")}_read_inf_helper(){let e;for(e=0;e<3;e++)if(this._read()!=h[e])return void this._error("expected 'inf'");o.isNumericTerminator(this._peek())?(this._end=this._in.position(),this._value_push(6)):this._error("invalid numeric terminator after 'inf'")}_readTimestamp(){this._start=this._in.position();let e=this._readPastNDigits(4);if(84!==e){if(45!==e)throw new Error("Timestamp year must be followed by '-' or 'T'.");if(84!==(e=this._readPastNDigits(2))){if(45!==e)throw new Error("Timestamp month must be followed by '-' or 'T'.");if(e=this._readPastNDigits(2),o.isNumericTerminator(e))this._unread(e);else{if(84!==e)throw new Error("Timestamp day must be followed by a numeric stop character .");var t=this._in.peek();if(!o.isNumericTerminator(t)){if(!o.is_digit(t))throw new Error("Timestamp DATE must be followed by numeric terminator or additional TIME digits.");if(58!==(e=this._readPastNDigits(2)))throw new Error("Timestamp time(hr:min) requires format of 00:00");if(58===(e=this._readPastNDigits(2))&&46===(e=this._readPastNDigits(2))){if(!o.is_digit(this._read()))throw new Error("W3C timestamp spec requires atleast one digit after decimal point.");for(;o.is_digit(e=this._read()););}if(90===e){if(o.isNumericTerminator(this._peek()))return this._end=this._in.position(),void this._value_push(8);throw new Error("Illegal terminator after Zulu offset.")}if(43!==e&&45!==e)throw new Error("Timestamps require an offset.");if(58!==(e=this._readPastNDigits(2)))throw new Error("Timestamp offset(hr:min) requires format of +/-00:00.");if(this._readNDigits(2),e=this._peek(),!o.isNumericTerminator(e))throw new Error("Improperly formatted timestamp.")}}}}this._end=this._in.position(),this._value_push(8)}_read_symbol(){let e;for(this._start=this._in.position()-1;e=this._read(),o.is_letter_or_digit(e););this._unread(e),this._end=this._in.position(),this._value_push(9)}_read_operator_symbol(){let e;for(this._start=this._in.position();e=this._read(),o.is_operator_char(e););this._end=this._in.position()-1,this._unread(e),this._value_push(10)}_read_string1(){this._read_string_helper(39,!1),this._end=this._in.position()-1,this._value_push(11)}_read_string2(){this._read_string_helper(s,!1),this._end=this._in.position()-1,this._value_push(12)}_read_string3(e){var t;for(void 0===e&&(e=!0),this._unread(this._peek("")),this._start=this._in.position()+3;-2!==this._peek("'''");this._in.unread(this._read_after_whitespace(e))){for(let e=0;e<3;e++)this._read();for(;-2===this._peek("'''");){if(92==(t=this._read())&&this._read_string_escape_sequence(),-1===t)throw new Error("Closing triple quotes not found.");if(!_(t,!0))throw new Error("invalid character "+t+" in string")}this._end=this._in.position();for(let e=0;e<3;e++)this._read()}this._value_push(13)}verifyTriple(e){return 39===this._in.valueAt(e)&&39===this._in.valueAt(e+1)&&39===this._in.valueAt(e+2)}_read_string_escape_sequence(){let e=this._read();switch(e){case 48:case 97:case 98:case 116:case 110:case 102:case 114:case 118:case u:case 39:case 63:case 92:case 47:case 10:break;case 13:10!=(e=this._read())&&this._unread(e);break;case 120:e=this._read_N_hexdigits(2),this._unread(e);break;case 117:e=this._read_N_hexdigits(4),this._unread(e);break;case 85:e=this._read_N_hexdigits(8),this._unread(e);break;default:this._error("unexpected character: "+e+" after escape slash")}}_test_string_as_annotation(e){let t,r,n;var i=this._value_pop();return 11!=i&&13!=i&&this._error("expecting quoted symbol here"),t=this.get_value_as_string(i),r=this._read_after_whitespace(!0),n=58==r&&58==this._peek()?(this._read(),this._ann.push(new a.SymbolToken(t)),!0):(this._unread(r),this._value_push(i),!1)}_read_clob_string2(){this._read_string2(),12!=this._value_pop()&&this._error("string expected"),this._value_push(14),this._ops.unshift(this._read_close_double_brace)}_read_clob_string3(){this._read_string3(!1),13!=this._value_pop()&&this._error("string expected"),this._value_push(15),this._ops.unshift(this._read_close_double_brace)}_read_blob(){let e,t=0,r=0;for(this._start=this._in.position();;)if(e=this._read(),o.is_base64_char(e))t++,this._end=this._in.position();else if(!o.is_whitespace(e))break;for(;61==e;)r++,e=this._read_after_whitespace(!1);if(125!=e||125!=this._read())throw new Error("Invalid blob");if(n=t,2<(i=r)||0!=(n+i&3))throw new Error("Invalid base64 value");var n,i;this._value_push(16)}_read_close_double_brace(){125==this._read_after_whitespace(!1)&&125==this._read()||this._error("expected '}}'")}isHighSurrogate(e){return 55296<=e&&e<=56319}isLowSurrogate(e){return 56320<=e&&e<=57343}indexWhiteSpace(e,t){let r=this._in.valueAt(e);if(t){for(;o.is_whitespace(r)||r===i;r=this._in.valueAt(e++))if(r===i)switch(r=this._in.valueAt(e++)){case i:e=this.indexToNewLine(e);break;case 42:e=this.indexToCloseComment(e);break;default:e--}}else for(;o.is_whitespace(r);r=this._in.valueAt(e++));return e}indexToNewLine(e){let t=this._in.valueAt(e);for(;-1!==t&&10!==t;){if(13===t&&10!==this._in.valueAt(e+1))return e;t=this._in.valueAt(e++)}return e}indexToCloseComment(e){for(;42!==this._in.valueAt(e)&&this._in.valueAt(e+1)!==i;)e++;return e}_skip_triple_quote_gap(e,t,r){return(e=this.indexWhiteSpace(e+3,r))+2<=t&&this.verifyTriple(e)?e+4:e+1}readClobEscapes(e,t){let r;if(t<=e+1)throw new Error("invalid escape sequence");switch(r=this._in.valueAt(e+1),this._esc_len=1,r){case 48:return 0;case 97:return 7;case 98:return 8;case 116:return 9;case 110:return 10;case 102:return 12;case 114:return 13;case 118:return 11;case u:return 34;case 39:return 39;case 63:return 63;case 92:return 92;case 47:return 47;case 10:return-1;case 13:return e+2<t&&10==this._in.valueAt(e+2)&&(this._esc_len=2),o.ESCAPED_NEWLINE;case 120:if(t<=e+3)throw new Error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+4),this._esc_len=3;break;default:throw new Error("Invalid escape: /"+r)}return r}_read_escape_sequence(e,t){let r;if(t<=e+1)throw new Error("Invalid escape sequence.");switch(r=this._in.valueAt(e+1),this._esc_len=1,r){case 48:return 0;case 97:return 7;case 98:return 8;case 116:return 9;case 110:return 10;case 102:return 12;case 114:return 13;case 118:return 11;case u:return 34;case 39:return 39;case 63:return 63;case 92:return 92;case 47:return 47;case 10:return-1;case 13:return e+2<t&&10==this._in.valueAt(e+2)&&(this._esc_len=2),o.ESCAPED_NEWLINE;case 120:if(t<=e+3)throw new Error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+4),this._esc_len=3;break;case 117:if(t<=e+5)throw new Error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+6),this._esc_len=5;break;case 85:if(t<=e+9)throw new Error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+10),this._esc_len=9;break;default:throw new Error("unexpected character after escape slash")}return r}_get_N_hexdigits(e,t){let r,n=0;for(;e<t;)r=this._in.valueAt(e),n=16*n+function(e){switch(e){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 98:return 11;case 99:return 12;case 100:return 13;case 101:return 14;case 102:return 15;case 65:return 10;case 66:return 11;case 67:return 12;case 68:return 13;case 69:return 14;case 70:return 15}throw new Error("Unexpected bad hex digit in checked data.")}(r),e++;return n}_value_push(e){-2!==this._value_type&&this._error("unexpected double push of value type!"),this._value_type=e}_value_pop(){var e=this._value_type;return this._value_type=-2,e}_run(){for(;0<this._ops.length&&-2===this._value_type;)this._ops.shift().call(this)}_read(){return this._in.next()}_read_skipping_comments(){let e=this._read();return e=e==i?(e=this._read())==i?(this._read_to_newline(),o.WHITESPACE_COMMENT1):42==e?(this._read_to_close_comment(),o.WHITESPACE_COMMENT2):(this._unread(e),i):e}_read_to_newline(){for(var e;-1!=(e=this._read())&&10!=e;)if(13==e){10!=(e=this._read())&&this._unread(e);break}}_read_to_close_comment(){for(var e;-1!=(e=this._read())&&(42!=e||this._read()!=i););}_unread(e){this._in.unread(e)}_read_after_whitespace(e){let t;if(e)for(t=this._read_skipping_comments();o.is_whitespace(t);)t=this._read_skipping_comments();else for(t=this._read();o.is_whitespace(t);)t=this._read();return t}_peek(e){let t,r=0;if(void 0===e||e.length<1)return this._in.valueAt(this._in.position());for(;r<e.length&&(t=this._read())==e.charCodeAt(r);)r++;for(t=r===e.length?this._peek():(this._unread(t),-2);0<r;)r--,this._unread(e.charCodeAt(r));return t}_peek_4_digits(e){let t,r,n=!0;var i=[];if(!o.is_digit(e))return-2;for(t=0;t<3;t++)if(r=this._read(),i.push(r),!o.is_digit(r)){n=!1;break}for(r=n&&3==t?this._peek():-2;0<i.length;)this._unread(i.pop());return r}_read_required_digits(e){if(!o.is_digit(e))return-2;for(;e=this._read(),o.is_digit(e););return e}_read_optional_digits(e){for(;o.is_digit(e);)e=this._read();return e}_readNDigits(e){let t;if(e<=0)throw new Error("Cannot read a lack of or negative number of digits.");for(;e--;)if(!o.is_digit(t=this._read()))throw new Error("Expected digit, got: "+String.fromCharCode(t));return t}_readPastNDigits(e){return this._readNDigits(e),this._read()}_read_required_hex_digits(e){if(!o.is_hex_digit(e))return-2;for(;e=this._read(),o.is_hex_digit(e););return e}_read_N_hexdigits(e){let t,r=0;for(;r<e;){if(t=this._read(),!o.is_hex_digit(t))return this._error(e+" digits required "+r+" found"),-2;r++}return t}_parseSymbolId(t){if("$"!==t[0])return NaN;for(let e=1;e<t.length;e++)if(t[e]<"0"||"9"<t[e])return NaN;return parseInt(t.substr(1,t.length))}_error(e){this._ops.unshift(this._done_with_error),this._error_msg=e}}},{"./IonSymbolToken":21,"./IonText":24,"./IonTypes":29}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PrettyTextWriter=void 0;const n=e("./IonText"),i=e("./IonTextWriter"),s=e("./IonTypes");class a extends i.TextWriter{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;super(e),this.indentSize=t,this.indentCount=0}writeFieldName(e){if(this.currentContainer.containerType!==s.IonTypes.STRUCT)throw new Error("Cannot write field name outside of a struct");if(this.currentContainer.state!==i.State.STRUCT_FIELD)throw new Error("Expecting a struct value");this.currentContainer.clean||(this.writeable.writeByte(n.CharCodes.COMMA),this.writePrettyNewLine(0)),this.writePrettyIndent(0),this.writeSymbolToken(e),this.writeable.writeByte(n.CharCodes.COLON),this.writeable.writeByte(n.CharCodes.SPACE),this.currentContainer.state=i.State.VALUE}writeNull(e){null==e&&(e=s.IonTypes.NULL),this.handleSeparator(),this.writePrettyValue(),this.writeAnnotations(),this._writeNull(e),this.currentContainer.containerType===s.IonTypes.STRUCT&&(this.currentContainer.state=i.State.STRUCT_FIELD)}stepOut(){var e=this.containerContext.pop();if(!e||!e.containerType)throw new Error("Can't step out when not in a container");if(e.containerType===s.IonTypes.STRUCT&&e.state===i.State.VALUE)throw new Error("Expecting a struct value");switch(e.clean||this.writePrettyNewLine(0),this.writePrettyIndent(-1),e.containerType){case s.IonTypes.LIST:this.writeable.writeByte(n.CharCodes.RIGHT_BRACKET);break;case s.IonTypes.SEXP:this.writeable.writeByte(n.CharCodes.RIGHT_PARENTHESIS);break;case s.IonTypes.STRUCT:this.writeable.writeByte(n.CharCodes.RIGHT_BRACE);break;default:throw new Error("Unexpected container type")}}_serializeValue(e,t,r){if(this.currentContainer.state===i.State.STRUCT_FIELD)throw new Error("Expecting a struct field");null===t?this.writeNull(e):(this.handleSeparator(),this.writePrettyValue(),this.writeAnnotations(),r(t),this.currentContainer.containerType===s.IonTypes.STRUCT&&(this.currentContainer.state=i.State.STRUCT_FIELD))}writeContainer(e,t){this.currentContainer.containerType===s.IonTypes.STRUCT&&this.currentContainer.state===i.State.VALUE&&(this.currentContainer.state=i.State.STRUCT_FIELD),this.handleSeparator(),this.writePrettyValue(),this.writeAnnotations(),this.writeable.writeByte(t),this.writePrettyNewLine(1),this._stepIn(e)}handleSeparator(){if(0===this.depth())this.currentContainer.clean?this.currentContainer.clean=!1:this.writeable.writeByte(n.CharCodes.LINE_FEED);else if(this.currentContainer.clean)this.currentContainer.clean=!1;else switch(this.currentContainer.containerType){case s.IonTypes.LIST:this.writeable.writeByte(n.CharCodes.COMMA),this.writePrettyNewLine(0);break;case s.IonTypes.SEXP:this.writeable.writeByte(n.CharCodes.SPACE),this.writePrettyNewLine(0)}}writePrettyValue(){0<this.depth()&&this.currentContainer.containerType&&this.currentContainer.containerType!==s.IonTypes.STRUCT&&this.writePrettyIndent(0)}writePrettyNewLine(e){this.indentCount=this.indentCount+e,this.indentSize&&0<this.indentSize&&this.writeable.writeByte(n.CharCodes.LINE_FEED)}writePrettyIndent(e){if(this.indentCount=this.indentCount+e,this.indentSize&&0<this.indentSize)for(let e=0;e<this.indentCount*this.indentSize;e++)this.writeable.writeByte(n.CharCodes.SPACE)}}r.PrettyTextWriter=a},{"./IonText":24,"./IonTextWriter":26,"./IonTypes":29}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SharedSymbolTable=void 0;r.SharedSymbolTable=class{constructor(e,t,r){this._name=e,this._version=t,this._symbols=r,this._idsByText=new Map,this._numberOfSymbols=this._symbols.length;for(let e=r.length-1;0<=e;e--)this._idsByText.set(r[e],e)}get numberOfSymbols(){return this._numberOfSymbols}get name(){return this._name}get version(){return this._version}getSymbolText(e){if(e<0)throw new Error(`Index ${e} is out of bounds for the SharedSymbolTable name=${this.name}, version=`+this.version);if(!(e>=this.numberOfSymbols))return this._symbols[e]}getSymbolId(e){return this._idsByText.get(e)}}},{}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BinarySpan=r.StringSpan=r.Span=void 0;const n=e("./IonConstants");class i{constructor(e){this._type=e}static error(){throw new Error("span error")}write(e){throw new Error("not implemented")}}class s extends(r.Span=i){constructor(e){super(0),this._line=1,this._src=e,this._limit=e.length,this._start=0,this._pos=0,this._line_start=0,this._old_line_start=0}viewSource(){return this._src}position(){return this._pos-this._start}getRemaining(){return this._limit-this._pos}setRemaining(e){this._limit=e+this._pos}is_empty(){return this._pos>=this._limit}next(){var e;if(this.is_empty()){if(1073741824<this._pos)throw new Error("span position is out of bounds");return this._pos++,n.EOF}return 13===(e=this._src.charCodeAt(this._pos))?10!=this.peek()&&this._inc_line():10==e&&this._inc_line(),this._pos++,e}_inc_line(){this._old_line_start=this._line_start,this._line++,this._line_start=this._pos}unread(e){this._pos<=this._start&&i.error(),this._pos--,e<0?1!=this.is_empty()&&i.error():(this._pos==this._line_start&&(this._line_start=this._old_line_start,this._line--),e!=this.peek()&&i.error())}peek(){return this.valueAt(this._pos)}skip(e){this._pos+=e,this._pos>this._limit&&(this._pos=this._limit)}valueAt(e){return e<this._start||e>=this._limit?n.EOF:this._src.charCodeAt(e)}chunk(e){var t=this._src.substr(this._pos,e);return this._pos+=e,t}getCodePoint(e){return this._src.codePointAt(e)}line_number(){return this._line}offset(){return this._pos-this._line_start}clone(e){return new s(this._src.substr(this._pos))}}r.StringSpan=s;class a extends i{constructor(e){super(1),this._src=e,this._limit=e.length,this._start=0,this._pos=0}position(){return this._pos-this._start}getRemaining(){return this._limit-this._pos}setRemaining(e){this._limit=e+this._pos}is_empty(){return this._pos>=this._limit}next(){return this.is_empty()?n.EOF:this._src[this._pos++]}view(e){if(this._pos+e>this._limit)throw new Error("Unable to read "+e+" bytes (position: "+this.position()+", limit: "+this._limit+")");return this._src.subarray(this._pos,this._pos+=e)}chunk(e){return new Uint8Array(this.view(e))}unread(e){this._pos<=this._start&&i.error(),this._pos--,e==n.EOF&&0==this.is_empty()&&i.error(),e!=this.peek()&&i.error()}peek(){return this.is_empty()?n.EOF:this._src[this._pos]}skip(e){if(this._pos+=e,this._pos>this._limit)throw new Error("Skipped over end of source.")}valueAt(e){return e<this._start||e>=this._limit?n.EOF:this._src[e]}clone(e,t){return new a(this._src.subarray(this._pos))}}r.BinarySpan=a},{"./IonConstants":10}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SubstituteSymbolTable=void 0;class n extends e("./IonSharedSymbolTable").SharedSymbolTable{constructor(e){if(e<0)throw new Error("Cannot instantiate a SubstituteSymbolTable with a negative length. ("+e+")");super("_substitute",-1,[]),this._numberOfSymbols=e}getSymbolText(e){if(e<0)throw new Error(`Index ${e} is out of bounds for the SharedSymbolTable name=${this.name}, version=`+this.version)}getSymbolId(e){}}r.SubstituteSymbolTable=n},{"./IonSharedSymbolTable":18}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SymbolToken=void 0;class n{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n._UNKNOWN_SYMBOL_ID;this.text=e,this.sid=t}getText(){return this.text}getSid(){return this.sid}}(r.SymbolToken=n)._UNKNOWN_SYMBOL_ID=-1},{}],22:[function(e,t,h){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.makeSymbolTable=h.ion_symbol_table_sid=h.ion_symbol_table=void 0;const _=e("./IonImport"),c=e("./IonLocalSymbolTable"),p=e("./IonSubstituteSymbolTable"),d=e("./IonSystemSymbolTable"),T=e("./Ion");h.ion_symbol_table="$ion_symbol_table",h.ion_symbol_table_sid=3;function f(e){var t=[];for(e.stepIn();e.next();)t.push(e.stringValue());return e.stepOut(),t}h.makeSymbolTable=function(e,t,r){let n=null,i=[],s=!1,a=!1,o=!1;for(t.stepIn();t.next();)switch(t.fieldName()){case"imports":if(a)throw new Error("Multiple import fields found.");var l=t.type();if(l===T.IonTypes.SYMBOL&&t.stringValue()===h.ion_symbol_table){n=r.import;var u=i;(i=r.symbols).push(...u),o=!0}else{if(l!==T.IonTypes.LIST)throw new Error("Expected import field name to be a list or symbol found "+l);n=function(e,i){let s=d.getSystemSymbolTableImport();for(e.stepIn();e.next();){e.stepIn();let t=null,r=1,n=null;for(;e.next();)switch(e.fieldName()){case"name":t=e.stringValue();break;case"version":r=e.numberValue();break;case"max_id":n=e.numberValue()}if((null===r||r<1)&&(r=1),t&&"$ion"!==t){let e=i.getVersion(t,r);if(!e){if(void 0===n)throw new Error(`No exact match found when trying to import symbol table ${t} version `+r);e=i.getTable(t)}e=e||new p.SubstituteSymbolTable(n),s=new _.Import(s,e,n)}e.stepOut()}return e.stepOut(),s}(t,e)}a=!0;break;case"symbols":if(s)throw new Error("Multiple symbol fields found.");o?i.push(...f(t)):i=f(t),s=!0}return t.stepOut(),new c.LocalSymbolTable(n,i)}},{"./Ion":5,"./IonImport":12,"./IonLocalSymbolTable":13,"./IonSubstituteSymbolTable":20,"./IonSystemSymbolTable":23}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getSystemSymbolTableImport=r.getSystemSymbolTable=void 0;const n=e("./IonImport");const i=new(e("./IonSharedSymbolTable").SharedSymbolTable)("$ion",1,["$ion","$ion_1_0","$ion_symbol_table","name","version","imports","symbols","max_id","$ion_shared_symbol_table"]);function s(){return i}r.getSystemSymbolTable=s,r.getSystemSymbolTableImport=function(){return new n.Import(null,i)}},{"./IonImport":12,"./IonSharedSymbolTable":18}],24:[function(e,t,r){"use strict";var n,e=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/extends"));Object.defineProperty(r,"__esModule",{value:!0}),r.escape=r.isDigit=r.isOperator=r.isIdentifier=r.SymbolEscapes=r.StringEscapes=r.ClobEscapes=r.CharCodes=r.toBase64=r.fromBase64=r.is_hex_digit=r.is_base64_char=r.is_whitespace=r.is_operator_char=r.is_letter_or_digit=r.isNumericTerminator=r.is_letter=r.toHex=r.escapeSequence=r.escapeString=r.needsEscape=r.nextEscape=r.asAscii=r.is_keyword=r.is_digit=r.ESCAPED_NEWLINE=r.WHITESPACE_COMMENT2=r.WHITESPACE_COMMENT1=void 0,r.WHITESPACE_COMMENT1=-2,r.WHITESPACE_COMMENT2=-3,r.ESCAPED_NEWLINE=-4;const i=34,s=39,a=92,o={0:"\\0",8:"\\b",9:"\\t",10:"\\n",13:"\\r",DOUBLE_QUOTE:'\\"',SINGLE_QUOTE:"\\'",SLASH:"\\\\"};function l(e){let t=e.length;var r=[];for(r[128]=!1;0<t;)--t,r[e.charCodeAt(t)]=!0;return r}const u=l("+/0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),h=l("0123456789abcdefABCDEF"),_=l("_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),c=l("_$0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),p=l("{}[](),\"' \t\n\r\v\f"),d=l("!#%&*+-./;<=>?@^`|~"),T=l(" \t\r\n\v\f"),f=l("_$0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");function m(e){return!(e<48||57<e)}function y(e,t){for(;0<t--&&!g(e.charCodeAt(t)););return t}function g(e){return e<32||126<e||e===i||e===s||e===a}function I(e,t){var r=[];let n,i,s;for(;0<=t&&g(n=e.charCodeAt(t));)r.push([t,n]),t=y(e,t);if(0<r.length){for(s="",i=r.length,t=e.length;i--;){var a=r[i],o=t-a[0]-1;s=0<o?w(a[1])+e.substring(a[0]+1,t)+s:e.substring(a[0]+1,t)+s,t=a[0]-1}e=s=0<=t?e.substring(0,t)+s:s}return e}function w(e){let t=o[e];return t=void 0===t?e<256?"\\x"+b(e,2):e<=65535?"\\u"+b(e,4):"\\U"+b(e,8):t}function b(e,t){let r="";for(;0<e;)r+="0123456789ABCDEF".charAt(e&&15),e/=16;return r=r.length<t?(r="000000000"+r).substring(r.length-t,r.length):r}r.is_digit=m,r.is_keyword=function(e){return"null"===e||"true"===e||"false"===e||"nan"===e||"+inf"===e||"-inf"===e},r.asAscii=function(e){var t;return void 0===e?e="undefined::null":"number"==typeof e?e=""+e:"string"!=typeof e&&0<=(t=y(e,e.length))&&(e=I(e,t)),e},r.nextEscape=y,r.needsEscape=g,r.escapeString=I,r.escapeSequence=w,r.toHex=b,r.is_letter=function(e){return _[e]},r.isNumericTerminator=function(e){return-1==e||p[e]},r.is_letter_or_digit=function(e){return c[e]},r.is_operator_char=function(e){return d[e]},r.is_whitespace=function(e){return!(32<e)&&(e==r.WHITESPACE_COMMENT1||e==r.WHITESPACE_COMMENT2||e==r.ESCAPED_NEWLINE||T[e])},r.is_base64_char=function(e){return u[e]},r.is_hex_digit=function(e){return h[e]};const v=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],S={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63};function E(e){return[n.BACKSLASH,e.charCodeAt(0)]}r.fromBase64=function(t){let r=0;for(let e=t.length-1;"="==t.charAt(e);e--)r++;var n=new Uint8Array(3*t.length/4-r);for(let e=0;e<t.length-r;e+=4){var i=S[t.charAt(e)],s=S[t.charAt(e+1)],a=S[t.charAt(e+2)],o=S[t.charAt(e+3)];n[3*e/4]=i<<2&255|s>>>4,e+2<t.length-r&&(n[3*e/4+1]=s<<4&255|a>>>2,e+3<t.length-r)&&(n[3*e/4+2]=a<<6&255|o)}return n},r.toBase64=function(t){var r=new Array(Math.ceil(4*t.length/3));for(let e=0;e<t.length;e+=3){var n=t[e],i=t[e+1],s=t[e+2];t[e+3];if(r[4*e/3]=v[n>>>2],r[4*e/3+1]=v[n<<4&63|(i||0)>>>4],!(e+1<t.length))return r.join("")+"==";if(r[4*e/3+2]=v[i<<2&63|(s||0)>>>6],!(e+2<t.length))return r.join("")+"=";r[4*e/3+3]=v[63&s]}return r.join("")},(O=n=r.CharCodes||(r.CharCodes={}))[O.NULL=0]="NULL",O[O.BELL=7]="BELL",O[O.BACKSPACE=8]="BACKSPACE",O[O.HORIZONTAL_TAB=9]="HORIZONTAL_TAB",O[O.LINE_FEED=10]="LINE_FEED",O[O.VERTICAL_TAB=11]="VERTICAL_TAB",O[O.FORM_FEED=12]="FORM_FEED",O[O.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",O[O.DOUBLE_QUOTE=34]="DOUBLE_QUOTE",O[O.SINGLE_QUOTE=39]="SINGLE_QUOTE",O[O.FORWARD_SLASH=47]="FORWARD_SLASH",O[O.QUESTION_MARK=63]="QUESTION_MARK",O[O.BACKSLASH=92]="BACKSLASH",O[O.LEFT_PARENTHESIS=40]="LEFT_PARENTHESIS",O[O.RIGHT_PARENTHESIS=41]="RIGHT_PARENTHESIS",O[O.LEFT_BRACE=123]="LEFT_BRACE",O[O.RIGHT_BRACE=125]="RIGHT_BRACE",O[O.LEFT_BRACKET=91]="LEFT_BRACKET",O[O.RIGHT_BRACKET=93]="RIGHT_BRACKET",O[O.COMMA=44]="COMMA",O[O.SPACE=32]="SPACE",O[O.LOWERCASE_X=120]="LOWERCASE_X",O[O.COLON=58]="COLON";const C=[n.BACKSLASH,n.LOWERCASE_X];function N(e){let t=e.toString(16);for(;t.length<2;)t="0"+t;return C.concat(function(t){var r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}(t))}function A(t,r,n){if(void 0===n)t[r]=N(r);else for(let e=r;e<n;e++)t[e]=N(e)}var O={};O[n.NULL]=E("0"),A(O,1,7),O[n.BELL]=E("a"),O[n.BACKSPACE]=E("b"),O[n.HORIZONTAL_TAB]=E("t"),O[n.LINE_FEED]=E("n"),O[n.VERTICAL_TAB]=E("v"),O[n.FORM_FEED]=E("f"),O[n.CARRIAGE_RETURN]=E("r"),A(O,14,32),O[n.BACKSLASH]=E("\\"),A(O,127,160),r.ClobEscapes=(0,e.default)({},O),r.ClobEscapes[n.DOUBLE_QUOTE]=E('"'),r.ClobEscapes[n.SINGLE_QUOTE]=E("'"),r.ClobEscapes[n.FORWARD_SLASH]=E("/"),r.ClobEscapes[n.QUESTION_MARK]=E("?"),r.StringEscapes=(0,e.default)({},O),r.StringEscapes[n.DOUBLE_QUOTE]=E('"'),r.SymbolEscapes=(0,e.default)({},O),r.SymbolEscapes[n.SINGLE_QUOTE]=E("'"),r.isIdentifier=function(t){if(m(t.charCodeAt(0)))return!1;for(let e=0;e<t.length;e++){var r=t.charCodeAt(e);if(!f[r])return!1}return!0},r.isOperator=function(t){for(let e=0;e<t.length;e++){var r=t.charCodeAt(e);if(!d[r])return!1}return!0},r.isDigit=function(e){return e<58&&47<e},r.escape=function(t,r){let n="",i="";var s;let a=0;for(let e=0;e<t.length;e++)if(void 0!==(s=r[t.charCodeAt(e)])){for(let e=0;e<s.length;e++)i+=String.fromCharCode(s[e]);n+=t.slice(a,e)+i,a=e+1,i=""}return n+t.slice(a,t.length)}},{"@babel/runtime/helpers/extends":56,"@babel/runtime/helpers/interopRequireDefault":57}],25:[function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.TextReader=void 0;const i=n(e("./IntSize")),s=e("./IonCatalog"),a=e("./IonDecimal"),o=e("./IonLocalSymbolTable"),l=e("./IonParserTextRaw"),u=e("./IonSymbols"),h=e("./IonText"),_=e("./IonTimestamp"),c=e("./IonTypes"),p=e("./util");r.TextReader=class{constructor(e,t){if(!e)throw new Error("a source Span is required to make a reader");this._parser=new l.ParserTextRaw(e),this._depth=0,this._cat=t||new s.Catalog,this._symtab=o.defaultLocalSymbolTable(),this._type=null,this._raw_type=void 0,this._raw=void 0}load_raw(){var e=this;void 0===e._raw&&(14===e._raw_type||15===e._raw_type?e._raw=e._parser.get_value_as_uint8array(e._raw_type):e._raw=e._parser.get_value_as_string(e._raw_type))}skip_past_container(){var e,t=this.depth();for(this.stepIn();this.depth()>t;)null===(e=this.next())?this.stepOut():e.isContainer&&!this.isNull()&&this.stepIn()}isIVM(e,t,r){if(0<t)return!1;t="$ion_1_0";if(e.length<t.length||0<r.length)return!1;let n=0;for(;n<"$ion_".length;){if("$ion_".charAt(n)!==e.charAt(n))return!1;n++}for(;n<e.length&&"_"!=e.charAt(n);){var i=e.charAt(n);if(i<"0"||"9"<i)return!1;n++}for(n++;n<e.length;){var s=e.charAt(n);if(s<"0"||"9"<s)return!1;n++}if(e!==t)throw new Error("Only Ion version 1.0 is supported.");return!0}isLikeIVM(){return!1}position(){return this._parser.source().position()}next(){if(this._raw=void 0,-1===this._raw_type)return null;-2!==this._raw_type&&!this.isNull()&&this._type&&this._type.isContainer&&this.skip_past_container();for(var e=this._parser;;){if(this._raw_type=e.next(),9===this._raw_type){if(0<this._depth)break;if(this.load_raw(),!this.isIVM(this._raw,this.depth(),this.annotations()))break;this._symtab=o.defaultLocalSymbolTable()}else if(11===this._raw_type){if(0<this._depth)break;if(this.load_raw(),"$ion_1_0"!==this._raw)break}else{if(19!==this._raw_type)break;if(1!==e.annotations().length)break;if(e.annotations()[0].getText()!=u.ion_symbol_table)break;this._type=l.get_ion_type(this._raw_type),this._symtab=u.makeSymbolTable(this._cat,this,this._symtab)}this._raw=void 0,this._raw_type=void 0}return this._type=l.get_ion_type(this._raw_type),this._type}stepIn(){if(!this._type.isContainer)throw new Error("can't step in to a scalar value");if(this.isNull())throw new Error("Can't step into a null container");this._parser.clearFieldName(),this._type=null,this._raw_type=-2,this._depth++}stepOut(){for(this._parser.clearFieldName();-1!=this._raw_type;)this.next();if(this._raw_type=void 0,this._depth<=0)throw new Error("Cannot stepOut any further, already at top level");this._depth--}type(){return this._type}depth(){return this._depth}fieldName(){var e=this._parser.fieldName();if(null!==e&&(9===this._parser.fieldNameType()&&1<e.length&&"$"===e[0])){var t=e.substr(1,e.length);if(+t==+t){t=this._symtab.getSymbolText(Number(t));if(void 0===t)throw new Error("Unresolvable symbol ID, symboltokens unsupported.");return t}}return e}annotations(){return this._parser.annotations().map(e=>{var t=e.getText();if(null!==t)return t;t=this._symtab.getSymbolText(e.getSid());if(null==t)throw new Error("Unresolvable symbol ID, symboltokens unsupported.");return t})}isNull(){return this._type===c.IonTypes.NULL||this._parser.isNull()}_stringRepresentation(){return this.load_raw(),this.isNull()?this._type===c.IonTypes.NULL?"null":"null."+this._type.name:this._raw}booleanValue(){switch(this._type){case c.IonTypes.NULL:return null;case c.IonTypes.BOOL:return this._parser.booleanValue()}throw new Error("Current value is not a Boolean.")}uInt8ArrayValue(){switch(this.load_raw(),this._type){case c.IonTypes.NULL:return null;case c.IonTypes.BLOB:return this.isNull()?null:h.fromBase64(this._raw);case c.IonTypes.CLOB:return this.isNull()?null:this._raw}throw new Error("Current value is not a blob or clob.")}decimalValue(){switch(this._type){case c.IonTypes.NULL:return null;case c.IonTypes.DECIMAL:return a.Decimal.parse(this._stringRepresentation())}throw new Error("Current value is not a decimal.")}bigIntValue(){switch(this._type){case c.IonTypes.NULL:return null;case c.IonTypes.INT:return this._parser.bigIntValue()}throw new Error("bigIntValue() was called when the current value was a(n) "+this._type.name)}intSize(){return p.isSafeInteger(this.bigIntValue())?i.default.Number:i.default.BigInt}numberValue(){switch(this._type){case c.IonTypes.NULL:return null;case c.IonTypes.FLOAT:case c.IonTypes.INT:return this._parser.numberValue()}throw new Error("Current value is not a float or int.")}stringValue(){switch(this.load_raw(),this._type){case c.IonTypes.NULL:return null;case c.IonTypes.STRING:return this._parser.isNull()?null:this._raw;case c.IonTypes.SYMBOL:if(this._parser.isNull())return null;if(9===this._raw_type&&1<this._raw.length&&this._raw.charAt(0)==="$".charAt(0)){var e=this._raw.substr(1,this._raw.length);if(+e==+e){e=Number(e),e=this._symtab.getSymbolText(e);if(void 0===e)throw new Error("Unresolvable symbol ID, symboltokens unsupported.");return e}}return this._raw}throw new Error("Current value is not a string or symbol.")}timestampValue(){switch(this._type){case c.IonTypes.NULL:return null;case c.IonTypes.TIMESTAMP:return _.Timestamp.parse(this._stringRepresentation())}throw new Error("Current value is not a timestamp.")}value(){if(this._type&&this._type.isContainer){if(this.isNull())return null;throw new Error("Unable to provide a value for "+this._type.name+" containers.")}switch(this._type){case c.IonTypes.NULL:return null;case c.IonTypes.BLOB:case c.IonTypes.CLOB:return this.uInt8ArrayValue();case c.IonTypes.BOOL:return this.booleanValue();case c.IonTypes.DECIMAL:return this.decimalValue();case c.IonTypes.INT:return this.bigIntValue();case c.IonTypes.FLOAT:return this.numberValue();case c.IonTypes.STRING:case c.IonTypes.SYMBOL:return this.stringValue();case c.IonTypes.TIMESTAMP:return this.timestampValue();default:throw new Error("There is no current value.")}}}},{"./IntSize":4,"./IonCatalog":9,"./IonDecimal":11,"./IonLocalSymbolTable":13,"./IonParserTextRaw":16,"./IonSymbols":22,"./IonText":24,"./IonTimestamp":27,"./IonTypes":29,"./util":55}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TextWriter=r.Context=r.State=void 0;var n,i=e("./AbstractWriter");const s=e("./IonText"),a=e("./IonTypes"),o=e("./IonUnicode"),l=e("./util");(e=n=r.State||(r.State={}))[e.VALUE=0]="VALUE",e[e.STRUCT_FIELD=1]="STRUCT_FIELD";class u{constructor(e){this.state=e===a.IonTypes.STRUCT?n.STRUCT_FIELD:n.VALUE,this.clean=!0,this.containerType=e}}r.Context=u;class h extends i.AbstractWriter{constructor(e){super(),this.writeable=e,this._floatSerializer=e=>{h._serializeFloat(this,e)},this.containerContext=[new u(null)]}get isTopLevel(){return 0===this.depth()}get currentContainer(){return this.containerContext[this.depth()]}static _serializeFloat(e,t){let r;t===Number.POSITIVE_INFINITY?r="+inf":t===Number.NEGATIVE_INFINITY?r="-inf":Object.is(t,Number.NaN)?r="nan":Object.is(t,-0)?r="-0e0":-1<(t=(r=t.toExponential()).lastIndexOf("+"))&&(r=r.slice(0,t)+r.slice(t+1)),e.writeUtf8(r)}getBytes(){return this.writeable.getBytes()}writeBlob(e){l._assertDefined(e),this._serializeValue(a.IonTypes.BLOB,e,e=>{this.writeable.writeBytes(o.encodeUtf8("{{"+s.toBase64(e)+"}}"))})}writeBoolean(e){l._assertDefined(e),this._serializeValue(a.IonTypes.BOOL,e,e=>{this.writeUtf8(e?"true":"false")})}writeClob(e){l._assertDefined(e),this._serializeValue(a.IonTypes.CLOB,e,t=>{let r;this.writeUtf8('{{"');for(let e=0;e<t.length;e++){var n=t[e];if(127<n&&n<256){r="\\x"+n.toString(16);for(let e=0;e<r.length;e++)this.writeable.writeByte(r.charCodeAt(e))}else{var i=s.ClobEscapes[n];if(void 0===i)if(n<32){r="\\x"+n.toString(16);for(let e=0;e<r.length;e++)this.writeable.writeByte(r.charCodeAt(e))}else this.writeable.writeByte(n);else this.writeable.writeBytes(new Uint8Array(i))}}this.writeUtf8('"}}')})}writeDecimal(e){l._assertDefined(e),this._serializeValue(a.IonTypes.DECIMAL,e,e=>{let t="",r=e.getCoefficient();r<0n&&(r=-r),e.isNegative()&&(t+="-");var n,i,s,e=e.getExponent(),a=-e;0==e?t+=r.toString()+".":e<0?(i=(n=r.toString().length)-1-a,t=0<=i?(s=n-a,(t=t+r.toString().substring(0,s)+".")+r.toString().substring(s,n)):-6<=i?(t=(t+="0.")+"00000".substring(0,a-n))+r.toString():(t=t+r.toString()+"d-")+a.toString()):t+=r.toString()+"d"+e,this.writeUtf8(t)})}_isInStruct(){return this.currentContainer.containerType===a.IonTypes.STRUCT}writeFieldName(e){if(l._assertDefined(e),this.currentContainer.containerType!==a.IonTypes.STRUCT)throw new Error("Cannot write field name outside of a struct");if(this.currentContainer.state!==n.STRUCT_FIELD)throw new Error("Expecting a struct value");this.currentContainer.clean||this.writeable.writeByte(s.CharCodes.COMMA),this.writeSymbolToken(e),this.writeable.writeByte(s.CharCodes.COLON),this.currentContainer.state=n.VALUE}writeFloat32(e){l._assertDefined(e),this._writeFloat(e)}writeFloat64(e){l._assertDefined(e),this._writeFloat(e)}writeInt(e){l._assertDefined(e),this._serializeValue(a.IonTypes.INT,e,e=>{this.writeUtf8(e.toString(10))})}_writeNull(e){e===a.IonTypes.NULL?this.writeUtf8("null"):this.writeUtf8("null."+e.name)}writeNull(e){null==e&&(e=a.IonTypes.NULL),this.handleSeparator(),this.writeAnnotations(),this._writeNull(e),this.currentContainer.containerType===a.IonTypes.STRUCT&&(this.currentContainer.state=n.STRUCT_FIELD)}writeString(e){l._assertDefined(e),this._serializeValue(a.IonTypes.STRING,e,e=>{this.writeable.writeBytes(o.encodeUtf8('"'+s.escape(e,s.StringEscapes)+'"'))})}writeSymbol(e){l._assertDefined(e),this._serializeValue(a.IonTypes.SYMBOL,e,e=>{this.writeSymbolToken(e)})}writeTimestamp(e){l._assertDefined(e),this._serializeValue(a.IonTypes.TIMESTAMP,e,e=>{this.writeUtf8(e.toString())})}stepIn(e){if(this.currentContainer.state===n.STRUCT_FIELD)throw new Error(`Started writing a ${this.currentContainer.containerType.name} inside a struct"
                + " without writing the field name first. Call writeFieldName(string) with the desired name"
                + " before calling stepIn(${this.currentContainer.containerType.name}).`);switch(e){case a.IonTypes.LIST:this.writeContainer(e,s.CharCodes.LEFT_BRACKET);break;case a.IonTypes.SEXP:this.writeContainer(e,s.CharCodes.LEFT_PARENTHESIS);break;case a.IonTypes.STRUCT:if(void 0!==this._annotations&&"$ion_symbol_table"===this._annotations[0]&&0===this.depth())throw new Error("Unable to alter symbol table context, it allows invalid ion to be written.");this.writeContainer(e,s.CharCodes.LEFT_BRACE);break;default:throw new Error("Unrecognized container type")}}stepOut(){var e=this.containerContext.pop();if(!e||!e.containerType)throw new Error("Can't step out when not in a container");if(e.containerType===a.IonTypes.STRUCT&&e.state===n.VALUE)throw new Error("Expecting a struct value");switch(e.containerType){case a.IonTypes.LIST:this.writeable.writeByte(s.CharCodes.RIGHT_BRACKET);break;case a.IonTypes.SEXP:this.writeable.writeByte(s.CharCodes.RIGHT_PARENTHESIS);break;case a.IonTypes.STRUCT:this.writeable.writeByte(s.CharCodes.RIGHT_BRACE);break;default:throw new Error("Unexpected container TypeCode")}}close(){if(0<this.depth())throw new Error("Writer has one or more open containers; call stepOut() for each container prior to close()")}depth(){return this.containerContext.length-1}_serializeValue(e,t,r){if(this.currentContainer.state===n.STRUCT_FIELD)throw new Error("Expecting a struct field");null===t?this.writeNull(e):(this.handleSeparator(),this.writeAnnotations(),r(t),this.currentContainer.containerType===a.IonTypes.STRUCT&&(this.currentContainer.state=n.STRUCT_FIELD))}writeContainer(e,t){this.currentContainer.containerType===a.IonTypes.STRUCT&&this.currentContainer.state===n.VALUE&&(this.currentContainer.state=n.STRUCT_FIELD),this.handleSeparator(),this.writeAnnotations(),this.writeable.writeByte(t),this._stepIn(e)}handleSeparator(){if(0===this.depth())this.currentContainer.clean?this.currentContainer.clean=!1:this.writeable.writeByte(s.CharCodes.LINE_FEED);else if(this.currentContainer.clean)this.currentContainer.clean=!1;else switch(this.currentContainer.containerType){case a.IonTypes.LIST:this.writeable.writeByte(s.CharCodes.COMMA);break;case a.IonTypes.SEXP:this.writeable.writeByte(s.CharCodes.SPACE)}}writeUtf8(e){this.writeable.writeBytes(o.encodeUtf8(e))}writeAnnotations(){for(const e of this._annotations)this.writeSymbolToken(e),this.writeUtf8("::");this._clearAnnotations()}_stepIn(e){this.containerContext.push(new u(e))}writeSymbolToken(e){0===e.length||s.is_keyword(e)||this.isSid(e)||!s.isIdentifier(e)&&!s.isOperator(e)||s.isOperator(e)&&this.currentContainer.containerType!=a.IonTypes.SEXP?this.writeable.writeBytes(o.encodeUtf8("'"+s.escape(e,s.SymbolEscapes)+"'")):this.writeUtf8(e)}_writeFloat(e){this._serializeValue(a.IonTypes.FLOAT,e,this._floatSerializer)}isSid(e){return 1<e.length&&e.charAt(0)==="$".charAt(0)&&+(e=e.substr(1,e.length))==+e}}r.TextWriter=h},{"./AbstractWriter":1,"./IonText":24,"./IonTypes":29,"./IonUnicode":30,"./util":55}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Timestamp=r.TimestampPrecision=void 0;const f=e("./IonDecimal"),n=e("./IonText"),a=e("./util");var l,m;(e=l=r.TimestampPrecision||(r.TimestampPrecision={}))[e.YEAR=1]="YEAR",e[e.MONTH=2]="MONTH",e[e.DAY=3]="DAY",e[e.HOUR_AND_MINUTE=4]="HOUR_AND_MINUTE",e[e.SECONDS=5]="SECONDS";class y{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null;let a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null;if(e instanceof Date){var o=e;const a=0===o.getMilliseconds()?new f.Decimal(o.getSeconds(),0):new f.Decimal(1e3*o.getSeconds()+o.getMilliseconds(),-3);this._localOffset=-1*o.getTimezoneOffset(),this._year=o.getFullYear(),this._month=o.getMonth()+1,this._day=o.getDate(),this._hour=o.getHours(),this._minutes=o.getMinutes(),this._secondsDecimal=a,this._precision=l.YEAR}else{o=e;if(null===o)throw new Error("Timestamp's constructor was called without localOffset");if(null===t)throw new Error("Timestamp's constructor was called without year");if(this._localOffset=o,this._year=t,this._precision=l.YEAR,this._checkRequiredField("Offset",this._localOffset,y._MIN_OFFSET,y._MAX_OFFSET),this._checkRequiredField("Year",this._year,y._MIN_YEAR,y._MAX_YEAR),this._month=this._checkOptionalField("Month",r,y._MIN_MONTH,y._MAX_MONTH,1,l.MONTH),this._day=this._checkOptionalField("Day",n,y._MIN_DAY,y._MAX_DAY,1,l.DAY),this._hour=this._checkOptionalField("Hour",i,y._MIN_HOUR,y._MAX_HOUR,0,l.HOUR_AND_MINUTE),this._minutes=this._checkOptionalField("Minutes",s,y._MIN_MINUTE,y._MAX_MINUTE,0,l.HOUR_AND_MINUTE),"number"==typeof a){if(!Number.isInteger(a))throw new Error("The provided seconds number was not an integer ("+a+")");this._secondsDecimal=new f.Decimal(a,0)}else null!==a&&(this._secondsDecimal=a)}if(null===this._secondsDecimal||void 0===this._secondsDecimal?this._secondsDecimal=f.Decimal.ZERO:(this._checkFieldRange("Seconds",this._secondsDecimal,y._MIN_SECONDS,y._MAX_SECONDS),this._precision=l.SECONDS),this._precision<=l.DAY&&(this._localOffset=-0),this._precision>l.MONTH){e=new Date(this._year,this._month,0);if(e.setUTCFullYear(this._year),this._day>e.getDate())throw new Error(`Month ${this._month} has less than ${this._day} days`);if(2===this._month&&29===this._day&&!this._isLeapYear(this._year))throw new Error(`Given February 29th but year ${this._year} is not a leap year`)}o=this.getDate().getUTCFullYear();this._checkFieldRange("Year",o,y._MIN_YEAR,y._MAX_YEAR)}static parse(e){return g._parse(e)}static _adjustMsSinceEpochIfNeeded(e,t){return 100<=e?t:((t=new Date(t)).setUTCFullYear(e),t.getTime())}static _splitSecondsDecimal(e){var t,r=e.getCoefficient().toString(),n=e.getExponent();let i="",s="";return n<0?(t=Math.max(r.length+n,0),i=r.substring(0,t),s=r.substring(t),0<-e.getExponent()-r.length&&(s="0".repeat(-n-r.length)+s)):i=0<n?r+"0".repeat(n):r,[i,s]}static _valueOf(e,t,r,n){var i,s=e.getTime()+60*t*1e3;e=new Date(s);let a;switch(a=null!=r?([i,s]=y._splitSecondsDecimal(r),f.Decimal.parse(e.getUTCSeconds()+"."+s)):f.Decimal.parse(e.getUTCSeconds()+"."+e.getUTCMilliseconds()),n){case l.YEAR:return new y(t,e.getUTCFullYear());case l.MONTH:return new y(t,e.getUTCFullYear(),e.getUTCMonth()+1);case l.DAY:return new y(t,e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate());case l.HOUR_AND_MINUTE:return new y(t,e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes());default:l.SECONDS;return new y(t,e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),a)}}getLocalOffset(){return this._localOffset}getPrecision(){return this._precision}getDate(){let e=0;this._precision===l.SECONDS&&(e=Math.round(1e3*(this._secondsDecimal.numberValue()-this.getSecondsInt())));var t=Date.UTC(this._year,this._precision===l.YEAR?0:this._month-1,this._day,this._hour,this._minutes,this.getSecondsInt(),e),t=y._adjustMsSinceEpochIfNeeded(this._year,t),r=60*this._localOffset*1e3;return new Date(t-r)}getSecondsInt(){return this._secondsDecimal.intValue()}getSecondsDecimal(){return this._secondsDecimal}_getFractionalSeconds(){var[,e]=y._splitSecondsDecimal(this._secondsDecimal);return""===e?f.Decimal.ZERO:f.Decimal.parse(e+"d-"+e.length)}equals(e){return this.getPrecision()===e.getPrecision()&&this.getLocalOffset()===e.getLocalOffset()&&a._sign(this.getLocalOffset())===a._sign(e.getLocalOffset())&&0===this.compareTo(e)&&this._secondsDecimal.equals(e._secondsDecimal)}compareTo(e){var t=this.getDate().getTime(),r=e.getDate().getTime();return t===r?this.getSecondsDecimal().compareTo(e.getSecondsDecimal()):t<r?-1:1}toString(){let e="";switch(this._precision){default:throw new Error("unrecognized timestamp precision "+this._precision);case l.SECONDS:var[t,r]=y._splitSecondsDecimal(this._secondsDecimal);e=this._lpadZeros(t,2),0<r.length&&(e+="."+r);case l.HOUR_AND_MINUTE:e=this._lpadZeros(this._minutes,2)+(e?":"+e:""),e=this._lpadZeros(this._hour,2)+(e?":"+e:"");case l.DAY:e=this._lpadZeros(this._day,2)+(e?"T"+e:"T");case l.MONTH:e=this._lpadZeros(this._month,2)+(e?"-"+e:"");case l.YEAR:e=this._precision===l.YEAR?this._lpadZeros(this._year,4)+"T":this._precision===l.MONTH?this._lpadZeros(this._year,4)+"-"+e+"T":this._lpadZeros(this._year,4)+"-"+e}var n=this._localOffset;return this._precision>l.DAY&&(0===n&&1===a._sign(n)?e+="Z":e+=(-1===a._sign(n)?"-":"+")+this._lpadZeros(Math.floor(Math.abs(n)/60),2)+":"+this._lpadZeros(Math.abs(n)%60,2)),e}toJSON(){return this.getDate().toISOString()}_checkRequiredField(e,t,r,n){if(!a._hasValue(t))throw new Error(e+" cannot be "+t);this._checkFieldRange(e,t,r,n)}_checkOptionalField(e,t,r,n,i,s){return a._hasValue(t)?(this._checkFieldRange(e,t,r,n),this._precision=s,t):i}_checkFieldRange(e,t,r,n){if(t instanceof f.Decimal){if(a._hasValue(t)&&(t.compareTo(r)<0||0<=t.compareTo(n)))throw new Error(e+` ${t} must be between ${r} inclusive, and ${n} exclusive`)}else{if(!Number.isInteger(t))throw new Error(e+` ${t} must be an integer`);if(t<r||n<t)throw new Error(e+` ${t} must be between ${r} and ${n} inclusive`)}}_isLeapYear(e){return e%4==0&&(e%400==0||e%100!=0||e<1600)}_lpadZeros(e,t){e=e.toString();if(e.length<=t)return"0".repeat(t-e.length)+e;throw new Error("Unable to fit '"+e+"' into "+t+" characters")}}(r.Timestamp=y)._MIN_SECONDS=f.Decimal.ZERO,y._MAX_SECONDS=f.Decimal.parse("60"),y._MIN_MINUTE=0,y._MAX_MINUTE=59,y._MIN_HOUR=0,y._MAX_HOUR=23,y._MIN_DAY=1,y._MAX_DAY=31,y._MIN_MONTH=1,y._MAX_MONTH=12,y._MIN_YEAR=1,y._MAX_YEAR=9999,y._MIN_OFFSET=-1439,y._MAX_OFFSET=1439,(e=m=m||{})[e.YEAR=0]="YEAR",e[e.MONTH=1]="MONTH",e[e.DAY=2]="DAY",e[e.HOUR=3]="HOUR",e[e.MINUTE=4]="MINUTE",e[e.SECONDS=5]="SECONDS",e[e.FRACTIONAL_SECONDS=6]="FRACTIONAL_SECONDS",e[e.OFFSET_POSITIVE=7]="OFFSET_POSITIVE",e[e.OFFSET_NEGATIVE=8]="OFFSET_NEGATIVE",e[e.OFFSET_MINUTES=9]="OFFSET_MINUTES",e[e.OFFSET_ZULU=10]="OFFSET_ZULU",e[e.OFFSET_UNKNOWN=11]="OFFSET_UNKNOWN";class i{constructor(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.f=e,this.len=t,this.t=r}}class g{static _parse(e){if(e.length<1)return null;if(110===e.charCodeAt(0)){if("null"===e||"null.timestamp"===e)return null;throw new Error("Illegal timestamp: "+e)}let t,r=null,n=0,i=null,s=null,a=null,o=null,l=null,u="",h=0,_=g._timeParserStates[m.YEAR];var c=e.length;let p;for(;h<c;){if(null===_.len){var d=g._readUnknownDigits(e,h);if(0===d.length)throw new Error("No digits found at pos: "+h);p=parseInt(d,10),h+=d.length}else if(0<_.len){if((p=g._readDigits(e,h,_.len))<0)throw new Error("Non-digit value found at pos "+h);h+=_.len}switch(p=p,_.f){case m.YEAR:n=p;break;case m.MONTH:i=p;break;case m.DAY:s=p;break;case m.HOUR:a=p;break;case m.MINUTE:o=p;break;case m.SECONDS:l=p;break;case m.FRACTIONAL_SECONDS:u=e.substring(20,h);break;case m.OFFSET_POSITIVE:t=1,r=60*p;break;case m.OFFSET_NEGATIVE:t=-1,r=60*p;break;case m.OFFSET_MINUTES:if(r+=p,60<=p)throw new Error("Minute offset "+String(p)+" above maximum or equal to : 60");break;case m.OFFSET_ZULU:t=1,r=0;break;case m.OFFSET_UNKNOWN:r=-0;break;default:throw new Error("invalid internal state")}if(h>=c)break;if(null!==_.t){d=String.fromCharCode(e.charCodeAt(h));if(void 0===(_=g._timeParserStates[_.t[d]]))throw new Error("State was not set pos:"+h);_.f===m.OFFSET_ZULU&&(t=1,r=0)}h++}if(null===r){if(null!==o)throw new Error('invalid timestamp, missing local offset: "'+e+'"');r=-0}else r=t*r;let T;return(void 0!==l&&null!==l||u)&&(T=f.Decimal.parse(l+"."+(u||""))),new y(r,n,i,s,a,o,T)}static _readUnknownDigits(e,t){let r=t;for(;r<e.length&&n.isDigit(e.charCodeAt(r));r++);return e.substring(t,r)}static _readDigits(t,r,n){let i=0;for(let e=r;e<r+n;e++){var s=t.charCodeAt(e)-48;if(s<0&&9<s)return-1;i=10*i+s}return i}}g._timeParserStates={[m.YEAR]:new i(m.YEAR,4,{T:m.OFFSET_UNKNOWN,"-":m.MONTH}),[m.MONTH]:new i(m.MONTH,2,{T:m.OFFSET_UNKNOWN,"-":m.DAY}),[m.DAY]:new i(m.DAY,2,{T:m.HOUR}),[m.HOUR]:new i(m.HOUR,2,{":":m.MINUTE}),[m.MINUTE]:new i(m.MINUTE,2,{":":m.SECONDS,"+":m.OFFSET_POSITIVE,"-":m.OFFSET_NEGATIVE,Z:m.OFFSET_ZULU}),[m.SECONDS]:new i(m.SECONDS,2,{".":m.FRACTIONAL_SECONDS,"+":m.OFFSET_POSITIVE,"-":m.OFFSET_NEGATIVE,Z:m.OFFSET_ZULU}),[m.FRACTIONAL_SECONDS]:new i(m.FRACTIONAL_SECONDS,null,{"+":m.OFFSET_POSITIVE,"-":m.OFFSET_NEGATIVE,Z:m.OFFSET_ZULU}),[m.OFFSET_POSITIVE]:new i(m.OFFSET_POSITIVE,2,{":":m.OFFSET_MINUTES}),[m.OFFSET_NEGATIVE]:new i(m.OFFSET_NEGATIVE,2,{":":m.OFFSET_MINUTES}),[m.OFFSET_MINUTES]:new i(m.OFFSET_MINUTES,2),[m.OFFSET_ZULU]:new i(m.OFFSET_ZULU,0),[m.OFFSET_UNKNOWN]:new i(m.OFFSET_UNKNOWN,0)}},{"./IonDecimal":11,"./IonText":24,"./util":55}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IonType=void 0;r.IonType=class{constructor(e,t,r,n,i,s){this.binaryTypeId=e,this.name=t,this.isScalar=r,this.isLob=n,this.isNumeric=i,this.isContainer=s}}},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IonTypes=void 0;e=e("./IonType");r.IonTypes={NULL:new e.IonType(0,"null",!0,!1,!1,!1),BOOL:new e.IonType(1,"bool",!0,!1,!1,!1),INT:new e.IonType(2,"int",!0,!1,!0,!1),FLOAT:new e.IonType(4,"float",!0,!1,!0,!1),DECIMAL:new e.IonType(5,"decimal",!0,!1,!1,!1),TIMESTAMP:new e.IonType(6,"timestamp",!0,!1,!1,!1),SYMBOL:new e.IonType(7,"symbol",!0,!1,!1,!1),STRING:new e.IonType(8,"string",!0,!1,!1,!1),CLOB:new e.IonType(9,"clob",!0,!0,!1,!1),BLOB:new e.IonType(10,"blob",!0,!0,!1,!1),LIST:new e.IonType(11,"list",!1,!1,!1,!0),SEXP:new e.IonType(12,"sexp",!1,!1,!1,!0),STRUCT:new e.IonType(13,"struct",!1,!1,!1,!0)}},{"./IonType":28}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeUtf8=r.encodeUtf8=void 0;let i;i="undefined"!=typeof TextDecoder?new TextDecoder("utf8",{fatal:!0}):null,r.encodeUtf8=function(t){let r=0,n;var i=new Uint8Array(4*t.length);for(let e=0;e<t.length;e++)if((n=t.charCodeAt(e))<128)i[r++]=n;else{if(n<2048)i[r++]=n>>6|192;else{if(55295<n&&n<56320){if(++e>=t.length)throw new Error("UTF-8 encode: incomplete surrogate pair");var s=t.charCodeAt(e);if(s<56320||57343<s)throw new Error("UTF-8 encode: second surrogate character 0x"+s.toString(16)+" at index "+e+" out of range");n=65536+((1023&n)<<10)+(1023&s),i[r++]=n>>18|240,i[r++]=n>>12&63|128}else i[r++]=n>>12|224;i[r++]=n>>6&63|128}i[r++]=63&n|128}return i.subarray(0,r)},r.decodeUtf8=function(e){if(512<e.length&&null!=i)return i.decode(e);let t=0,r="",n;for(;t<e.length;){if(127<(n=e[t++]))if(191<n&&n<224){if(t>=e.length)throw new Error("UTF-8 decode: incomplete 2-byte sequence");n=(31&n)<<6|63&e[t++]}else if(223<n&&n<240){if(t+1>=e.length)throw new Error("UTF-8 decode: incomplete 3-byte sequence");n=(15&n)<<12|(63&e[t++])<<6|63&e[t++]}else{if(!(239<n&&n<248))throw new Error("UTF-8 decode: unknown multibyte start 0x"+n.toString(16)+" at index "+(t-1));if(t+2>=e.length)throw new Error("UTF-8 decode: incomplete 4-byte sequence");n=(7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++]}if(n<=65535)r+=String.fromCharCode(n);else{if(!(n<=1114111))throw new Error("UTF-8 decode: code point 0x"+n.toString(16)+" exceeds UTF-16 reach");n-=65536,r=(r+=String.fromCharCode(n>>10|55296))+String.fromCharCode(1023&n|56320)}}return r}},{}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Writeable=void 0;r.Writeable=class{constructor(e){this.bufferSize=e||4096,this.buffers=[new Uint8Array(this.bufferSize)],this.index=0,this.clean=!1}get currentBuffer(){return this.buffers[this.buffers.length-1]}get totalSize(){let t=0;for(let e=0;e<this.buffers.length-1;e++)t+=this.buffers[e].length;return t+this.index}writeByte(e){this.clean=!1,this.currentBuffer[this.index]=e,this.index++,this.index===this.bufferSize&&(this.buffers.push(new Uint8Array(this.bufferSize)),this.index=0)}writeBytes(e,t,r){void 0===t&&(t=0);var n=void 0!==r?Math.min(e.length-t,r):e.length-t;n<this.currentBuffer.length-this.index-1?(this.currentBuffer.set(e.subarray(t,t+n),this.index),this.index+=n):(this.buffers[this.buffers.length-1]=this.currentBuffer.slice(0,this.index),this.buffers.push(e.subarray(t,r)),this.buffers.push(new Uint8Array(this.bufferSize)),this.clean=!1,this.index=0)}getBytes(){if(this.clean)return this.buffers[0];var t=new Uint8Array(this.totalSize);let r=0;for(let e=0;e<this.buffers.length-1;e++)t.set(this.buffers[e],r),r+=this.buffers[e].length;return t.set(this.currentBuffer.subarray(0,this.index),r),this.buffers=[t,new Uint8Array(this.bufferSize)],this.index=0,this.clean=!0,t}}},{}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=class n{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e<0n;this._magnitude=e,this._isNegative=t}get magnitude(){return this._magnitude}get isNegative(){return this._isNegative}static fromNumber(e){var t=e<0||Object.is(e,-0),e=Math.abs(e),e=BigInt(e);return new n(e,t)}equals(e){return this._magnitude===e._magnitude&&this._isNegative===e._isNegative}}},{}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Blob=void 0;const n=e("../Ion");class i extends e("./Lob").Lob(n.IonTypes.BLOB){constructor(e){super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:[])}toJSON(){return n.toBase64(this)}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeBlob(this)}}r.Blob=i},{"../Ion":5,"./Lob":42}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Boolean=void 0;var n=e("../Ion"),i=e("./FromJsConstructor");const s=e("./JsValueConversion");e=e("./Value"),i=(new i.FromJsConstructorBuilder).withPrimitives(i.Primitives.Boolean).withClassesToUnbox(s._NativeJsBoolean).build();class a extends e.Value(s._NativeJsBoolean,n.IonTypes.BOOL,i){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super(e),this._setAnnotations(t)}booleanValue(){return this.valueOf()}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeBoolean(this.booleanValue())}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let r=!1,n=null;return e instanceof a?(r=!0,n=e.booleanValue()):t.onlyCompareIon||("boolean"==typeof e||e instanceof s._NativeJsBoolean)&&(r=!0,n=e.valueOf()),!!r&&this.booleanValue()===n}}r.Boolean=a},{"../Ion":5,"./FromJsConstructor":38,"./JsValueConversion":40,"./Value":50}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Clob=void 0;var n=e("../Ion");class i extends e("./Lob").Lob(n.IonTypes.CLOB){constructor(e){super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:[])}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeClob(this)}toJSON(){let e="";for(const r of this){var t;32<=r&&r<=126?e+=String.fromCharCode(r):1==(t=r.toString(16)).length?e+="\\u000"+t:e+="\\u00"+t}return e}}r.Clob=i},{"../Ion":5,"./Lob":42}],36:[function(e,t,r){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Decimal=void 0;const a=s(e("../Ion"));var s=e("../Ion"),o=e("./FromJsConstructor"),l=e("./Value");const u=e("./Float");e=(new o.FromJsConstructorBuilder).withClasses(a.Decimal).build();class h extends l.Value(Number,s.IonTypes.DECIMAL,e){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if("string"==typeof e){var r=Number(e);super(r),this._decimalValue=new a.Decimal(e),this._numberValue=r}else if(e instanceof a.Decimal)super(e.numberValue()),this._decimalValue=e,this._numberValue=e.numberValue();else{if("number"!=typeof e)throw new Error("Decimal value can only be created from number, ion.Decimal or string");super(e),this._decimalValue=new a.Decimal(""+e),this._numberValue=e}this._setAnnotations(t)}numberValue(){return this._numberValue}decimalValue(){return this._decimalValue}toString(){return this._decimalValue.toString()}valueOf(){return this._numberValue}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeDecimal(this.decimalValue())}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0,coerceNumericType:!1};let r=!1,n=null;return e instanceof h?(r=!0,n=e.decimalValue()):!0===t.coerceNumericType&&e instanceof u.Float?(r=!0,n=new a.Decimal(e.toString())):t.onlyCompareIon||(e instanceof a.Decimal?(r=!0,n=e):(e instanceof Number||"number"==typeof e)&&(r=!0,n=new a.Decimal(e.toString()))),!!r&&this.decimalValue().equals(n)}}r.Decimal=h},{"../Ion":5,"./Float":37,"./FromJsConstructor":38,"./Value":50}],37:[function(e,t,r){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=(Object.defineProperty(r,"__esModule",{value:!0}),r.Float=void 0,e("../Ion")),o=e("./FromJsConstructor"),l=e("./Value");const u=e("./Decimal"),h=s(e("../Ion"));s=(new o.FromJsConstructorBuilder).withPrimitives(o.Primitives.Number).withClassesToUnbox(Number).build();class _ extends l.Value(Number,a.IonTypes.FLOAT,s){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super(e),this._setAnnotations(t)}numberValue(){return+this.valueOf()}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeFloat64(this.numberValue())}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0,coerceNumericType:!1};let r=!1,n=null;if(e instanceof _)r=!0,n=e.numberValue();else{if(!0===t.coerceNumericType&&e instanceof u.Decimal)return new h.Decimal(e.toString()).equals(e.decimalValue());t.onlyCompareIon||(e instanceof Number||"number"==typeof e)&&(r=!0,n=e.valueOf())}return!!r&&(e=Object.is(this.numberValue(),n),!(null==t.epsilon||!(e||Math.abs(this.numberValue()-n)<=t.epsilon))||e)}}r.Float=_},{"../Ion":5,"./Decimal":36,"./FromJsConstructor":38,"./Value":50}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Primitives=r.FromJsConstructor=r.FromJsConstructorBuilder=void 0;const i=e("../Ion"),n=e("../util");function s(e){return n._hasValue(e)?new Set(e):new Set}class a{constructor(){this._primitives=s(),this._classesToUnbox=s(),this._classes=s()}withPrimitives(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._primitives=s(t),this}withClasses(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._classes=s(t),this}withClassesToUnbox(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._classesToUnbox=s(t),this}build(){return new o(this._primitives,this._classesToUnbox,this._classes)}}r.FromJsConstructorBuilder=a;class o{constructor(e,t,r){this._primitives=e,this._classesToUnbox=t,this._classes=r}construct(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];if(null===t)return new i.dom.Null(i.IonTypes.NULL,r);var n=typeof t;if("object"==n){if(this._classesToUnbox.has(t.constructor))return new e(t.valueOf(),r);if(this._classes.has(t.constructor))return new e(t,r);throw new Error(`Unable to construct a(n) ${e.name} from a ${t.constructor.name}.`)}if(this._primitives.has(n))return new e(t,r);throw new Error(`Unable to construct a(n) ${e.name} from a ${n}.`)}}r.FromJsConstructor=o,(o=r.FromJsConstructor||(r.FromJsConstructor={})).NONE=(new a).build(),r.Primitives={Boolean:"boolean",Number:"number",String:"string",BigInt:"bigint"}},{"../Ion":5,"../util":55}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Integer=void 0;var n=e("../Ion"),i=e("./FromJsConstructor"),e=e("./Value"),s=BigInt,i=(new i.FromJsConstructorBuilder).withPrimitives(i.Primitives.Number,i.Primitives.BigInt).withClassesToUnbox(Number).withClasses(s).build();class a extends e.Value(Number,n.IonTypes.INT,i){constructor(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];"number"==typeof e?(super(e),this._numberValue=e,this._bigIntValue=null):(super(t=Number(e)),this._bigIntValue=e,this._numberValue=t),this._setAnnotations(r)}bigIntValue(){return null===this._bigIntValue&&(this._bigIntValue=BigInt(this.numberValue())),this._bigIntValue}numberValue(){return this._numberValue}toString(){return(null===this._bigIntValue?this._numberValue:this._bigIntValue).toString()}valueOf(){return this.numberValue()}writeTo(e){e.setAnnotations(this.getAnnotations()),null===this._bigIntValue?e.writeInt(this.numberValue()):e.writeInt(this._bigIntValue)}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let r=!1,n=null;return e instanceof a?(r=!0,n=null==this._bigIntValue&&null==e._bigIntValue?e.numberValue():e.bigIntValue()):t.onlyCompareIon||(e instanceof Number||"number"==typeof e?(r=!0,n=null==this.bigIntValue?e.valueOf():BigInt(e.valueOf())):"bigint"==typeof e&&(r=!0,n=e)),!!r&&("bigint"==typeof n?this.bigIntValue()===n:this.numberValue()==n)}}r.Integer=a},{"../Ion":5,"./FromJsConstructor":38,"./Value":50}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._ionValueFromJsValue=r._domConstructorFor=r._NativeJsString=r._NativeJsBoolean=void 0;const n=e("../Ion"),i=e("../IonTypes"),s=e("../util");r._NativeJsBoolean=Boolean,r._NativeJsString=String;let a=null;function o(e){var t=(a=null===a?new Map([[i.IonTypes.NULL,n.dom.Null],[i.IonTypes.BOOL,n.dom.Boolean],[i.IonTypes.INT,n.dom.Integer],[i.IonTypes.FLOAT,n.dom.Float],[i.IonTypes.DECIMAL,n.dom.Decimal],[i.IonTypes.TIMESTAMP,n.dom.Timestamp],[i.IonTypes.STRING,n.dom.String],[i.IonTypes.BLOB,n.dom.Blob],[i.IonTypes.LIST,n.dom.List],[i.IonTypes.STRUCT,n.dom.Struct]]):a).get(e);if(s._hasValue(t))return t;throw new Error("No dom type constructor was found for Ion type "+e.name)}r._domConstructorFor=o,r._ionValueFromJsValue=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return o(function(e){if(void 0===e)throw new Error("Cannot create an Ion value from `undefined`.");if(null===e)return i.IonTypes.NULL;var t=typeof e;switch(t){case"string":return i.IonTypes.STRING;case"number":return Number.isInteger(e)?i.IonTypes.INT:i.IonTypes.FLOAT;case"boolean":return i.IonTypes.BOOL;case"object":break;case"bigint":return i.IonTypes.INT;default:throw new Error(`Value.from() does not support the JS primitive type ${t}.`)}return e instanceof BigInt?i.IonTypes.INT:e instanceof Number?Number.isInteger(e.valueOf())?i.IonTypes.INT:i.IonTypes.FLOAT:e instanceof Boolean?i.IonTypes.BOOL:e instanceof String?i.IonTypes.STRING:e instanceof n.Decimal?i.IonTypes.DECIMAL:e instanceof Date||e instanceof n.Timestamp?i.IonTypes.TIMESTAMP:e instanceof Uint8Array?i.IonTypes.BLOB:e instanceof Array?i.IonTypes.LIST:i.IonTypes.STRUCT}(e))._fromJsValue(e,t)}},{"../Ion":5,"../IonTypes":29,"../util":55}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.List=void 0;var n=e("../Ion");class i extends e("./Sequence").Sequence(n.IonTypes.LIST){constructor(e){super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:[])}}r.List=i},{"../Ion":5,"./Sequence":45}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Lob=void 0;const s=e("../Ion");var n=e("./FromJsConstructor");const i=e("./Value"),a=(new n.FromJsConstructorBuilder).withClasses(Uint8Array).build();r.Lob=function(e){return class extends i.Value(Uint8Array,e,a){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super(e),this._setAnnotations(t)}uInt8ArrayValue(){return this}_valueEquals(e){let t=!1,r=null;if((1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0}).onlyCompareIon?e.getType()!==s.IonTypes.CLOB&&e.getType()!==s.IonTypes.BLOB||(t=!0,r=e.uInt8ArrayValue()):e instanceof Uint8Array&&(t=!0,r=e.valueOf()),!t)return!1;var n=this.uInt8ArrayValue(),i=r;if(n.length!==i.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}}}},{"../Ion":5,"./FromJsConstructor":38,"./Value":50}],43:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Null=void 0;const n=e("../Ion");var i=e("./FromJsConstructor");class s extends e("./Value").Value(Object,n.IonTypes.NULL,i.FromJsConstructor.NONE){constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:n.IonTypes.NULL,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super(),this._ionType=e,this._setAnnotations(t)}static _operationIsSupported(e,t){return s._supportedIonTypesByOperation.get(t).has(e)}isNull(){return!0}_convertToJsNull(e){if(s._operationIsSupported(this.getType(),e))return null;throw new Error(e+"() is not supported by Ion type "+this.getType().name)}_unsupportedOperationOrNullDereference(e){if(s._operationIsSupported(this.getType(),e))throw new Error(`${e}() called on a null ${this.getType().name}.`);throw new Error(e+"() is not supported by Ion type "+this.getType().name)}booleanValue(){return this._convertToJsNull("booleanValue")}numberValue(){return this._convertToJsNull("numberValue")}bigIntValue(){return this._convertToJsNull("bigIntValue")}decimalValue(){return this._convertToJsNull("decimalValue")}stringValue(){return this._convertToJsNull("stringValue")}dateValue(){return this._convertToJsNull("dateValue")}uInt8ArrayValue(){return this._convertToJsNull("uInt8ArrayValue")}fieldNames(){this._unsupportedOperationOrNullDereference("fieldNames")}fields(){this._unsupportedOperationOrNullDereference("fields")}elements(){this._unsupportedOperationOrNullDereference("elements")}get(){return null}toString(){return this.getType()==n.IonTypes.NULL?"null":"null."+this._ionType.name}toJSON(){return null}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeNull(this.getType())}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let r=!1,n=null;if(e instanceof s)r=!0,n=e;else if(!t.onlyCompareIon&&null===e&&"null"===this._ionType.name)return!0;return!!r&&this._ionType.name===n._ionType.name}}(r.Null=s)._supportedIonTypesByOperation=new Map([["booleanValue",new Set([n.IonTypes.BOOL])],["numberValue",new Set([n.IonTypes.INT,n.IonTypes.FLOAT,n.IonTypes.DECIMAL])],["bigIntValue",new Set([n.IonTypes.INT])],["decimalValue",new Set([n.IonTypes.DECIMAL])],["stringValue",new Set([n.IonTypes.STRING,n.IonTypes.SYMBOL])],["dateValue",new Set([n.IonTypes.TIMESTAMP])],["timestampValue",new Set([n.IonTypes.TIMESTAMP])],["uInt8ArrayValue",new Set([n.IonTypes.BLOB,n.IonTypes.CLOB])],["fields",new Set([n.IonTypes.STRUCT])],["fieldNames",new Set([n.IonTypes.STRUCT])],["elements",new Set([n.IonTypes.LIST,n.IonTypes.SEXP,n.IonTypes.STRUCT])]])},{"../Ion":5,"./FromJsConstructor":38,"./Value":50}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SExpression=void 0;var n=e("../Ion");class i extends e("./Sequence").Sequence(n.IonTypes.SEXP){constructor(e){super(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:[])}toString(){return"("+this.join(" ")+")"}}r.SExpression=i},{"../Ion":5,"./Sequence":45}],45:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Sequence=void 0;const a=e("../Ion"),n=e("./FromJsConstructor"),i=e("./Value");r.Sequence=function(r){return class extends i.Value(Array,r,n.FromJsConstructor.NONE){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super();for(const r of e)this.push(r);return this._setAnnotations(t),new Proxy(this,{set:function(e,t,r){return r instanceof i.Value||(r=i.Value.from(r)),e[t]=r,!0}})}get(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("Value#get requires at least one parameter.");var[n,...i]=t;if("number"!=typeof n)throw new Error(`Cannot index into a ${this.getType().name} with a ${typeof n}.`);n=this[n],n=void 0===n?null:n;return 0===i.length||null===n?n:n.get(...i)}elements(){return Object.values(this)}toString(){return"["+this.join(", ")+"]"}static _fromJsValue(e,t){if(e instanceof Array)return new this(e.map(e=>i.Value.from(e)),t);throw new Error(`Cannot create a ${this.name} from: `+e.toString())}writeTo(e){e.setAnnotations(this.getAnnotations()),e.stepIn(r);for(const t of this)t.writeTo(e);e.stepOut()}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let r=!1,n=null;if(t.onlyCompareIon?e.getType()!==a.IonTypes.LIST&&e.getType()!==a.IonTypes.SEXP||(r=!0,n=e.elements()):e instanceof Array&&(r=!0,n=e),!r)return!1;var i=this.elements(),s=n;if(i.length!==s.length)return!1;for(let e=0;e<i.length;e++)if(t.onlyCompareIon){if(!i[e].ionEquals(s[e],t))return!1}else if(!i[e].equals(s[e]))return!1;return!0}}}},{"../Ion":5,"./FromJsConstructor":38,"./Value":50}],46:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.String=void 0;var n=e("../Ion"),i=e("./FromJsConstructor");const s=e("./JsValueConversion");e=e("./Value"),i=(new i.FromJsConstructorBuilder).withPrimitives(i.Primitives.String).withClassesToUnbox(s._NativeJsString).build();class a extends e.Value(s._NativeJsString,n.IonTypes.STRING,i){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super(e),this._setAnnotations(t)}stringValue(){return this.toString()}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeString(this.stringValue())}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let r=!1,n=null;return e instanceof a?(r=!0,n=e.stringValue()):t.onlyCompareIon||("string"==typeof e||e instanceof s._NativeJsString)&&(r=!0,n=e.valueOf()),!!r&&0===this.compareValue(n)}compareValue(e){return this.stringValue().localeCompare(e)}}r.String=a},{"../Ion":5,"./FromJsConstructor":38,"./JsValueConversion":40,"./Value":50}],47:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Struct=void 0;const i=e("../Ion");var n=e("./FromJsConstructor");const l=e("./Value");class u extends l.Value(Object,i.IonTypes.STRUCT,n.FromJsConstructor.NONE){constructor(e){var t,r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super(),this._fields=Object.create(null);for([t,r]of e)this._fields[t]=r instanceof l.Value?[r]:r;return this._setAnnotations(n),new Proxy(this,{set:function(e,t,r){return r instanceof l.Value||(r=l.Value.from(r)),e._fields[t]=[r],!0},get:function(e,t){var r;return t in e?e[t]:-1===(r=void 0!==e._fields[t]?e._fields[t].length:-1)?e._fields[t]:e._fields[t][r-1]},deleteProperty:function(e,t){return t in e._fields&&delete e._fields[t],!0}})}get(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("Value#get requires at least one parameter.");var[n,...i]=t;if("string"!=typeof n)throw new Error(`Cannot index into a struct with a ${typeof n}.`);n=this._fields[n];return void 0===n?null:0===i.length?n[n.length-1]:n[n.length-1].get(...i)}getAll(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("Value#get requires at least one parameter.");const[n,...i]=t;if("string"!=typeof n)throw new Error(`Cannot index into a struct with a ${typeof n}.`);var s=this._fields[n];if(void 0===s)return null;if(0===i.length)return s;let a=[];return s.forEach(e=>a.push(...e.getAll(...i))),a}fieldNames(){return Object.keys(this._fields)}allFields(){return Object.entries(this._fields)}fields(){var e,t,r=Object.create(null);for([e,t]of this.allFields())r[e]=t[t.length-1];return Object.entries(r)}elements(){return Object.values(this._fields).flat()}[Symbol.iterator](){return this.fields()[Symbol.iterator]()}toString(){return"{"+[...this.allFields()].map(e=>{var[e,t]=e;return e+": "+t}).join(", ")+"}"}writeTo(e){e.setAnnotations(this.getAnnotations()),e.stepIn(i.IonTypes.STRUCT);for(var[t,r]of this.allFields())for(var n of r)e.writeFieldName(t),n.writeTo(e);e.stepOut()}deleteField(e){return e in this._fields&&(delete this._fields[e],!0)}toJSON(){var e,t,r=Object.create(u.prototype);for([e,t]of this.fields())r[e]=t;return r}static _fromJsValue(e,t){if(e instanceof Object)return new this(Object.entries(e).map(e=>{var[e,t]=e;return[e,[l.Value.from(t)]]}),t);throw new Error("Cannot create a dom.Struct from: "+e.toString())}_valueEquals(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let t=!1,n=null;if(e instanceof u?(t=!0,n=e.allFields()):r.onlyCompareIon||("object"==typeof e||e instanceof Object)&&(t=!0,n=l.Value.from(e).allFields()),!t)return!1;if(this.allFields().length!==n.length)return!1;let i=!0;var s,a,o=new Array(n.length);for(let t=0;i&&t<this.allFields().length;t++){i=!1;for(let e=0;!i&&e<n.length;e++)!o[e]&&(s=this.allFields()[t],a=n[e],i=s[0]===a[0]&&this._ionValueEquals(s[1].sort(),a[1].sort(),r))&&(o[e]=!0)}for(let e=0;e<o.length;e++)if(!o[e]){i=!1;break}return i}_ionValueEquals(t,r,n){if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(n.onlyCompareIon){if(!t[e].ionEquals(r[e],n))return!1}else if(!t[e].equals(r[e]))return!1;return!0}}r.Struct=u},{"../Ion":5,"./FromJsConstructor":38,"./Value":50}],48:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Symbol=void 0;var n=e("../Ion"),i=e("./FromJsConstructor"),e=e("./Value"),i=(new i.FromJsConstructorBuilder).withPrimitives(i.Primitives.String).withClassesToUnbox(String).build();class s extends e.Value(String,n.IonTypes.SYMBOL,i){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];super(e),this._setAnnotations(t)}stringValue(){return this.toString()}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeSymbol(this.stringValue())}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let r=!1,n=null;return e instanceof s?(r=!0,n=e.stringValue()):t.onlyCompareIon||("string"==typeof e||e instanceof String)&&(r=!0,n=e.valueOf()),!!r&&0===this.compareValue(n)}compareValue(e){return this.stringValue().localeCompare(e)}}r.Symbol=s},{"../Ion":5,"./FromJsConstructor":38,"./Value":50}],49:[function(e,t,r){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Timestamp=void 0;const a=s(e("../Ion")),o=e("../Ion");s=e("./FromJsConstructor"),e=e("./Value"),s=(new s.FromJsConstructorBuilder).withClasses(Date,a.Timestamp).build();class l extends e.Value(Date,o.IonTypes.TIMESTAMP,s){constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];let r,n;e instanceof Date?(r=e,n=l._timestampFromDate(r)):(n=e,r=n.getDate()),super(r),this._date=r,this._timestamp=n,this._setAnnotations(t)}static _timestampFromDate(e){var t=1e3*e.getUTCSeconds()+e.getUTCMilliseconds(),t=new o.Decimal(t,-3);return new a.Timestamp(0,e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),t)}timestampValue(){return this._timestamp}dateValue(){return this._date}writeTo(e){e.setAnnotations(this.getAnnotations()),e.writeTimestamp(this.timestampValue())}_valueEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1,onlyCompareIon:!0};let r=!1,n=null;if(e instanceof l)r=!0,n=e.timestampValue();else if(!t.onlyCompareIon)if(e instanceof a.Timestamp)r=!0,n=e;else if(e instanceof Date)return this.dateValue().getTime()===e.getTime();return!!r&&(t.ignoreTimestampPrecision?0===this.timestampValue().compareTo(n):this.timestampValue().equals(n))}}r.Timestamp=l},{"../Ion":5,"./FromJsConstructor":38,"./Value":50}],50:[function(e,t,r){"use strict";var n,i=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&i(t,e,r);return s(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Value=void 0;const o=e("../util"),l=a(e("./JsValueConversion")),u=Symbol("ion.dom.Value");function h(e,t,r){e=class extends e{constructor(){super(...arguments),this._ionType=t,this._ionAnnotations=[],Object.defineProperty(this,"_ionType",{enumerable:!1}),Object.defineProperty(this,"_ionAnnotations",{enumerable:!1})}_unsupportedOperation(e){throw new Error(`Value#${e}() is not supported by Ion type `+this.getType().name)}getType(){return this._ionType}_setAnnotations(e){this._ionAnnotations=e}getAnnotations(){return null===this._ionAnnotations?[]:this._ionAnnotations}isNull(){return!1}booleanValue(){this._unsupportedOperation("booleanValue")}numberValue(){this._unsupportedOperation("numberValue")}bigIntValue(){this._unsupportedOperation("bigIntValue")}decimalValue(){this._unsupportedOperation("decimalValue")}stringValue(){this._unsupportedOperation("stringValue")}dateValue(){this._unsupportedOperation("dateValue")}timestampValue(){this._unsupportedOperation("timestampValue")}uInt8ArrayValue(){this._unsupportedOperation("uInt8ArrayValue")}fieldNames(){this._unsupportedOperation("fieldNames")}fields(){this._unsupportedOperation("fields")}allFields(){this._unsupportedOperation("allFields")}elements(){this._unsupportedOperation("elements")}get(){this._unsupportedOperation("get")}getAll(){this._unsupportedOperation("getAll")}as(e){if(this instanceof e)return this;throw new Error(this.constructor.name+" is not an instance of "+e.name)}writeTo(e){this._unsupportedOperation("writeTo")}deleteField(e){this._unsupportedOperation("deleteField")}_valueEquals(e){this._unsupportedOperation("_valueEquals")}equals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null};let r=!1;return e instanceof h&&(r=!0),this._valueEquals(e,{onlyCompareIon:r,ignoreTimestampPrecision:!0,ignoreAnnotations:!0,epsilon:t.epsilon,coerceNumericType:!0})}ionEquals(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{epsilon:null,ignoreAnnotations:!1,ignoreTimestampPrecision:!1};if(!t.ignoreAnnotations){if(!(e instanceof h))return!1;var r=this.getAnnotations(),n=e.getAnnotations();if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++)if(0!==r[e].localeCompare(n[e]))return!1}t={onlyCompareIon:!0,ignoreTimestampPrecision:t.ignoreTimestampPrecision,epsilon:t.epsilon,coerceNumericType:!1};return this._valueEquals(e,t)}static _getIonType(){return t}static _fromJsValue(e,t){return r.construct(this,e,t)}};return Object.defineProperty(e,u,{writable:!1,enumerable:!1,value:u}),e}r.Value=h,(n=h=r.Value||(r.Value={})).from=function(e,t){if(e instanceof n){if(o._hasValue(t))throw new Error("Value.from() does not support overriding the annotations on a dom.Value passed as an argument.");return e}return l._ionValueFromJsValue(e,t)},Object.defineProperty(h,Symbol.hasInstance,{get:()=>e=>o._hasValue(e)&&o._hasValue(e.constructor)&&u in e.constructor&&e.constructor[u]===u})},{"../util":55,"./JsValueConversion":40}],51:[function(e,x,t){"use strict";var n=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]},i=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.load=t.loadAll=void 0;const l=r(e("../Ion")),u=e("../Ion"),s=e("../IonBinaryReader"),a=e("../IonTextReader"),h=e("./Blob"),_=e("./Clob"),c=e("./Decimal"),p=e("./Float"),d=e("./Integer"),T=e("./List"),f=e("./Null"),m=e("./SExpression"),y=e("./Struct"),g=e("./Symbol"),I=e("./Timestamp");function o(e){return e instanceof a.TextReader||e instanceof s.BinaryReader?e:u.makeReader(e)}function w(e){var t=e.type();if(null===t)throw new Error("loadValue() called when no further values were available to read.");var r,n,i=e.annotations();if(e.isNull())return new f.Null(e.type(),i);switch(t){case u.IonTypes.NULL:return new f.Null(u.IonTypes.NULL,i);case u.IonTypes.BOOL:return new l.dom.Boolean(e.booleanValue(),i);case u.IonTypes.INT:return e.intSize()==u.IntSize.Number?new d.Integer(e.numberValue(),i):new d.Integer(e.bigIntValue(),i);case u.IonTypes.FLOAT:return new p.Float(e.numberValue(),i);case u.IonTypes.DECIMAL:return new c.Decimal(e.decimalValue(),i);case u.IonTypes.TIMESTAMP:return new I.Timestamp(e.timestampValue(),i);case u.IonTypes.SYMBOL:return new g.Symbol(e.stringValue(),i);case u.IonTypes.STRING:return new l.dom.String(e.stringValue(),i);case u.IonTypes.CLOB:return new _.Clob(e.uInt8ArrayValue(),i);case u.IonTypes.BLOB:return new h.Blob(e.uInt8ArrayValue(),i);case u.IonTypes.LIST:return n=(r=e).annotations(),new T.List(b(r),n);case u.IonTypes.SEXP:return n=(r=e).annotations(),new m.SExpression(b(r),n);case u.IonTypes.STRUCT:var s=e,a=new Map,o=s.annotations();for(s.stepIn();s.next();)a.has(s.fieldName())?a.get(s.fieldName()).push(w(s)):a.set(s.fieldName(),[w(s)]);return s.stepOut(),new y.Struct(a.entries(),o);default:throw new Error(`Unrecognized IonType '${t}' found.`)}}function b(e){var t=[];for(e.stepIn();e.next();)t.push(w(e));return e.stepOut(),t}t.loadAll=function(e){for(var t=o(e),r=[];t.next();)r.push(w(t));return r},t.load=function(e){return null===(e=o(e)).type()&&e.next(),null===e.type()?null:w(e)};var v=e("./Value"),S=(Object.defineProperty(t,"Value",{enumerable:!0,get:function(){return v.Value}}),e("./Null")),E=(Object.defineProperty(t,"Null",{enumerable:!0,get:function(){return S.Null}}),e("./Boolean")),C=(Object.defineProperty(t,"Boolean",{enumerable:!0,get:function(){return E.Boolean}}),e("./Integer")),N=(Object.defineProperty(t,"Integer",{enumerable:!0,get:function(){return C.Integer}}),e("./Float")),A=(Object.defineProperty(t,"Float",{enumerable:!0,get:function(){return N.Float}}),e("./Decimal")),O=(Object.defineProperty(t,"Decimal",{enumerable:!0,get:function(){return A.Decimal}}),e("./Timestamp")),L=(Object.defineProperty(t,"Timestamp",{enumerable:!0,get:function(){return O.Timestamp}}),e("./String")),V=(Object.defineProperty(t,"String",{enumerable:!0,get:function(){return L.String}}),e("./Symbol")),B=(Object.defineProperty(t,"Symbol",{enumerable:!0,get:function(){return V.Symbol}}),e("./Blob")),U=(Object.defineProperty(t,"Blob",{enumerable:!0,get:function(){return B.Blob}}),e("./Clob")),R=(Object.defineProperty(t,"Clob",{enumerable:!0,get:function(){return U.Clob}}),e("./Struct")),M=(Object.defineProperty(t,"Struct",{enumerable:!0,get:function(){return R.Struct}}),e("./List")),F=(Object.defineProperty(t,"List",{enumerable:!0,get:function(){return M.List}}),e("./SExpression"));Object.defineProperty(t,"SExpression",{enumerable:!0,get:function(){return F.SExpression}})},{"../Ion":5,"../IonBinaryReader":7,"../IonTextReader":25,"./Blob":33,"./Boolean":34,"./Clob":35,"./Decimal":36,"./Float":37,"./Integer":39,"./List":41,"./Null":43,"./SExpression":44,"./String":46,"./Struct":47,"./Symbol":48,"./Timestamp":49,"./Value":50}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EventStreamError=void 0;class n extends Error{constructor(e,t,r,n){super(),this.type=e,this.index=r,this.message=t,this.eventstream=n}}r.EventStreamError=n},{}],53:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IonEventFactory=r.IonEventType=void 0;const l=e("../ComparisonResult"),n=e("../IonBinaryWriter"),i=e("../IonLocalSymbolTable"),s=e("../IonTextWriter"),o=e("../IonTypes"),a=e("../IonUnicode"),u=e("../IonWriteable");var h;(e=h=r.IonEventType||(r.IonEventType={}))[e.SCALAR=0]="SCALAR",e[e.CONTAINER_START=1]="CONTAINER_START",e[e.CONTAINER_END=2]="CONTAINER_END",e[e.SYMBOL_TABLE=3]="SYMBOL_TABLE",e[e.STREAM_END=4]="STREAM_END";class _{constructor(e,t,r,n,i,s){this.eventType=e,this.ionType=t,this.fieldName=r,this.annotations=n,this.depth=i,this.ionValue=s}write(e){e.stepIn(o.IonTypes.STRUCT),e.writeFieldName("event_type"),e.writeSymbol(h[this.eventType]),null!==this.ionType&&(e.writeFieldName("ion_type"),e.writeSymbol(this.ionType.name.toUpperCase())),null!==this.fieldName&&void 0!==this.fieldName&&(e.writeFieldName("field_name"),e.stepIn(o.IonTypes.STRUCT),e.writeFieldName("text"),e.writeString(this.fieldName),e.stepOut()),null!==this.annotations&&(e.writeFieldName("annotations"),this.writeAnnotations(e)),this.eventType===h.SCALAR&&this.writeValues(e),e.writeFieldName("depth"),e.writeInt(this.depth),e.stepOut()}writeAnnotations(t){if(void 0===this.annotations)t.writeNull(o.IonTypes.LIST);else{t.stepIn(o.IonTypes.LIST);for(let e=0;e<this.annotations.length;e++)t.stepIn(o.IonTypes.STRUCT),t.writeFieldName("text"),t.writeString(this.annotations[e]),t.stepOut();t.stepOut()}}writeSymbolToken(e,t){e.writeSymbol(t)}writeImportDescriptor(e){e.writeNull(o.IonTypes.STRUCT)}writeValues(e){this.eventType===h.SCALAR&&(e.writeFieldName("value_text"),this.writeTextValue(e),e.writeFieldName("value_binary"),this.writeBinaryValue(e))}writeTextValue(e){var t=new s.TextWriter(new u.Writeable);this.writeIonValue(t),t.close(),e.writeString(a.decodeUtf8(t.getBytes()))}writeBinaryValue(t){var e=new n.BinaryWriter(i.defaultLocalSymbolTable(),new u.Writeable),r=(this.writeIonValue(e),e.close(),e.getBytes());t.stepIn(o.IonTypes.LIST);for(let e=0;e<r.length;e++)t.writeInt(r[e]);t.stepOut()}equals(e){return this.compare(e).result==l.ComparisonResultType.EQUAL}compare(e){var t;return this.eventType!==e.eventType?new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Event types don't match"):this.ionType!==e.ionType?new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Ion types don't match "+(null==(t=this.ionType)?void 0:t.name)+" vs. "+(null==(t=e.ionType)?void 0:t.name)):this.fieldName!==e.fieldName?new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Field names don't match "+this.fieldName+" vs. "+e.fieldName):this.depth!==e.depth?new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Event depths don't match "+this.depth+" vs. "+e.depth):(t=this.annotationCompare(e.annotations)).result===l.ComparisonResultType.NOT_EQUAL?t:(t=this.valueCompare(e)).result===l.ComparisonResultType.NOT_EQUAL?t:new l.ComparisonResult(l.ComparisonResultType.EQUAL)}annotationCompare(t){if(this.annotations!==t){if(this.annotations.length!==t.length)return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"annotations length don't match"+this.annotations.length+" vs. "+t.length);for(let e=0;e<this.annotations.length;e++)if(this.annotations[e]!==t[e])return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"annotation value doesn't match"+this.annotations[e]+" vs. "+t[e])}return new l.ComparisonResult(l.ComparisonResultType.EQUAL)}}r.IonEventFactory=class{makeEvent(e,t,r,n,i,s,a){if(s)return new c(e,t,r,i,n);switch(e){case h.SCALAR:case h.CONTAINER_START:switch(t){case o.IonTypes.BOOL:return new d(e,t,r,i,n,a);case o.IonTypes.INT:return new p(e,t,r,i,n,a);case o.IonTypes.FLOAT:return new T(e,t,r,i,n,a);case o.IonTypes.DECIMAL:return new f(e,t,r,i,n,a);case o.IonTypes.SYMBOL:return new m(e,t,r,i,n,a);case o.IonTypes.STRING:return new y(e,t,r,i,n,a);case o.IonTypes.TIMESTAMP:return new g(e,t,r,i,n,a);case o.IonTypes.BLOB:return new I(e,t,r,i,n,a);case o.IonTypes.CLOB:return new w(e,t,r,i,n,a);case o.IonTypes.LIST:return new S(e,t,r,i,n);case o.IonTypes.SEXP:return new E(e,t,r,i,n);case o.IonTypes.STRUCT:return new v(e,t,r,i,n);default:throw new Error("IonType "+t.name+" unexpected.")}case h.SYMBOL_TABLE:throw new Error("symbol tables unsupported.");case h.CONTAINER_END:case h.STREAM_END:return new C(e,n,t)}}};class c extends _{constructor(e,t,r,n,i){super(e,t,r,n,i,null)}valueCompare(e){return e instanceof c&&this.ionValue===e.ionValue?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeNull(null!==this.ionType?this.ionType:o.IonTypes.NULL)}}class p extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(e){if(e instanceof p&&("bigint"==typeof this.ionValue?this.ionValue:BigInt(this.ionValue))===("bigint"==typeof e.ionValue?e.ionValue:BigInt(e.ionValue)))return new l.ComparisonResult(l.ComparisonResultType.EQUAL);return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeInt(this.ionValue)}}class d extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(e){return e instanceof d&&this.ionValue===e.ionValue?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeBoolean(this.ionValue)}}class T extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(e){return e instanceof T&&Object.is(this.ionValue,e.ionValue)?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeFloat64(this.ionValue)}}class f extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(e){return e instanceof f&&this.ionValue.equals(e.ionValue)?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeDecimal(this.ionValue)}}class m extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(e){return e instanceof m&&this.ionValue===e.ionValue?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeSymbol(this.ionValue)}}class y extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(e){return e instanceof y&&this.ionValue===e.ionValue?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeString(this.ionValue)}}class g extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(e){return e instanceof g&&this.ionValue.equals(e.ionValue)?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){e.writeTimestamp(this.ionValue)}}class I extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(t){if(!(t instanceof I))return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL);if(this.ionValue.length!==t.ionValue.length)return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Blob length don't match");for(let e=0;e<this.ionValue.length;e++)if(this.ionValue[e]!==t.ionValue[e])return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue[e]+" vs. "+t.ionValue[e]);return new l.ComparisonResult(l.ComparisonResultType.EQUAL)}writeIonValue(e){e.writeBlob(this.ionValue)}}class w extends _{constructor(e,t,r,n,i,s){super(e,t,r,n,i,s)}valueCompare(t){if(!(t instanceof w))return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL);if(this.ionValue.length!==t.ionValue.length)return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+t.ionValue);for(let e=0;e<this.ionValue.length;e++)if(this.ionValue[e]!==t.ionValue[e])return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue[e]+" vs. "+t.ionValue[e]);return new l.ComparisonResult(l.ComparisonResultType.EQUAL)}writeIonValue(e){e.writeClob(this.ionValue)}}class b extends _{constructor(e,t,r,n,i){super(e,t,r,n,i,null)}writeIonValue(e){}}class v extends b{constructor(e,t,r,n,i){super(e,t,r,n,i)}valueCompare(e){var t;return e instanceof v?(t=null==this.ionValue?[]:this.ionValue,e=null==e.ionValue?[]:e.ionValue,t.length!==e.length?new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Struct length don't match"):this.structsCompare(t,e)):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Event types don't match")}structsCompare(r,n){let i=new l.ComparisonResult(l.ComparisonResultType.EQUAL);var s=new Array(n.length);for(let e=0;i&&e<r.length;e++){i.result=l.ComparisonResultType.NOT_EQUAL;for(let t=0;i.result==l.ComparisonResultType.NOT_EQUAL&&t<n.length;t++)if(!s[t]){var a=r[e],o=n[t];if((i=a.compare(o)).result==l.ComparisonResultType.EQUAL&&(s[t]=!0),i.result==l.ComparisonResultType.EQUAL&&a.eventType===h.CONTAINER_START){for(let e=0;e<o.ionValue.length;e++)s[e+t+1]=!0;e+=a.ionValue.length}}}for(let e=0;e<s.length;e++)if(!s[e]){i=new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Didn't find matching field for "+n[e].fieldName);break}return i}}class S extends b{constructor(e,t,r,n,i){super(e,t,r,n,i)}valueCompare(e){if(!(e instanceof S))return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Event types don't match");var t=null==this.ionValue?[]:this.ionValue,r=null==e.ionValue?[]:e.ionValue;if(t.length!==r.length)return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"List length don't match");for(let e=0;e<t.length;e++){var n=t[e];if(n.compare(r[e]).result==l.ComparisonResultType.NOT_EQUAL)return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,n.ionValue+" vs. "+r[e].ionValue,e+1,e+1);n.eventType===h.CONTAINER_START&&(e+=n.ionValue.length)}return new l.ComparisonResult(l.ComparisonResultType.EQUAL)}}class E extends b{constructor(e,t,r,n,i){super(e,t,r,n,i)}valueCompare(e){if(!(e instanceof E))return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"Event types don't match");var t=null==this.ionValue?[]:this.ionValue,r=null==e.ionValue?[]:e.ionValue;if(t.length!==r.length)return new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,"S-expression length don't match");for(let e=0;e<t.length;e++){var n=t[e],i=n.compare(r[e]);if(i.result==l.ComparisonResultType.NOT_EQUAL)return i;n.eventType===h.CONTAINER_START&&(e+=n.ionValue.length)}return new l.ComparisonResult(l.ComparisonResultType.EQUAL)}}class C extends _{constructor(e,t,r){e===h.STREAM_END?super(e,null,null,[],t,void 0):super(e,r,null,[],t,void 0)}valueCompare(e){return e instanceof C&&this.ionValue===e.ionValue?new l.ComparisonResult(l.ComparisonResultType.EQUAL):new l.ComparisonResult(l.ComparisonResultType.NOT_EQUAL,this.ionValue+" vs. "+e.ionValue)}writeIonValue(e){}}},{"../ComparisonResult":3,"../IonBinaryWriter":8,"../IonLocalSymbolTable":13,"../IonTextWriter":26,"../IonTypes":29,"../IonUnicode":30,"../IonWriteable":31}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IonEventStream=void 0;const a=e("../ComparisonResult"),o=e("../ComparisonResult"),l=e("../Ion"),n=e("../IonBinaryReader"),i=e("../IonSpan"),s=e("../IonTypes"),u=e("./EventStreamError"),h=e("./IonEvent");r.IonEventStream=class{constructor(e){this.events=[],this.reader=e,this.eventFactory=new h.IonEventFactory,this.isEventStream=!1,this.generateStream()}writeEventStream(t){t.writeSymbol("$ion_event_stream");for(let e=0;e<this.events.length;e++)this.events[e].write(t)}writeIon(r){try{var n;let t=!1;for(let e=0;e<this.events.length;e++)switch(null!==(n=this.events[e]).fieldName&&r.writeFieldName(n.fieldName),n.ionType!=s.IonTypes.SEXP&&n.ionType!=s.IonTypes.LIST||!this.isEmbedded(n)||(t=!0),r.setAnnotations(n.annotations),n.eventType){case h.IonEventType.SCALAR:if(null==n.ionValue)return void r.writeNull(n.ionType);if(t)r.writeString(n.ionValue.toString());else switch(n.ionType){case s.IonTypes.BOOL:r.writeBoolean(n.ionValue);break;case s.IonTypes.STRING:r.writeString(n.ionValue);break;case s.IonTypes.SYMBOL:r.writeSymbol(n.ionValue);break;case s.IonTypes.INT:r.writeInt(n.ionValue);break;case s.IonTypes.DECIMAL:r.writeDecimal(n.ionValue);break;case s.IonTypes.FLOAT:r.writeFloat64(n.ionValue);break;case s.IonTypes.NULL:r.writeNull(n.ionType);break;case s.IonTypes.TIMESTAMP:r.writeTimestamp(n.ionValue);break;case s.IonTypes.CLOB:r.writeClob(n.ionValue);break;case s.IonTypes.BLOB:r.writeBlob(n.ionValue);break;default:throw new Error("unexpected type: "+n.ionType.name)}break;case h.IonEventType.CONTAINER_START:r.stepIn(n.ionType);break;case h.IonEventType.CONTAINER_END:t=t&&!1,r.stepOut();break;case h.IonEventType.STREAM_END:break;case h.IonEventType.SYMBOL_TABLE:throw new Error("Symboltables unsupported.");default:throw new Error("Unexpected event type: "+n.eventType)}r.close()}catch(e){throw new u.EventStreamError("WRITE",e.message,this.events.length,this.events)}}getEvents(){return this.events}equals(e){return this.compare(e).result==o.ComparisonResultType.EQUAL}compare(e){let t=0,r=0;if(this.events.length!=e.events.length)return new a.ComparisonResult(o.ComparisonResultType.NOT_EQUAL,"The event streams have different lengths");for(;t<this.events.length&&r<e.events.length;){var n=this.events[t],i=e.events[r];if(n.eventType===h.IonEventType.SYMBOL_TABLE&&t++,i.eventType===h.IonEventType.SYMBOL_TABLE&&r++,n.eventType!==h.IonEventType.SYMBOL_TABLE&&i.eventType!==h.IonEventType.SYMBOL_TABLE){switch(n.eventType){case h.IonEventType.SCALAR:var s=n.compare(i);if(s.result==o.ComparisonResultType.NOT_EQUAL)return s.actualIndex=t,s.expectedIndex=r,s;break;case h.IonEventType.CONTAINER_START:s=n.compare(i);if(s.result==o.ComparisonResultType.NOT_EQUAL)return t+=s.actualIndex,r+=s.expectedIndex,s.actualIndex=t,s.expectedIndex=r,s;null!==n.ionValue&&null!==i.ionValue&&(t+=n.ionValue.length,r+=i.ionValue.length);break;case h.IonEventType.CONTAINER_END:case h.IonEventType.STREAM_END:break;default:throw new Error("Unexpected event type: "+n.eventType)}t++,r++}}return new a.ComparisonResult(o.ComparisonResultType.EQUAL)}isEmbedded(e){return"embedded_documents"===e.annotations[0]}generateStream(){try{let e=this.reader.next();if(e===s.IonTypes.SYMBOL&&"$ion_event_stream"===this.reader.stringValue())this.marshalStream(),this.isEventStream=!0;else for(var t=[],r=[];;){if(this.reader.isNull())this.events.push(this.eventFactory.makeEvent(h.IonEventType.SCALAR,e,this.reader.fieldName(),this.reader.depth(),this.reader.annotations(),!0,this.reader.value()));else switch(e){case s.IonTypes.LIST:case s.IonTypes.SEXP:case s.IonTypes.STRUCT:var n=this.eventFactory.makeEvent(h.IonEventType.CONTAINER_START,e,this.reader.fieldName(),this.reader.depth(),this.reader.annotations(),!1,null);this.events.push(n),t.push(n),r.push(this.events.length),this.reader.stepIn();break;case null:if(0===this.reader.depth())return void this.events.push(this.eventFactory.makeEvent(h.IonEventType.STREAM_END,s.IonTypes.NULL,null,this.reader.depth(),[],!1,void 0));this.reader.stepOut(),this.endContainer(t.pop(),r.pop());break;default:this.events.push(this.eventFactory.makeEvent(h.IonEventType.SCALAR,e,this.reader.fieldName(),this.reader.depth(),this.reader.annotations(),!1,this.reader.value()))}e=this.reader.next()}}catch(e){throw new u.EventStreamError("READ",e.message,this.events.length,this.events)}}endContainer(e,t){this.events.push(this.eventFactory.makeEvent(h.IonEventType.CONTAINER_END,e.ionType,null,e.depth,[],!1,null)),e.ionValue=this.events.slice(t,this.events.length)}marshalStream(){this.events=[];var t=[],r=[];for(let e=this.reader.next();e===s.IonTypes.STRUCT;e=this.reader.next()){this.reader.stepIn();var n=this.marshalEvent();if(n.eventType===h.IonEventType.CONTAINER_START)t.push(n),this.events.push(n),r.push(this.events.length);else if(n.eventType===h.IonEventType.CONTAINER_END)this.endContainer(t.pop(),r.pop());else{if(n.eventType!==h.IonEventType.SCALAR&&n.eventType!==h.IonEventType.STREAM_END)throw new Error("Unexpected eventType: "+n.eventType);this.events.push(n)}this.reader.stepOut()}}marshalEvent(){for(var t={};this.reader.next();){var r=this.reader.fieldName();if(r&&void 0!==t[r])throw new Error("Repeated event field: "+r);switch(r){case"event_type":t[r]=this.reader.stringValue();break;case"ion_type":t[r]=this.parseIonType();break;case"field_name":t[r]=this.resolveFieldNameFromSerializedSymbolToken();break;case"annotations":t[r]=this.parseAnnotations();break;case"value_text":{let e=this.reader.stringValue();"$ion_"===e.substr(0,5)&&(e="$ion_user_value::"+e);var n=l.makeReader(e),i=(n.next(),n.value());t.isNull=n.isNull(),t[r]=i;break}case"value_binary":t[r]=this.parseBinaryValue();break;case"imports":t[r]=this.parseImports();break;case"depth":t[r]=this.reader.numberValue();break;default:throw new Error("Unexpected event field: "+r)}}let e;switch(t.event_type){case"CONTAINER_START":e=h.IonEventType.CONTAINER_START;break;case"STREAM_END":e=h.IonEventType.STREAM_END;break;case"CONTAINER_END":e=h.IonEventType.CONTAINER_END;break;case"SCALAR":e=h.IonEventType.SCALAR;break;case"SYMBOL_TABLE":throw new Error("Symbol tables unsupported")}var s=void 0!==t.field_name?t.field_name:null,a=(t.annotations||(t.annotations=[]),this.eventFactory.makeEvent(e,t.ion_type,s,t.depth,t.annotations,t.isNull,t.value_text));if(e===h.IonEventType.SCALAR){s=this.eventFactory.makeEvent(e,t.ion_type,s,t.depth,t.annotations,t.isNull,t.value_binary);if(!a.equals(s))throw new Error(`Text event ${t.value_text} does not equal binary event `+t.value_binary)}return a}parseIonType(){var e=this.reader.stringValue().toLowerCase();switch(e){case"null":return s.IonTypes.NULL;case"bool":return s.IonTypes.BOOL;case"int":return s.IonTypes.INT;case"float":return s.IonTypes.FLOAT;case"decimal":return s.IonTypes.DECIMAL;case"timestamp":return s.IonTypes.TIMESTAMP;case"symbol":return s.IonTypes.SYMBOL;case"string":return s.IonTypes.STRING;case"clob":return s.IonTypes.CLOB;case"blob":return s.IonTypes.BLOB;case"list":return s.IonTypes.LIST;case"sexp":return s.IonTypes.SEXP;case"struct":return s.IonTypes.STRUCT;default:throw new Error("i: "+e)}}parseAnnotations(){var e=[];if(!this.reader.isNull()){this.reader.stepIn();for(;t=this.reader.next();)if(t==s.IonTypes.STRUCT){this.reader.stepIn();var t=this.reader.next();if("text"==this.reader.fieldName()&&t==s.IonTypes.STRING){var r=this.reader.stringValue();null!==r&&e.push(r)}else if("importLocation"==this.reader.fieldName()&&t==s.IonTypes.INT){r=l.defaultLocalSymbolTable().getSymbolText(this.reader.numberValue());if(null==r)throw new Error("Unresolvable symbol ID, symboltokens unsupported.");e.push(r)}this.reader.stepOut()}this.reader.stepOut()}return e}parseBinaryValue(){if(this.reader.isNull())return null;var e=[];this.reader.stepIn();let t=this.reader.next();for(;t;)e.push(this.reader.numberValue()),t=this.reader.next();this.reader.stepOut();var r=new Uint8Array(e),r=new n.BinaryReader(new i.BinarySpan(r));return r.next(),r.value()}parseImports(){return this.reader.value()}resolveFieldNameFromSerializedSymbolToken(){if(!this.reader.isNull()){this.reader.stepIn();var e=this.reader.next();if("text"==this.reader.fieldName()&&e==s.IonTypes.STRING){var t=this.reader.stringValue();if(null!==t)return this.reader.stepOut(),t}else if("importLocation"==this.reader.fieldName()&&e==s.IonTypes.INT){t=l.defaultLocalSymbolTable().getSymbolText(this.reader.numberValue());if(null==t)throw new Error("Unresolvable symbol ID, symboltokens unsupported.");return this.reader.stepOut(),t}}return null}}},{"../ComparisonResult":3,"../Ion":5,"../IonBinaryReader":7,"../IonSpan":19,"../IonTypes":29,"./EventStreamError":52,"./IonEvent":53}],55:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isSafeInteger=r._assertDefined=r._hasValue=r._sign=void 0,r._sign=function(e){return e<0||0===e&&1/e==-1/0?-1:1},r._hasValue=function(e){return null!=e},r._assertDefined=function(e){if(void 0===e)throw new Error("Expected value to be defined")},r.isSafeInteger=function(e){return e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER}},{}],56:[function(e,t,r){function n(){return t.exports=n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t.exports.__esModule=!0,t.exports.default=t.exports,n.apply(this,arguments)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},{}],57:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}]},{},[5])(5)});