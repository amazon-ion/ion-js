!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ion=e()}}(function(){return function a(s,o,u){function l(t,e){if(!o[t]){if(!s[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(_)return _(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var n=o[t]={exports:{}};s[t][0].call(n.exports,function(e){return l(s[t][1][e]||e)},n,n.exports,a,s,o,u)}return o[t].exports}for(var _="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var s=e("./IonTypes"),o=function(){function e(){(0,n.default)(this,e),this._annotations=[]}return(0,a.default)(e,[{key:"addAnnotation",value:function(e){if(!this._isString(e))throw new Error("Annotation must be of type string.");this._annotations.push(e)}},{key:"setAnnotations",value:function(e){if(null==e)throw new Error("Annotations were undefined or null.");if(!this._validateAnnotations(e))throw new Error("Annotations must be of type string[].");this._annotations=e}},{key:"writeValues",value:function(e){this._writeValues(e)}},{key:"writeValue",value:function(e){this._writeValue(e)}},{key:"_clearAnnotations",value:function(){this._annotations=[]}},{key:"_writeValues",value:function(e,t){var r=1<arguments.length&&void 0!==t?t:0,i=e.type();for(null===i&&(i=e.next());null!==i;)this._writeValue(e,r),i=e.next()}},{key:"_writeValue",value:function(e,t){var r=1<arguments.length&&void 0!==t?t:0,i=e.type();if(null!==i)if(0<r&&null!=e.fieldName()&&this.writeFieldName(e.fieldName()),this.setAnnotations(e.annotations()),e.isNull())this.writeNull(i);else{switch(i){case s.IonTypes.BOOL:this.writeBoolean(e.booleanValue());break;case s.IonTypes.INT:this.writeInt(e.bigIntValue());break;case s.IonTypes.FLOAT:this.writeFloat64(e.numberValue());break;case s.IonTypes.DECIMAL:this.writeDecimal(e.decimalValue());break;case s.IonTypes.TIMESTAMP:this.writeTimestamp(e.timestampValue());break;case s.IonTypes.SYMBOL:this.writeSymbol(e.stringValue());break;case s.IonTypes.STRING:this.writeString(e.stringValue());break;case s.IonTypes.CLOB:this.writeClob(e.byteValue());break;case s.IonTypes.BLOB:this.writeBlob(e.byteValue());break;case s.IonTypes.LIST:this.stepIn(s.IonTypes.LIST);break;case s.IonTypes.SEXP:this.stepIn(s.IonTypes.SEXP);break;case s.IonTypes.STRUCT:this.stepIn(s.IonTypes.STRUCT);break;default:throw new Error("Unrecognized type "+(null!==i?i.name:i))}i.isContainer&&(e.stepIn(),this._writeValues(e,r+1),this.stepOut(),e.stepOut())}}},{key:"_validateAnnotations",value:function(e){if(!Array.isArray(e))return!1;for(var t=0;t<e.length;t++)if(!this._isString(e[t]))return!1;return!0}},{key:"_isString",value:function(e){return"string"==typeof e}}]),e}();r.AbstractWriter=o},{"./IonTypes":26,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],2:[function(e,t,r){"use strict";var i,n;Object.defineProperty(r,"__esModule",{value:!0}),(n=i=r.IntSize||(r.IntSize={}))[n.Number=0]="Number",n[n.BigInt=1]="BigInt",r.default=i},{}],3:[function(e,t,r){"use strict";var i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var n=e("./IonBinaryReader"),a=e("./IonConstants"),s=e("./IonSpan"),o=e("./IonTextReader"),u=e("./IonTextWriter"),l=e("./IonPrettyTextWriter"),_=e("./IonWriteable"),h=e("./IonBinaryWriter"),c=e("./IonLocalSymbolTable"),f=e("./IonUnicode"),d=i(e("./IntSize"));r.IntSize=d.default,r.makeReader=function(e){if("string"==typeof e)return new o.TextReader(new s.StringSpan(e),null);var t=new Uint8Array(e);return function(e){if(e.length<4)return!1;for(var t=0;t<4;t++)if(e[t]!==a.IVM.binary[t])return!1;return!0}(t)?new n.BinaryReader(new s.BinarySpan(t),null):new o.TextReader(new s.StringSpan(f.decodeUtf8(t)),null)},r.makeTextWriter=function(){return new u.TextWriter(new _.Writeable)},r.makePrettyWriter=function(e){return new l.PrettyTextWriter(new _.Writeable,e)},r.makeBinaryWriter=function(){var e=c.defaultLocalSymbolTable();return new h.BinaryWriter(e,new _.Writeable)};var p=e("./IonCatalog");r.Catalog=p.Catalog;var y=e("./IonDecimal");r.Decimal=y.Decimal;var v=e("./IonLocalSymbolTable");r.defaultLocalSymbolTable=v.defaultLocalSymbolTable;var g=e("./IonType");r.IonType=g.IonType;var b=e("./IonTypes");r.IonTypes=b.IonTypes;var m=e("./IonSharedSymbolTable");r.SharedSymbolTable=m.SharedSymbolTable;var T=e("./IonTimestamp");r.TimestampPrecision=T.TimestampPrecision,r.Timestamp=T.Timestamp;var w=e("./IonText");r.toBase64=w.toBase64;var I=e("./IonUnicode");r.decodeUtf8=I.decodeUtf8},{"./IntSize":2,"./IonBinaryReader":5,"./IonBinaryWriter":6,"./IonCatalog":7,"./IonConstants":8,"./IonDecimal":9,"./IonLocalSymbolTable":11,"./IonPrettyTextWriter":15,"./IonSharedSymbolTable":16,"./IonSpan":17,"./IonText":21,"./IonTextReader":22,"./IonTextWriter":23,"./IonTimestamp":24,"./IonType":25,"./IonTypes":26,"./IonUnicode":27,"./IonWriteable":28}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.NIBBLE_MASK=15,r.BYTE_MASK=255,r.TYPE_SHIFT=4,r.BYTE_SHIFT=8,r.LEN_MASK=15,r.LEN_VAR=14,r.LEN_NULL=15,r.TB_NULL=0,r.TB_BOOL=1,r.TB_INT=2,r.TB_NEG_INT=3,r.TB_FLOAT=4,r.TB_DECIMAL=5,r.TB_TIMESTAMP=6,r.TB_SYMBOL=7,r.TB_STRING=8,r.TB_CLOB=9,r.TB_BLOB=10,r.TB_LIST=11,r.TB_SEXP=12,r.TB_STRUCT=13,r.TB_ANNOTATION=14},{}],5:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=e("./IonCatalog"),u=e("./IonLocalSymbolTable"),l=e("./IonSymbols"),_=e("./IonType"),h=e("./IonTypes"),c=e("./IonConstants"),f=e("./IonParserBinaryRaw"),d=s(e("./IntSize")),p=e("./JsbiSupport");new _.IonType(-1,"raw_input",!0,!1,!1,!1);function y(e){switch(e){case 0:return h.IonTypes.NULL;case 1:return h.IonTypes.BOOL;case 2:case 3:return h.IonTypes.INT;case 4:return h.IonTypes.FLOAT;case 5:return h.IonTypes.DECIMAL;case 6:return h.IonTypes.TIMESTAMP;case 7:return h.IonTypes.SYMBOL;case 8:return h.IonTypes.STRING;case 9:return h.IonTypes.CLOB;case 10:return h.IonTypes.BLOB;case 11:return h.IonTypes.LIST;case 12:return h.IonTypes.SEXP;case 13:return h.IonTypes.STRUCT;default:return null}}var v=function(){function r(e,t){(0,n.default)(this,r),this._annotations=null,this._parser=new f.ParserBinaryRaw(e),this._cat=t||new o.Catalog,this._symtab=u.defaultLocalSymbolTable(),this._raw_type=-2}return(0,a.default)(r,[{key:"next",value:function(){if(this._annotations=null,-1===this._raw_type)return null;for(this._raw_type=this._parser.next();0===this.depth();this._raw_type=this._parser.next())if(7===this._raw_type){if(this._parser._getSid()!==c.IVM.sid)break;this._symtab=u.defaultLocalSymbolTable()}else{if(13!==this._raw_type)break;if(!this._parser.hasAnnotations())break;if(this._parser.getAnnotation(0)!==l.ion_symbol_table_sid)break;this._symtab=l.makeSymbolTable(this._cat,this)}return y(this._raw_type)}},{key:"stepIn",value:function(){if(!y(this._raw_type).isContainer)throw new Error("Can't step in to a scalar value");this._parser.stepIn(),this._raw_type=-2}},{key:"stepOut",value:function(){this._parser.stepOut(),this._raw_type=-2}},{key:"type",value:function(){return y(this._raw_type)}},{key:"depth",value:function(){return this._parser.depth()}},{key:"fieldName",value:function(){return this.getSymbolString(this._parser.getFieldId())}},{key:"hasAnnotations",value:function(){return this._parser.hasAnnotations()}},{key:"annotations",value:function(){return this._loadAnnotations(),this._annotations}},{key:"getAnnotation",value:function(e){return this._loadAnnotations(),this._annotations[e]}},{key:"isNull",value:function(){return 0===this._raw_type||this._parser.isNull()}},{key:"byteValue",value:function(){return this._parser.byteValue()}},{key:"booleanValue",value:function(){return this._parser.booleanValue()}},{key:"decimalValue",value:function(){return this._parser.decimalValue()}},{key:"bigIntValue",value:function(){return this._parser.bigIntValue()}},{key:"intSize",value:function(){return p.JsbiSupport.isSafeInteger(this.bigIntValue())?d.default.Number:d.default.BigInt}},{key:"numberValue",value:function(){return this._parser.numberValue()}},{key:"stringValue",value:function(){var e=this._parser;switch(y(this._raw_type)){case h.IonTypes.NULL:return null;case h.IonTypes.STRING:return this.isNull()?null:e.stringValue();case h.IonTypes.SYMBOL:return this.isNull()?null:this.getSymbolString(e._getSid())}throw new Error("Current value is not a string or symbol.")}},{key:"timestampValue",value:function(){return this._parser.timestampValue()}},{key:"value",value:function(){var e=this.type();if(e&&e.isContainer){if(this.isNull())return null;throw new Error("Unable to provide a value for "+e.name+" containers.")}switch(e){case h.IonTypes.NULL:return null;case h.IonTypes.BLOB:case h.IonTypes.CLOB:return this.byteValue();case h.IonTypes.BOOL:return this.booleanValue();case h.IonTypes.DECIMAL:return this.decimalValue();case h.IonTypes.INT:return this.bigIntValue();case h.IonTypes.FLOAT:return this.numberValue();case h.IonTypes.STRING:case h.IonTypes.SYMBOL:return this.stringValue();case h.IonTypes.TIMESTAMP:return this.timestampValue();default:throw new Error("There is no current value.")}}},{key:"_loadAnnotations",value:function(){var t=this;null===this._annotations&&(this._annotations=[],this._parser.getAnnotations().forEach(function(e){t._annotations.push(t.getSymbolString(e))}))}},{key:"getSymbolString",value:function(e){var t=null;return 0<e&&void 0===(t=this._symtab.getSymbolText(e))&&(t="$"+e.toString()),t}}]),r}();r.BinaryReader=v},{"./IntSize":2,"./IonCatalog":7,"./IonConstants":8,"./IonLocalSymbolTable":11,"./IonParserBinaryRaw":13,"./IonSymbols":19,"./IonType":25,"./IonTypes":26,"./JsbiSupport":30,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],6:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),s=i(e("@babel/runtime/helpers/get")),l=i(e("@babel/runtime/helpers/classCallCheck")),o=i(e("@babel/runtime/helpers/createClass")),_=i(e("@babel/runtime/helpers/possibleConstructorReturn")),h=i(e("@babel/runtime/helpers/getPrototypeOf")),c=i(e("@babel/runtime/helpers/inherits")),n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var u,a,f,d,p=e("./AbstractWriter"),y=e("./IonDecimal"),v=e("./IonUnicode"),g=e("./IonTypes"),b=e("./IonLowLevelBinaryWriter"),m=e("./IonTimestamp"),T=e("./IonWriteable"),w=e("./util"),I=n(e("jsbi")),S=e("./JsbiSupport"),k=e("./JsbiSerde");(a=u=u||{})[a.VALUE=0]="VALUE",a[a.STRUCT_FIELD=1]="STRUCT_FIELD",a[a.STRUCT_VALUE=2]="STRUCT_VALUE",a[a.CLOSED=3]="CLOSED",(d=f=f||{})[d.NULL=0]="NULL",d[d.BOOL=1]="BOOL",d[d.POSITIVE_INT=2]="POSITIVE_INT",d[d.NEGATIVE_INT=3]="NEGATIVE_INT",d[d.FLOAT=4]="FLOAT",d[d.DECIMAL=5]="DECIMAL",d[d.TIMESTAMP=6]="TIMESTAMP",d[d.SYMBOL=7]="SYMBOL",d[d.STRING=8]="STRING",d[d.CLOB=9]="CLOB",d[d.BLOB=10]="BLOB",d[d.LIST=11]="LIST",d[d.SEXP=12]="SEXP",d[d.STRUCT=13]="STRUCT",d[d.ANNOTATION=14]="ANNOTATION";var E=function(e){function i(e,t){var r;return(0,l.default)(this,i),(r=(0,_.default)(this,(0,h.default)(i).call(this))).datagram=[],r.containers=[],r.state=u.VALUE,r.symbolTable=e,r.writer=new b.LowLevelBinaryWriter(t),r}return(0,c.default)(i,e),(0,o.default)(i,[{key:"getBytes",value:function(){return this.writer.getBytes()}},{key:"writeBlob",value:function(e){this.checkWriteValue(),null!=e?this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.BLOB,this.encodeAnnotations(this._annotations),e)):this.writeNull(g.IonTypes.BLOB)}},{key:"writeBoolean",value:function(e){this.checkWriteValue(),null!=e?this.addNode(new L(this.writer,this.getCurrentContainer(),this.encodeAnnotations(this._annotations),e)):this.writeNull(g.IonTypes.BOOL)}},{key:"writeClob",value:function(e){this.checkWriteValue(),null!=e?this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.CLOB,this.encodeAnnotations(this._annotations),e)):this.writeNull(g.IonTypes.CLOB)}},{key:"writeDecimal",value:function(e){if(this.checkWriteValue(),null!=e){"string"==typeof e&&(e=y.Decimal.parse(e));var t=e.getExponent(),r=e.getCoefficient();if(I.default.equal(r,S.JsbiSupport.ZERO)&&!e.isNegative()&&0===t&&1===w._sign(t))this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.DECIMAL,this.encodeAnnotations(this._annotations),new Uint8Array(0)));else{var i=e.isNegative(),n=i||I.default.notEqual(r,S.JsbiSupport.ZERO),a=n?k.JsbiSerde.toSignedIntBytes(r,i):null,s=b.LowLevelBinaryWriter.getVariableLengthSignedIntSize(t)+(n?a.length:0),o=new b.LowLevelBinaryWriter(new T.Writeable(s));o.writeVariableLengthSignedInt(t),n&&o.writeBytes(a),this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.DECIMAL,this.encodeAnnotations(this._annotations),o.getBytes()))}}else this.writeNull(g.IonTypes.DECIMAL)}},{key:"writeFloat32",value:function(e){if(this.checkWriteValue(),null!=e){var t;if(Object.is(e,0))t=new Uint8Array(0);else{var r=new ArrayBuffer(4);new DataView(r).setFloat32(0,e,!1),t=new Uint8Array(r)}this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.FLOAT,this.encodeAnnotations(this._annotations),t))}else this.writeNull(g.IonTypes.FLOAT)}},{key:"writeFloat64",value:function(e){if(this.checkWriteValue(),null!=e){var t;if(Object.is(e,0))t=new Uint8Array(0);else{var r=new ArrayBuffer(8);new DataView(r).setFloat64(0,e,!1),t=new Uint8Array(r)}this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.FLOAT,this.encodeAnnotations(this._annotations),t))}else this.writeNull(g.IonTypes.FLOAT)}},{key:"writeInt",value:function(e){this.checkWriteValue(),null!=e?this.addNode(new D(this.writer,this.getCurrentContainer(),this.encodeAnnotations(this._annotations),e)):this.writeNull(g.IonTypes.INT)}},{key:"writeNull",value:function(e){var t=0<arguments.length&&void 0!==e?e:g.IonTypes.NULL;this.checkWriteValue(),this.addNode(new M(this.writer,this.getCurrentContainer(),t,this.encodeAnnotations(this._annotations)))}},{key:"writeString",value:function(e){this.checkWriteValue(),null!=e?this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.STRING,this.encodeAnnotations(this._annotations),v.encodeUtf8(e))):this.writeNull(g.IonTypes.STRING)}},{key:"writeSymbol",value:function(e){if(this.checkWriteValue(),null==e)this.writeNull(g.IonTypes.SYMBOL);else{var t=this.symbolTable.addSymbol(e),r=new b.LowLevelBinaryWriter(new T.Writeable(b.LowLevelBinaryWriter.getUnsignedIntSize(t)));r.writeUnsignedInt(t),this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.SYMBOL,this.encodeAnnotations(this._annotations),r.getBytes()))}}},{key:"writeTimestamp",value:function(e){if(this.checkWriteValue(),null!=e){var t=new b.LowLevelBinaryWriter(new T.Writeable(12));t.writeVariableLengthSignedInt(e.getLocalOffset());var r=e.getDate();if(t.writeVariableLengthUnsignedInt(r.getUTCFullYear()),e.getPrecision()>=m.TimestampPrecision.MONTH&&t.writeVariableLengthUnsignedInt(r.getUTCMonth()+1),e.getPrecision()>=m.TimestampPrecision.DAY&&t.writeVariableLengthUnsignedInt(r.getUTCDate()),e.getPrecision()>=m.TimestampPrecision.HOUR_AND_MINUTE&&(t.writeVariableLengthUnsignedInt(r.getUTCHours()),t.writeVariableLengthUnsignedInt(r.getUTCMinutes())),e.getPrecision()>=m.TimestampPrecision.SECONDS){t.writeVariableLengthUnsignedInt(e.getSecondsInt());var i=e._getFractionalSeconds();0!==i.getExponent()&&(t.writeVariableLengthSignedInt(i.getExponent()),S.JsbiSupport.isZero(i.getCoefficient())||t.writeBytes(k.JsbiSerde.toSignedIntBytes(i.getCoefficient(),i.isNegative())))}this.addNode(new U(this.writer,this.getCurrentContainer(),g.IonTypes.TIMESTAMP,this.encodeAnnotations(this._annotations),t.getBytes()))}else this.writeNull(g.IonTypes.TIMESTAMP)}},{key:"stepIn",value:function(e){switch(this.checkWriteValue(),e){case g.IonTypes.LIST:case g.IonTypes.SEXP:this.addNode(new N(this.writer,this.getCurrentContainer(),e,this.encodeAnnotations(this._annotations)));break;case g.IonTypes.STRUCT:this.addNode(new O(this.writer,this.getCurrentContainer(),this.encodeAnnotations(this._annotations))),this.state=u.STRUCT_FIELD;break;default:throw new Error("Unrecognized container type")}}},{key:"stepOut",value:function(){if(0===this.depth())throw new Error("Not currently in a container");if(this.state===u.STRUCT_VALUE)throw new Error("Cannot exit a struct with a partially written field");this.containers.pop(),0<this.depth()?this.state=this.getCurrentContainer()instanceof O?u.STRUCT_FIELD:u.VALUE:this.state=u.VALUE}},{key:"writeFieldName",value:function(e){if(this.state!==u.STRUCT_FIELD)throw new Error("Cannot write a field name outside of a struct");this.fieldName=this.encodeAnnotations([e]),this.state=u.STRUCT_VALUE}},{key:"depth",value:function(){return this.containers.length}},{key:"close",value:function(){if(this.checkClosed(),0<this.depth())throw new Error("Writer has one or more open containers; call stepOut() for each container prior to close()");this.writeIvm();var e=this.datagram;this.datagram=[],this.writeSymbolTable();var t=!0,r=!1,i=void 0;try{for(var n,a=e[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){n.value.write()}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}this.state=u.CLOSED}},{key:"writeIvm",value:function(){this.writer.writeByte(224),this.writer.writeByte(1),this.writer.writeByte(0),this.writer.writeByte(234)}},{key:"encodeAnnotations",value:function(e){if(0===e.length)return new Uint8Array(0);var t=new T.Writeable,r=new b.LowLevelBinaryWriter(t),i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var u=s.value,l=this.symbolTable.addSymbol(u);r.writeVariableLengthUnsignedInt(l)}}catch(e){n=!0,a=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw a}}return this._clearAnnotations(),t.getBytes()}},{key:"getCurrentContainer",value:function(){return this.containers[this.containers.length-1]}},{key:"addNode",value:function(e){0===this.depth()?this.datagram.push(e):this.state===u.STRUCT_VALUE?(this.getCurrentContainer().addChild(e,this.fieldName),this.state=u.STRUCT_FIELD):this.getCurrentContainer().addChild(e),e.isContainer()&&(this.containers.push(e),this.state=u.VALUE)}},{key:"checkWriteValue",value:function(){if(this.checkClosed(),this.state===u.STRUCT_FIELD)throw new Error("Expected a struct field name instead of a value, call writeFieldName(string) with the desired name before calling stepIn(IonType) or writeIonType()")}},{key:"checkClosed",value:function(){if(this.state===u.CLOSED)throw new Error("Writer is closed, no further operations are available")}},{key:"writeSymbolTable",value:function(){var e="$ion"!=this.symbolTable.import.symbolTable.name,t=0<this.symbolTable.symbols.length;if(e||t){if(this.setAnnotations(["$ion_symbol_table"]),this.stepIn(g.IonTypes.STRUCT),e&&(this.writeFieldName("imports"),this.stepIn(g.IonTypes.LIST),this.writeImport(this.symbolTable.import),this.stepOut()),t){this.writeFieldName("symbols"),this.stepIn(g.IonTypes.LIST);var r=!0,i=!1,n=void 0;try{for(var a,s=this.symbolTable.symbols[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;void 0!==o&&this.writeString(o)}}catch(e){i=!0,n=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw n}}this.stepOut()}this.stepOut(),this.datagram[0].write()}}},{key:"writeImport",value:function(e){e&&(this.writeImport(e.parent),this.stepIn(g.IonTypes.STRUCT),this.writeFieldName("name"),this.writeString(e.symbolTable.name),this.writeFieldName("version"),this.writeInt(e.symbolTable.version),this.writeFieldName("max_id"),this.writeInt(e.length),this.stepOut())}}]),i}(p.AbstractWriter);r.BinaryWriter=E;var C=function(){function n(e,t,r,i){(0,l.default)(this,n),this._writer=e,this.parent=t,this._type=r,this.annotations=i}return(0,o.default)(n,[{key:"writeTypeDescriptorAndLength",value:function(e,t,r){var i=e<<4;t?(i|=15,this.writer.writeByte(i)):r<14?(i|=r,this.writer.writeByte(i)):(i|=14,this.writer.writeByte(i),this.writer.writeVariableLengthUnsignedInt(r))}},{key:"getContainedValueLength",value:function(){var e=this.getValueLength();return 1+n.getLengthLength(e)+e}},{key:"getAnnotatedContainerLength",value:function(){var e=this.annotations.length;return e+b.LowLevelBinaryWriter.getVariableLengthUnsignedIntSize(e)+this.getContainedValueLength()}},{key:"getAnnotationsLength",value:function(){if(this.hasAnnotations()){var e=this.annotations.length,t=b.LowLevelBinaryWriter.getVariableLengthUnsignedIntSize(e),r=this.getContainedValueLength();return 1+n.getLengthLength(r)+t+e}return 0}},{key:"getLength",value:function(){return this.getAnnotationsLength()+this.getContainedValueLength()}},{key:"writeAnnotations",value:function(){if(this.hasAnnotations()){var e=this.getAnnotatedContainerLength();this.writeTypeDescriptorAndLength(f.ANNOTATION,!1,e),this.writer.writeVariableLengthUnsignedInt(this.annotations.length),this.writer.writeBytes(new Uint8Array(this.annotations))}}},{key:"hasAnnotations",value:function(){return 0<this.annotations.length}},{key:"typeCode",get:function(){return this._type.binaryTypeId}},{key:"writer",get:function(){return this._writer}}],[{key:"getLengthLength",value:function(e){return e<14?0:b.LowLevelBinaryWriter.getVariableLengthUnsignedIntSize(e)}}]),n}(),A=function(e){function n(e,t,r,i){return(0,l.default)(this,n),(0,_.default)(this,(0,h.default)(n).call(this,e,t,r,i))}return(0,c.default)(n,e),(0,o.default)(n,[{key:"isContainer",value:function(){return!0}}]),n}(r.AbstractNode=C),N=function(e){function a(e,t,r,i){var n;return(0,l.default)(this,a),(n=(0,_.default)(this,(0,h.default)(a).call(this,e,t,r,i))).children=[],n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"addChild",value:function(e){this.children.push(e)}},{key:"write",value:function(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.getValueLength());var e=!0,t=!1,r=void 0;try{for(var i,n=this.children[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){i.value.write()}}catch(e){t=!0,r=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw r}}}},{key:"getValueLength",value:function(){var e=0,t=!0,r=!1,i=void 0;try{for(var n,a=this.children[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){e+=n.value.getLength()}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"getLength",value:function(){return void 0===this.length&&(this.length=(0,s.default)((0,h.default)(a.prototype),"getLength",this).call(this)),this.length}}]),a}(A),O=function(e){function n(e,t,r){var i;return(0,l.default)(this,n),(i=(0,_.default)(this,(0,h.default)(n).call(this,e,t,g.IonTypes.STRUCT,r))).fields=[],i}return(0,c.default)(n,e),(0,o.default)(n,[{key:"addChild",value:function(e,t){if(null==t)throw new Error("Cannot add a value to a struct without a field name");this.fields.push({name:t,value:e})}},{key:"getValueLength",value:function(){var e=0,t=!0,r=!1,i=void 0;try{for(var n,a=this.fields[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;e+=s.name.length,e+=s.value.getLength()}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"getLength",value:function(){return void 0===this.length&&(this.length=(0,s.default)((0,h.default)(n.prototype),"getLength",this).call(this)),this.length}},{key:"write",value:function(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.getValueLength());var e=!0,t=!1,r=void 0;try{for(var i,n=this.fields[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){var a=i.value;this.writer.writeBytes(new Uint8Array(a.name)),a.value.write()}}catch(e){t=!0,r=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw r}}}}]),n}(A),B=function(e){function t(){return(0,l.default)(this,t),(0,_.default)(this,(0,h.default)(t).apply(this,arguments))}return(0,c.default)(t,e),(0,o.default)(t,[{key:"addChild",value:function(){throw new Error("Cannot add a child to a leaf node")}},{key:"isContainer",value:function(){return!1}}]),t}(C),L=function(e){function a(e,t,r,i){var n;return(0,l.default)(this,a),(n=(0,_.default)(this,(0,h.default)(a).call(this,e,t,g.IonTypes.BOOL,r))).value=i,n}return(0,c.default)(a,e),(0,o.default)(a,[{key:"write",value:function(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.value?1:0)}},{key:"getValueLength",value:function(){return 0}}]),a}(r.LeafNode=B),D=function(e){function u(e,t,r,i){var n;if((0,l.default)(this,u),(n=(0,_.default)(this,(0,h.default)(u).call(this,e,t,g.IonTypes.INT,r))).value=i,!("number"==typeof n.value||n.value instanceof I.default))throw new Error("Expected "+n.value+" to be a number or JSBI");if(I.default.GT(n.value,0)){n.intTypeCode=f.POSITIVE_INT;var a=new b.LowLevelBinaryWriter(new T.Writeable(b.LowLevelBinaryWriter.getUnsignedIntSize(n.value)));a.writeUnsignedInt(n.value),n.bytes=a.getBytes()}else if(I.default.LT(n.value,0)){var s;n.intTypeCode=f.NEGATIVE_INT,i instanceof I.default?S.JsbiSupport.isNegative(i)&&(s=I.default.unaryMinus(i)):s=Math.abs(i);var o=new b.LowLevelBinaryWriter(new T.Writeable(b.LowLevelBinaryWriter.getUnsignedIntSize(s)));o.writeUnsignedInt(s),n.bytes=o.getBytes()}else n.intTypeCode=f.POSITIVE_INT,n.bytes=new Uint8Array(0);return n}return(0,c.default)(u,e),(0,o.default)(u,[{key:"write",value:function(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.intTypeCode,!1,this.bytes.length),this.writer.writeBytes(this.bytes)}},{key:"getValueLength",value:function(){return this.bytes.length}}]),u}(B),U=function(e){function s(e,t,r,i,n){var a;return(0,l.default)(this,s),(a=(0,_.default)(this,(0,h.default)(s).call(this,e,t,r,i))).value=n,a}return(0,c.default)(s,e),(0,o.default)(s,[{key:"write",value:function(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!1,this.value.length),this.writer.writeBytes(this.value)}},{key:"getValueLength",value:function(){return this.value.length}}]),s}(B),M=function(e){function n(e,t,r,i){return(0,l.default)(this,n),(0,_.default)(this,(0,h.default)(n).call(this,e,t,r,i))}return(0,c.default)(n,e),(0,o.default)(n,[{key:"write",value:function(){this.writeAnnotations(),this.writeTypeDescriptorAndLength(this.typeCode,!0,0)}},{key:"getValueLength",value:function(){return 0}}]),n}(B);r.NullNode=M},{"./AbstractWriter":1,"./IonDecimal":9,"./IonLowLevelBinaryWriter":12,"./IonTimestamp":24,"./IonTypes":26,"./IonUnicode":27,"./IonWriteable":28,"./JsbiSerde":29,"./JsbiSupport":30,"./util":32,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/get":39,"@babel/runtime/helpers/getPrototypeOf":40,"@babel/runtime/helpers/inherits":41,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/possibleConstructorReturn":45,jsbi:50}],7:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var s=e("./IonSystemSymbolTable");var o=function(){function e(){(0,n.default)(this,e),this.symbolTables={},this.add(s.getSystemSymbolTable())}return(0,a.default)(e,[{key:"add",value:function(e){if(void 0===e.name||null===e.name)throw new Error("SymbolTable name must be defined.");void 0===this.symbolTables[e.name]&&(this.symbolTables[e.name]=[]),this.symbolTables[e.name][e.version]=e}},{key:"getVersion",value:function(e,t){var r=this.symbolTables[e];if(!r)return null;var i=r[t];return(i=i||r[r.length])||null}},{key:"getTable",value:function(e){var t=this.symbolTables[e];return void 0===t?null:t[t.length-1]}}]),e}();r.Catalog=o},{"./IonSystemSymbolTable":20,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EOF=-1,r.IVM={text:"$ion_1_0",binary:new Uint8Array([224,1,0,234]),sid:2}},{}],9:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),d=i(e("@babel/runtime/helpers/slicedToArray")),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var p=s(e("jsbi")),o=e("./util"),y=e("./JsbiSupport"),u=function(){function u(e,t,r){if((0,n.default)(this,u),"string"==typeof e)return u.parse(e);if(!o._hasValue(t))throw new Error("Decimal's constructor was called with a numeric coefficient but no exponent.");if("number"==typeof e)return u._fromNumberCoefficient(e,t);if(e instanceof p.default)return o._hasValue(r)?r!=y.JsbiSupport.isNegative(e)&&(e=p.default.unaryMinus(e)):r=y.JsbiSupport.isNegative(e),u._fromBigIntCoefficient(r,e,t);throw new Error("Unsupported parameter set (".concat(e,", ").concat(t,", ").concat(r," passed to Decimal constructor."))}return(0,a.default)(u,[{key:"isNegative",value:function(){return this._isNegative}},{key:"numberValue",value:function(){return this._isNegativeZero()?-0:p.default.toNumber(this._coefficient)*Math.pow(10,this._exponent)}},{key:"intValue",value:function(){return Math.trunc(this.numberValue())}},{key:"toString",value:function(){var e=this._coefficient.toString();"-"===e[0]&&(e=e.substr(1,e.length));var t=e.length,r=this._exponent+(t-1),i="";return this._exponent<=0&&-6<=r?0===this._exponent?i+=e:e.length<=-this._exponent?i+=(e="0".repeat(-this._exponent-e.length+1)+e).substr(0,1)+"."+e.substr(1):i+=e.substr(0,t+this._exponent)+"."+e.substr(t+this._exponent):(i+=e[0],1<e.length&&(i+="."+e.substr(1)),i+="E"+(0<r?"+":"")+r),(this.isNegative()?"-":"")+i}},{key:"getCoefficient",value:function(){return this._coefficient}},{key:"getExponent",value:function(){return this._exponent}},{key:"equals",value:function(e){return this.getExponent()===e.getExponent()&&o._sign(this.getExponent())===o._sign(e.getExponent())&&this.isNegative()===e.isNegative()&&p.default.equal(this.getCoefficient(),e.getCoefficient())}},{key:"compareTo",value:function(e){if(y.JsbiSupport.isZero(this._coefficient)&&y.JsbiSupport.isZero(e._coefficient))return 0;var t=this.isNegative();if(t!==e.isNegative())return t?-1:1;var r=this._compareToParams(),i=(0,d.default)(r,3),n=i[0],a=i[1],s=i[2],o=e._compareToParams(),u=(0,d.default)(o,3),l=u[0],_=u[1],h=u[2];if(h<s)return t?-1:1;if(s<h)return t?1:-1;n.length<l.length?n+="0".repeat(_-a):n.length>l.length&&(l+="0".repeat(a-_));var c=p.default.BigInt(n),f=p.default.BigInt(l);return p.default.greaterThan(c,f)?t?-1:1:p.default.lessThan(c,f)?t?1:-1:0}},{key:"_initialize",value:function(e,t,r){this._isNegative=e,this._coefficient=t,Object.is(-0,r)&&(r=0),this._exponent=r}},{key:"_isNegativeZero",value:function(){return this.isNegative()&&y.JsbiSupport.isZero(this._coefficient)}},{key:"_compareToParams",value:function(){var e=this.isNegative()?this._coefficient.toString().substring(1):this._coefficient.toString(),t=e.length,r=t+this._exponent;return r<=0&&(r-=1),y.JsbiSupport.isZero(this._coefficient)&&(r=-1/0),[e,t,r]}}],[{key:"_fromNumberCoefficient",value:function(e,t){if(!Number.isInteger(e))throw new Error("The provided coefficient was not an integer. ("+e+")");var r=e<0||Object.is(e,-0);return this._fromBigIntCoefficient(r,p.default.BigInt(e),t)}},{key:"_fromBigIntCoefficient",value:function(e,t,r){var i=Object.create(this.prototype);return i._initialize(e,t,r),i}},{key:"parse",value:function(e){var t=0;if("null"===e||"null.decimal"===e)return null;var r=e.match("[d|D]"),i=e.length;r&&(t=Number(e.substring(r.index+1,e.length)),i=r.index);var n,a=e.match("\\.");a?(t-=r?r.index-1-a.index:e.length-1-a.index,n=e.substring(0,a.index)+e.substring(a.index+1,i)):n=e.substring(0,i);var s=p.default.BigInt(n),o=y.JsbiSupport.isNegative(s)||n.startsWith("-0");return u._fromBigIntCoefficient(o,s,t)}}]),u}();(r.Decimal=u).ZERO=new u(0,0),u.ONE=new u(1,0)},{"./JsbiSupport":30,"./util":32,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/slicedToArray":47,jsbi:50}],10:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function i(e,t,r){(0,n.default)(this,i),this._parent=e,this._symbolTable=t,this._offset=this.parent?this.parent.offset+this.parent.length:1,this._length=r||this.symbolTable.numberOfSymbols}return(0,a.default)(i,[{key:"getSymbolText",value:function(e){if(void 0===this.parent)throw new Error("Illegal parent state.");if(null!==this.parent){var t=this.parent.getSymbolText(e);if(t)return t}var r=e-this.offset;if(0<=r&&r<this.length)return this.symbolTable.getSymbolText(r)}},{key:"getSymbolId",value:function(e){var t;return null!==this.parent&&(t=this.parent.getSymbolId(e))?t:null!=(t=this.symbolTable.getSymbolId(e))&&t<this.length?t+this.offset:void 0}},{key:"parent",get:function(){return this._parent}},{key:"offset",get:function(){return this._offset}},{key:"length",get:function(){return this._length}},{key:"symbolTable",get:function(){return this._symbolTable}}]),i}();r.Import=s},{"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],11:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),l=i(e("@babel/runtime/helpers/classCallCheck")),n=i(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var _=e("./IonSystemSymbolTable"),a=function(){function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:_.getSystemSymbolTableImport(),t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];(0,l.default)(this,u),this._import=e,this.index={},this._symbols=[],this.offset=e.offset+e.length;var r=!0,i=!1,n=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;this.addSymbol(o)}}catch(e){i=!0,n=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw n}}}return(0,n.default)(u,[{key:"getSymbolId",value:function(e){return this._import.getSymbolId(e)||this.index[e]}},{key:"addSymbol",value:function(e){var t=this.getSymbolId(e);if(void 0!==t)return t;var r=this.offset+this.symbols.length;return this.symbols.push(e),this.index[e]=r}},{key:"getSymbolText",value:function(e){if(e>this.maxId)throw new Error("SymbolID greater than maxID.");var t=this.import.getSymbolText(e);if(void 0!==t)return t;var r=e-this.offset;return this.symbols[r]}},{key:"numberOfSymbols",value:function(){return this._symbols.length}},{key:"symbols",get:function(){return this._symbols}},{key:"maxId",get:function(){return this.offset+this._symbols.length-1}},{key:"import",get:function(){return this._import}}]),u}();r.LocalSymbolTable=a,r.defaultLocalSymbolTable=function(){return new a(_.getSystemSymbolTableImport())}},{"./IonSystemSymbolTable":20,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],12:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=s(e("jsbi")),u=e("./JsbiSerde"),l=function(){function s(e){(0,n.default)(this,s),this.writeable=e}return(0,a.default)(s,[{key:"writeSignedInt",value:function(e){for(var t=s.getSignedIntSize(e),r=Math.abs(e),i=new Uint8Array(t),n=i.length;128<=r;)i[--n]=255&r,r>>>=8;i[--n]=255&r,1/e<0&&(i[0]|=128),this.writeable.writeBytes(i)}},{key:"writeUnsignedInt",value:function(e){if(e instanceof o.default){var t=u.JsbiSerde.toUnsignedIntBytes(e);this.writeable.writeBytes(t)}else{for(var r=s.getUnsignedIntSize(e),i=new Uint8Array(r),n=e,a=i.length;0<n;)i[--a]=n%256,n=Math.trunc(n/256);this.writeable.writeBytes(i)}}},{key:"writeVariableLengthSignedInt",value:function(e){for(var t=new Uint8Array(s.getVariableLengthSignedIntSize(e)),r=Math.abs(e),i=t.length-1;64<=r;)t[i--]=127&r,r>>>=7;t[i]=r,1/e<0&&(t[i]|=64),t[t.length-1]|=128,this.writeable.writeBytes(t)}},{key:"writeVariableLengthUnsignedInt",value:function(e){var t=new Uint8Array(s.getVariableLengthUnsignedIntSize(e)),r=e,i=t.length;for(t[--i]=127&r|128,r>>>=7;0<r;)t[--i]=127&r,r>>>=7;this.writeable.writeBytes(t)}},{key:"writeByte",value:function(e){this.writeable.writeByte(e)}},{key:"writeBytes",value:function(e){this.writeable.writeBytes(e)}},{key:"getBytes",value:function(){return this.writeable.getBytes()}}],[{key:"getSignedIntSize",value:function(e){if(0===e)return 1;var t=Math.abs(e),r=Math.ceil(Math.log2(t+1))+1;return Math.ceil(r/8)}},{key:"getUnsignedIntSize",value:function(e){if(e instanceof o.default)return u.JsbiSerde.getUnsignedIntSizeInBytes(e);if(0===e)return 1;var t=Math.floor(Math.log2(e))+1;return Math.ceil(t/8)}},{key:"getVariableLengthSignedIntSize",value:function(e){var t=Math.abs(e);if(0===t)return 1;var r=Math.floor(Math.log2(t))+1,i=Math.floor(r/7);return Math.ceil((r+i+1+1)/8)}},{key:"getVariableLengthUnsignedIntSize",value:function(e){if(0===e)return 1;var t=Math.floor(Math.log2(e))+1,r=Math.ceil(t/7);return Math.ceil((t+r)/8)}}]),s}();r.LowLevelBinaryWriter=l},{"./JsbiSerde":29,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42,jsbi:50}],13:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),T=i(e("@babel/runtime/helpers/slicedToArray")),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(r,"__esModule",{value:!0});var u=s(e("jsbi")),w=e("./JsbiSupport"),l=o(e("./IonBinary")),_=e("./IonUnicode"),I=e("./IonDecimal"),h=e("./IonTypes"),c=e("./IonConstants"),S=e("./IonTimestamp"),f=s(e("./SignAndMagnitudeInt")),d=e("./JsbiSerde");function p(e){return e>>l.TYPE_SHIFT&l.NIBBLE_MASK}var y=[],v=c.IVM.sid,g=(c.IVM.binary[0],c.IVM.binary[1]),b=c.IVM.binary[2],k=c.IVM.binary[3],m=function(){function m(e){(0,n.default)(this,m),this._raw_type=-1,this._len=-1,this._curr=void 0,this._null=!1,this._fid=-1,this._as=-1,this._ae=-1,this._a=[],this._ts=[20],this._in_struct=!1,this._in=e}return(0,a.default)(m,[{key:"next",value:function(){return void 0===this._curr&&0<this._len?this._in.skip(this._len):this.clear_value(),this._in_struct&&(this._fid=this.readVarUnsignedInt()),this.load_next()}},{key:"stepIn",value:function(){var e,t,r=this;switch(r._raw_type){case l.TB_STRUCT:case l.TB_LIST:case l.TB_SEXP:break;default:throw new Error("you can only 'stepIn' to a container")}e=r._in.getRemaining()-r._len,t=function(e,t){return t<<5|31&e}(r._raw_type,e),r._ts.push(t),r._in_struct=r._raw_type===l.TB_STRUCT,r._in.setRemaining(r._len),r.clear_value()}},{key:"stepOut",value:function(){var e,t,r,i=this;if(i._ts.length<2)throw new Error("you can't stepOut unless you stepped in");t=function(e){return e>>>5}(i._ts.pop()),e=function(e){return 31&e}(i._ts[i._ts.length-1]),i._in_struct=e===l.TB_STRUCT,i.clear_value(),r=i._in.getRemaining(),i._in.skip(r),i._in.setRemaining(t)}},{key:"isNull",value:function(){return this._null}},{key:"depth",value:function(){return this._ts.length-1}},{key:"getFieldId",value:function(){return this._fid}},{key:"hasAnnotations",value:function(){return 0<=this._as}},{key:"getAnnotations",value:function(){return void 0!==this._a&&0!==this._a.length||this.load_annotation_values(),this._a}},{key:"getAnnotation",value:function(e){return void 0!==this._a&&0!==this._a.length||this.load_annotation_values(),this._a[e]}},{key:"ionType",value:function(){return function(e){switch(e){case l.TB_NULL:return h.IonTypes.NULL;case l.TB_BOOL:return h.IonTypes.BOOL;case l.TB_INT:case l.TB_NEG_INT:return h.IonTypes.INT;case l.TB_FLOAT:return h.IonTypes.FLOAT;case l.TB_DECIMAL:return h.IonTypes.DECIMAL;case l.TB_TIMESTAMP:return h.IonTypes.TIMESTAMP;case l.TB_SYMBOL:return h.IonTypes.SYMBOL;case l.TB_STRING:return h.IonTypes.STRING;case l.TB_CLOB:return h.IonTypes.CLOB;case l.TB_BLOB:return h.IonTypes.BLOB;case l.TB_SEXP:return h.IonTypes.SEXP;case l.TB_LIST:return h.IonTypes.LIST;case l.TB_STRUCT:return h.IonTypes.STRUCT;default:return}}(this._raw_type)}},{key:"_getSid",value:function(){return this.load_value(),this._raw_type==l.TB_SYMBOL?void 0===this._curr?null:this._curr:null}},{key:"_stringRepresentation",value:function(){var e=this;switch(e._raw_type){case l.TB_NULL:case l.TB_BOOL:case l.TB_INT:case l.TB_NEG_INT:case l.TB_FLOAT:case l.TB_DECIMAL:case l.TB_TIMESTAMP:case l.TB_SYMBOL:case l.TB_STRING:break;default:throw new Error("Cannot convert to string.")}if(e.isNull())switch(e._raw_type){case l.TB_BOOL:case l.TB_INT:case l.TB_NEG_INT:case l.TB_FLOAT:case l.TB_DECIMAL:case l.TB_TIMESTAMP:case l.TB_SYMBOL:case l.TB_STRING:e.ionType().name}else switch(e.load_value(),e._raw_type){case l.TB_BOOL:case l.TB_INT:case l.TB_NEG_INT:case l.TB_DECIMAL:case l.TB_TIMESTAMP:return e._curr.toString();case l.TB_FLOAT:var t=e.numberValue().toString();if(-1===t.indexOf("e"))return t+"e0";case l.TB_STRING:return e._null?null:e._curr}}},{key:"byteValue",value:function(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_CLOB:case l.TB_BLOB:return this.isNull()?null:(this.load_value(),this._curr);default:throw new Error("Current value is not a blob or clob.")}}},{key:"booleanValue",value:function(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_BOOL:return this.isNull()?null:this._curr}throw new Error("Current value is not a Boolean.")}},{key:"decimalValue",value:function(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_DECIMAL:return this.isNull()?null:(this.load_value(),this._curr)}throw new Error("Current value is not a decimal.")}},{key:"bigIntValue",value:function(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_INT:case l.TB_NEG_INT:return this.isNull()?null:(this.load_value(),this._curr);default:throw new Error("bigIntValue() was called when the current value was not an int.")}}},{key:"numberValue",value:function(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_INT:case l.TB_NEG_INT:if(this.isNull())return null;this.load_value();var e=this._curr;return w.JsbiSupport.clampToSafeIntegerRange(e);case l.TB_FLOAT:return this.isNull()?null:(this.load_value(),this._curr);default:throw new Error("Current value is not a float or int.")}}},{key:"stringValue",value:function(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_STRING:case l.TB_SYMBOL:return this.isNull()?null:(this.load_value(),this._curr)}throw new Error("Current value is not a string or symbol.")}},{key:"timestampValue",value:function(){switch(this._raw_type){case l.TB_NULL:return null;case l.TB_TIMESTAMP:return this.isNull()?null:(this.load_value(),this._curr)}throw new Error("Current value is not a timestamp.")}},{key:"read_binary_float",value:function(){return m._readFloatFrom(this._in,this._len)}},{key:"readVarUnsignedInt",value:function(){return m._readVarUnsignedIntFrom(this._in)}},{key:"readVarSignedInt",value:function(){return m._readVarSignedIntFrom(this._in)}},{key:"readUnsignedIntAsBigInt",value:function(){return m._readUnsignedIntAsBigIntFrom(this._in,this._len)}},{key:"readUnsignedIntAsNumber",value:function(){return m._readUnsignedIntAsNumberFrom(this._in,this._len)}},{key:"read_decimal_value",value:function(){return m.readDecimalValueFrom(this._in,this._len)}},{key:"read_timestamp_value",value:function(){if(!(0<this._len))return null;var e,t,r,i,n,a,s,o=I.Decimal.ZERO,u=S.TimestampPrecision.YEAR,l=this._in.position()+this._len;if(e=this.readVarSignedInt(),!(this._in.position()<l))throw new Error("Timestamps must include a year.");if(t=this.readVarUnsignedInt(),this._in.position()<l&&(r=this.readVarUnsignedInt(),u=S.TimestampPrecision.MONTH),this._in.position()<l&&(i=this.readVarUnsignedInt(),u=S.TimestampPrecision.DAY),this._in.position()<l){if(n=this.readVarUnsignedInt(),this._in.position()>=l)throw new Error("Timestamps with an hour must include a minute.");a=this.readVarUnsignedInt(),u=S.TimestampPrecision.HOUR_AND_MINUTE}if(this._in.position()<l&&(s=this.readVarUnsignedInt(),u=S.TimestampPrecision.SECONDS),this._in.position()<l){var _=this.readVarSignedInt(),h=w.JsbiSupport.ZERO,c=!1;if(this._in.position()<l){var f=m._readSignedIntFrom(this._in,l-this._in.position());c=f._isNegative,h=f._magnitude}var d=I.Decimal._fromBigIntCoefficient(c,h,_),p=S.Timestamp._splitSecondsDecimal(d),y=(0,T.default)(p,2),v=(y[0],y[1]);o=I.Decimal.parse(s+"."+v)}var g=Date.UTC(t,r?r-1:0,i||1,n||0,a||0,s||0,0);g=S.Timestamp._adjustMsSinceEpochIfNeeded(t,g);var b=new Date(g);return S.Timestamp._valueOf(b,e,o,u)}},{key:"read_string_value",value:function(){return _.decodeUtf8(this._in.chunk(this._len))}},{key:"clear_value",value:function(){this._raw_type=-1,this._curr=void 0,this._a=y,this._as=-1,this._null=!1,this._fid=-1,this._len=-1}},{key:"load_length",value:function(e){var t=this;switch(t._len=function(e){return e&l.NIBBLE_MASK}(e),t._len){case 1:p(e)===l.TB_STRUCT&&(t._len=this.readVarUnsignedInt()),t._null=!1;break;case l.LEN_VAR:t._null=!1,t._len=this.readVarUnsignedInt();break;case l.LEN_NULL:t._null=!0,t._len=0;break;default:t._null=!1}}},{key:"load_next",value:function(){var e,t,r=this;if(r._as=-1,!r._in.is_empty()){switch(e=p(t=r._in.next()),r.load_length(t),e===l.TB_ANNOTATION&&(e=r._len<1&&0===r.depth()?r.load_ivm():r.load_annotations()),e){case l.TB_NULL:r._null=!0;break;case l.TB_BOOL:0!==r._len&&1!==r._len||(r._curr=1===r._len,r._len=0)}return r._raw_type=e}r.clear_value()}},{key:"load_annotations",value:function(){var e,t,r=this;return r._len<1&&0===r.depth()?r.load_ivm():(t=this.readVarUnsignedInt(),r._as=r._in.position(),r._in.skip(t),r._ae=r._in.position(),e=r._in.next(),r.load_length(e),p(e))}},{key:"load_ivm",value:function(){var e=this._in;if(e.next()!==g)throw new Error("invalid binary Ion at "+e.position());if(e.next()!==b)throw new Error("invalid binary Ion at "+e.position());if(e.next()!==k)throw new Error("invalid binary Ion at "+e.position());return this._curr=v,this._len=0,l.TB_SYMBOL}},{key:"load_annotation_values",value:function(){var e,t,r,i,n;if(!((r=this._as)<0)){for(n=[],i=this._ae,e=0;r<i;)t=this._in.valueAt(r),r++,e=e<<7|127&t,0!=(128&t)&&(n.push(e),e=0);this._a=n}}},{key:"_readIntegerMagnitude",value:function(){return 0===this._len?w.JsbiSupport.ZERO:this.readUnsignedIntAsBigInt()}},{key:"load_value",value:function(){if(null==this._curr){if(this.isNull())return null;switch(this._raw_type){case l.TB_BOOL:break;case l.TB_INT:this._curr=this._readIntegerMagnitude();break;case l.TB_NEG_INT:this._curr=u.default.unaryMinus(this._readIntegerMagnitude());break;case l.TB_FLOAT:this._curr=this.read_binary_float();break;case l.TB_DECIMAL:0===this._len?this._curr=I.Decimal.ZERO:this._curr=this.read_decimal_value();break;case l.TB_TIMESTAMP:this._curr=this.read_timestamp_value();break;case l.TB_SYMBOL:this._curr=this.readUnsignedIntAsNumber();break;case l.TB_STRING:this._curr=this.read_string_value();break;case l.TB_CLOB:case l.TB_BLOB:if(this.isNull())break;this._curr=this._in.chunk(this._len);break;default:throw new Error("Unexpected type: "+this._raw_type)}}}}],[{key:"_readFloatFrom",value:function(e,t){switch(t){case 0:return 0;case 4:return new DataView(e.chunk(4).buffer).getFloat32(0,!1);case 8:return new DataView(e.chunk(8).buffer).getFloat64(0,!1);case 15:return null;default:throw new Error("Illegal float length: "+t)}}},{key:"_readVarUnsignedIntFrom",value:function(e){for(var t,r=0,i=0;i=i<<7|127&(t=e.next()),r+=7,!(128&t););if(31<r)throw new Error("VarUInt values larger than 31 bits must be read using LongInt.");return i}},{key:"_readVarSignedIntFrom",value:function(e){var t,r=e.next(),i=64&r,n=128&r;r&=63;for(var a=6;!n;)n=128&(t=e.next()),r<<=7,r|=t&=127,a+=7;if(32<a)throw new Error("VarInt values larger than 32 bits must be read using LongInt");return i?-r:r}},{key:"_readSignedIntFrom",value:function(e,t){if(0==t)return new f.default(w.JsbiSupport.ZERO);var r=e.view(t),i=128==(128&r[0]),n=Array.prototype.slice.call(r);n[0]=127&r[0];var a=d.JsbiSerde.fromUnsignedBytes(n);return new f.default(a,i)}},{key:"_readUnsignedIntAsBigIntFrom",value:function(e,t){return d.JsbiSerde.fromUnsignedBytes(Array.prototype.slice.call(e.view(t)))}},{key:"_readUnsignedIntAsNumberFrom",value:function(e,t){var r=0,i=0,n=e.getRemaining();if(t<1)return 0;if(6<t)throw new Error("Attempted to read a ".concat(t,"-byte unsigned integer,")+" which is too large for a to be stored in a number without losing precision.");if(n<t)throw new Error("Attempted to read a ".concat(t,"-byte unsigned integer,")+" but only ".concat(n," bytes were available."));for(;i<t;)i++,r*=256,r+=e.next();return r}},{key:"readDecimalValueFrom",value:function(e,t){var r=e.position(),i=m._readVarSignedIntFrom(e),n=e.position()-r,a=m._readSignedIntFrom(e,t-n),s=a.isNegative,o=s?u.default.unaryMinus(a.magnitude):a.magnitude;return I.Decimal._fromBigIntCoefficient(s,o,i)}}]),m}();r.ParserBinaryRaw=m},{"./IonBinary":4,"./IonConstants":8,"./IonDecimal":9,"./IonTimestamp":24,"./IonTypes":26,"./IonUnicode":27,"./JsbiSerde":29,"./JsbiSupport":30,"./SignAndMagnitudeInt":31,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/slicedToArray":47,jsbi:50}],14:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=i(e("@babel/runtime/helpers/classCallCheck")),n=i(e("@babel/runtime/helpers/createClass")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(r,"__esModule",{value:!0});var u=s(e("./IonText")),l=e("./IonText"),o=e("./IonTypes"),_=e("./JsbiSupport"),h=13,c=10,f="/".charCodeAt(0),d='"'.charCodeAt(0),p="{".charCodeAt(0),y=d,v=[105,110,102];function g(e){if("null"===e)return 1;if("true"===e)return 2;if("false"===e)return 2;if("nan"===e)return 6;if("+inf"===e)return 6;if("-inf"===e)return 6;throw new Error("Unknown keyword: "+e+".")}function b(e){switch(e){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 98:return 11;case 99:return 12;case 100:return 13;case 101:return 14;case 102:return 15;case 65:return 10;case 66:return 11;case 67:return 12;case 68:return 13;case 69:return 14;case 70:return 15}throw new Error("Unexpected bad hex digit in checked data.")}function m(e,t){return e==h?t:e==c?t:!!u.is_whitespace(e)||!(e<32)}r.get_ion_type=function(e){switch(e){case-1:case-2:return null;case 1:return o.IonTypes.NULL;case 2:return o.IonTypes.BOOL;case 3:case 4:return o.IonTypes.INT;case 5:case 6:return o.IonTypes.FLOAT;case 7:return o.IonTypes.DECIMAL;case 8:return o.IonTypes.TIMESTAMP;case 9:case 10:case 11:return o.IonTypes.SYMBOL;case 12:case 13:return o.IonTypes.STRING;case 14:case 15:return o.IonTypes.CLOB;case 16:return o.IonTypes.BLOB;case 17:return o.IonTypes.SEXP;case 18:return o.IonTypes.LIST;case 19:return o.IonTypes.STRUCT;default:throw new Error("Unknown type: "+String(e)+".")}};var T=function(){function r(e){(0,a.default)(this,r),this._value_null=!1,this._curr_null=!1,this._read_value_helper_minus=function(e,t,r){var i=void 0,n=this._peek();105==n?(n=this._peek("inf"),u.isNumericTerminator(n)?i=this._read_minus_inf:t&&(i=this._read_operator_symbol)):u.is_digit(n)?i=this._read_number:t&&(i=this._read_operator_symbol),null!=i?(this._ops.unshift(i),this._unread(e)):this._error("operator symbols are not valid outside of sexps")},this._read_string_helper=function(e,t){var r;for(this._start=this._in.position();;)if(92==(r=this._read()))this._read_string_escape_sequence();else{if(r==e)break;if(!m(r,t))throw new Error("invalid character "+r+" in string")}},this._in=e,this._ops=[this._read_datagram_values],this._value_type=-2,this._value=[],this._start=-1,this._end=-1,this._esc_len=-1,this._curr=-1,this._ann=[],this._msg="",this._fieldname=null,this._fieldnameType=null;function t(e,t){for(var r,i=e.length;0<i;)i--,r=e.charCodeAt(i),n[r]=t}var n={40:this._read_value_helper_paren,91:this._read_value_helper_square,123:this._read_value_helper_curly,43:this._read_value_helper_plus,45:this._read_value_helper_minus,39:this._read_value_helper_single,34:this._read_value_helper_double};t("0123456789",this._read_value_helper_digit),t("_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",this._read_value_helper_letter),t("!#%&*+-./;<=>?@^`|~",this._read_value_helper_operator),n[43]=this._read_value_helper_plus,n[45]=this._read_value_helper_minus,this._read_value_helper_helpers=n}return(0,n.default)(r,[{key:"fieldName",value:function(){return this._fieldname}},{key:"fieldNameType",value:function(){return this._fieldnameType}},{key:"annotations",value:function(){return this._ann}},{key:"clearFieldName",value:function(){this._fieldname=null,this._fieldnameType=null}},{key:"isNull",value:function(){return this._curr_null}},{key:"bigIntValue",value:function(){if(this.isNull())return null;var e=this.get_value_as_string(this._curr);switch(this._curr){case 3:case 4:return _.JsbiSupport.bigIntFromString(e);default:throw new Error("intValue() was called when the current value was not an integer.")}}},{key:"numberValue",value:function(){if(this.isNull())return null;var e=this.get_value_as_string(this._curr);switch(this._curr){case 3:case 4:return _.JsbiSupport.clampToSafeIntegerRange(_.JsbiSupport.bigIntFromString(e));case 5:return Number(e);case 6:if("+inf"==e)return Number.POSITIVE_INFINITY;if("-inf"==e)return Number.NEGATIVE_INFINITY;if("nan"==e)return Number.NaN;default:throw new Error("can't convert to number")}}},{key:"booleanValue",value:function(){if(this.isNull())return null;var e=this.get_value_as_string(2);return"true"==e||"false"!=e&&void 0}},{key:"get_value_as_string",value:function(e){var t,r,i="";switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:for(t=this._start;t<this._end;t++)i+=String.fromCharCode(this._in.valueAt(t));break;case 16:for(t=this._start;t<this._end;t++)r=this._in.valueAt(t),u.is_base64_char(r)&&(i+=String.fromCharCode(r));break;case 11:case 12:case 13:for(t=this._start;t<this._end;t++){var n=!1;if(92==(r=this._in.valueAt(t))&&(r=this._read_escape_sequence(t,this._end),t+=this._esc_len,n=!0),this.isHighSurrogate(r)){t++;var a=this._in.valueAt(t);if(92==a&&(a=this._read_escape_sequence(t,this._end),t+=this._esc_len),!this.isLowSurrogate(a))throw new Error("expected a low surrogate, but found: "+r);var s=65536+((1023&r)<<10)+(1023&a);i+=String.fromCodePoint(s)}else{if(this.isLowSurrogate(r))throw new Error("unexpected low surrogate: "+r);13===e&&39===r&&!n&&this.verifyTriple(t)?t=this._skip_triple_quote_gap(t,this._end,!0):0<=r&&(i+=String.fromCharCode(r))}}break;default:throw new Error("can't get this value as a string")}return i}},{key:"get_value_as_uint8array",value:function(e){var t=[];switch(e){case 14:for(var r=this._start;r<this._end;r++){var i=this._in.valueAt(r);if(92===i)t.push(this.readClobEscapes(r,this._end)),r+=this._esc_len;else{if(!(i<128))throw new Error("Non-Ascii values illegal within clob.");t.push(i)}}break;case 15:for(var n=this._start;n<this._end;n++){var a=this._in.valueAt(n);if(92===a){var s=this.readClobEscapes(n,this._end);0<=s&&t.push(s),n+=this._esc_len}else if(39===a)this.verifyTriple(n)?n=this._skip_triple_quote_gap(n,this._end,!1):t.push(a);else{if(!(a<128))throw new Error("Non-Ascii values illegal within clob.");t.push(a)}}break;default:throw new Error("can't get this value as a Uint8Array")}return Uint8Array.from(t)}},{key:"next",value:function(){var e;return this.clearFieldName(),this._ann=[],-2===this._value_type&&this._run(),this._curr=this._value_pop(),e=-2===this._curr?void this._value.push(-2):this._curr,this._curr_null=this._value_null,this._value_null=!1,e}},{key:"_read_datagram_values",value:function(){-1==this._peek()?this._value_push(-1):(this._ops.unshift(this._read_datagram_values),this._ops.unshift(this._read_value))}},{key:"_read_sexp_values",value:function(){var e=this._read_after_whitespace(!0);if(41==e)this._value_push(-1);else{if(-1===e)throw new Error("Expected closing ).");this._unread(e),this._ops.unshift(this._read_sexp_values),this._ops.unshift(this._read_sexp_value)}}},{key:"_read_list_values",value:function(){var e=this._read_after_whitespace(!0);93==e?this._value_push(-1):(this._unread(e),this._ops.unshift(this._read_list_comma),this._ops.unshift(this._read_value))}},{key:"_read_struct_values",value:function(){var e=this._done_with_error,t=this._read_after_whitespace(!0);switch(t){case 39:e=this._read_string1,-2!=this._peek("''")&&(e=this._read_string3);break;case d:e=this._read_string2;break;case 125:return void this._value_push(-1);default:u.is_letter(t)&&(e=this._read_symbol)}e===this._done_with_error?this._error("expected field name (or close struct '}') not found"):(e.call(this),this._load_field_name(),58!=(t=this._read_after_whitespace(!0))&&this._error("expected ':'"),this._ops.unshift(this._read_struct_comma),this._ops.unshift(this._read_value))}},{key:"_read_list_comma",value:function(){var e=this._read_after_whitespace(!0);44==e?93==(e=this._read_after_whitespace(!0))?this._value_push(-1):(this._unread(e),this._ops.unshift(this._read_list_comma),this._ops.unshift(this._read_value)):93==e?this._value_push(-1):this._error("expected ',' or ']'")}},{key:"_read_struct_comma",value:function(){var e=this._read_after_whitespace(!0);44==e?125==(e=this._read_after_whitespace(!0))?this._value_push(-1):(this._unread(e),this._ops.unshift(this._read_struct_values)):125==e?this._value_push(-1):this._error("expected ',' or '}'")}},{key:"_load_field_name",value:function(){this._fieldnameType=this._value_pop();var e=this.get_value_as_string(this._fieldnameType);switch(this._fieldnameType){case 9:if(l.is_keyword(e))throw new Error("can't use '"+e+"' as a fieldname without quotes");case 11:case 12:case 13:this._fieldname=e;break;default:throw new Error("invalid fieldname"+e)}}},{key:"_read_value",value:function(){this._read_value_helper(!1,this._read_value)}},{key:"_read_sexp_value",value:function(){this._read_value_helper(!0,this._read_sexp_value)}},{key:"_read_value_helper",value:function(e,t){var r=this._read_after_whitespace(!0);if(-1==r)this._read_value_helper_EOF(r,e,t);else{var i=this._read_value_helper_helpers[r];null!=i?i.call(this,r,e,t):this._error("unexpected character '"+u.asAscii(r)+"'")}}},{key:"_read_value_helper_EOF",value:function(){this._ops.unshift(this._done)}},{key:"_read_value_helper_paren",value:function(){this._value_push(17),this._ops.unshift(this._read_sexp_values)}},{key:"_read_value_helper_square",value:function(){this._value_push(18),this._ops.unshift(this._read_list_values)}},{key:"_read_value_helper_curly",value:function(){var e,t=this._read();t==p?39==(e=this._read_after_whitespace(!1))?this._ops.unshift(this._read_clob_string3):e==d?this._ops.unshift(this._read_clob_string2):(this._unread(e),this._ops.unshift(this._read_blob)):(this._unread(t),this._value_push(19),this._ops.unshift(this._read_struct_values))}},{key:"_read_value_helper_plus",value:function(e,t){var r=this._peek("inf");this._unread(e),u.isNumericTerminator(r)?this._ops.unshift(this._read_plus_inf):t?this._ops.unshift(this._read_operator_symbol):this._error("unexpected '+'")}},{key:"_read_value_helper_digit",value:function(e){var t=this._peek_4_digits(e);this._unread(e),84==t||45==t?this._ops.unshift(this._readTimestamp):this._ops.unshift(this._read_number)}},{key:"_read_value_helper_single",value:function(e,t,r){var i;-2!=this._peek("''")?(i=this._read_string3).call(this):((i=this._read_string1).call(this),this._test_string_as_annotation(i)&&this._ops.unshift(r))}},{key:"_read_value_helper_double",value:function(){this._ops.unshift(this._read_string2)}},{key:"_read_value_helper_letter",value:function(e,t,r){this._start;this._read_symbol();var i=this._value_pop();if(9!=i)throw new Error("Expecting symbol here.");var n=this.get_value_as_string(i);if(l.is_keyword(n)){var a=g(n);if(1===a){if(this._value_null=!0,46===this._peek()){this._read();var s=this._read();if(!0!==u.is_letter(s))throw new Error("Expected type name after 'null.'");if(this._read_symbol(),9!==this._value_pop())throw new Error("Expected type name after 'null.'");a=function(e){if("null"===e)return 1;if("bool"===e)return 2;if("int"===e)return 3;if("float"===e)return 5;if("decimal"===e)return 7;if("timestamp"===e)return 8;if("symbol"===e)return 9;if("string"===e)return 12;if("clob"===e)return 14;if("blob"===e)return 16;if("sexp"===e)return 17;if("list"===e)return 18;if("struct"===e)return 19;throw new Error("Unknown type: "+e+".")}(n=this.get_value_as_string(9))}this._start=-1,this._end=-1}this._value_push(a)}else{var o=this._read_after_whitespace(!0);if(58==o&&58==this._peek())this._read(),this._ann.push(n),this._ops.unshift(r);else{this._unread(o),this._value_push(9)}}}},{key:"_read_value_helper_operator",value:function(e,t){t?(this._unread(e),this._ops.unshift(this._read_operator_symbol)):this._error("unexpected operator character")}},{key:"_done",value:function(){this._value_push(-1)}},{key:"_done_with_error",value:function(){throw this._value_push(-2),new Error(this._error_msg)}},{key:"_read_number",value:function(){var e,t;if(this._start=this._in.position(),45==(e=this._read())&&(e=this._read()),48==e){if(120==(e=this._peek())||88==e)return void this._read_hex_int();u.is_digit(e)&&this._error("leading zeros are not allowed"),e=48}t=3,46==(e=this._read_required_digits(e))&&(t=7,e=this._read_optional_digits(this._read())),u.isNumericTerminator(e)||(100==e||68==e?(t=7,e=this._read_exponent()):101!=e&&69!=e&&102!=e&&70!=e||(t=5,e=this._read_exponent())),u.isNumericTerminator(e)?(this._unread(e),this._end=this._in.position(),this._value_push(t)):this._error("invalid character after number")}},{key:"_read_hex_int",value:function(){var e=this._read();120!=e&&88!=e||(e=this._read(),e=this._read_required_hex_digits(e)),u.isNumericTerminator(e)?(this._unread(e),this._end=this._in.position(),this._value_push(4)):this._error("invalid character after number")}},{key:"_read_exponent",value:function(){var e=this._read();return 45!=e&&43!=e||(e=this._read()),e=this._read_required_digits(e)}},{key:"_read_plus_inf",value:function(){this._start=this._in.position(),43==this._read()?this._read_inf_helper():this._error("expected +inf")}},{key:"_read_minus_inf",value:function(){this._start=this._in.position(),45==this._read()?this._read_inf_helper():this._error("expected -inf")}},{key:"_read_inf_helper",value:function(){var e;for(e=0;e<3;e++)if(this._read()!=v[e])return void this._error("expected 'inf'");u.isNumericTerminator(this._peek())?(this._end=this._in.position(),this._value_push(6)):this._error("invalid numeric terminator after 'inf'")}},{key:"_readTimestamp",value:function(){this._start=this._in.position();var e=this._readPastNDigits(4);if(84===e)return this._end=this._in.position(),void this._value_push(8);if(45!==e)throw new Error("Timestamp year must be followed by '-' or 'T'.");if(84===(e=this._readPastNDigits(2)))return this._end=this._in.position(),void this._value_push(8);if(45!==e)throw new Error("Timestamp month must be followed by '-' or 'T'.");if(e=this._readPastNDigits(2),u.isNumericTerminator(e))return this._unread(e),this._end=this._in.position(),void this._value_push(8);if(84!==e)throw new Error("Timestamp day must be followed by a numeric stop character .");var t=this._in.peek();if(u.isNumericTerminator(t))return this._end=this._in.position(),void this._value_push(8);if(!u.is_digit(t))throw new Error("Timestamp DATE must be followed by numeric terminator or additional TIME digits.");if(58!==(e=this._readPastNDigits(2)))throw new Error("Timestamp time(hr:min) requires format of 00:00");if(58===(e=this._readPastNDigits(2))&&46===(e=this._readPastNDigits(2))){if(!u.is_digit(this._read()))throw new Error("W3C timestamp spec requires atleast one digit after decimal point.");for(;u.is_digit(e=this._read()););}if(90===e){if(!u.isNumericTerminator(this._peek()))throw new Error("Illegal terminator after Zulu offset.");return this._end=this._in.position(),void this._value_push(8)}if(43!==e&&45!==e)throw new Error("Timestamps require an offset.");if(58!==(e=this._readPastNDigits(2)))throw new Error("Timestamp offset(hr:min) requires format of +/-00:00.");if(this._readNDigits(2),e=this._peek(),!u.isNumericTerminator(e))throw new Error("Improperly formatted timestamp.");this._end=this._in.position(),this._value_push(8)}},{key:"_read_symbol",value:function(){var e;for(this._start=this._in.position()-1;e=this._read(),u.is_letter_or_digit(e););this._unread(e),this._end=this._in.position(),this._value_push(9)}},{key:"_read_operator_symbol",value:function(){var e;for(this._start=this._in.position();e=this._read(),u.is_operator_char(e););this._end=this._in.position()-1,this._unread(e),this._value_push(10)}},{key:"_read_string1",value:function(){this._read_string_helper(39,!1),this._end=this._in.position()-1,this._value_push(11)}},{key:"_read_string2",value:function(){this._read_string_helper(d,!1),this._end=this._in.position()-1,this._value_push(12)}},{key:"_read_string3",value:function(e){var t;for(void 0===e&&(e=!0),this._unread(this._peek("")),this._start=this._in.position()+3;-2!==this._peek("'''");this._in.unread(this._read_after_whitespace(e))){for(var r=0;r<3;r++)this._read();for(;-2===this._peek("'''");){if(92==(t=this._read())&&this._read_string_escape_sequence(),-1===t)throw new Error("Closing triple quotes not found.");if(!m(t,!0))throw new Error("invalid character "+t+" in string")}this._end=this._in.position();for(var i=0;i<3;i++)this._read()}this._value_push(13)}},{key:"verifyTriple",value:function(e){return 39===this._in.valueAt(e)&&39===this._in.valueAt(e+1)&&39===this._in.valueAt(e+2)}},{key:"_read_string_escape_sequence",value:function(){var e=this._read();switch(e){case 48:case 97:case 98:case 116:case 110:case 102:case 114:case 118:case y:case 39:case 63:case 92:case 47:case 10:break;case 13:10!=(e=this._read())&&this._unread(e);break;case 120:e=this._read_N_hexdigits(2),this._unread(e);break;case 117:e=this._read_N_hexdigits(4),this._unread(e);break;case 85:e=this._read_N_hexdigits(8),this._unread(e);break;default:this._error("unexpected character: "+e+" after escape slash")}}},{key:"_test_string_as_annotation",value:function(){var e,t,r=this._value_pop();return 11!=r&&13!=r&&this._error("expecting quoted symbol here"),e=this.get_value_as_string(r),58==(t=this._read_after_whitespace(!0))&&58==this._peek()?(this._read(),this._ann.push(e),!0):(this._unread(t),this._value_push(r),!1)}},{key:"_read_clob_string2",value:function(){this._read_string2(),12!=this._value_pop()&&this._error("string expected"),this._value_push(14),this._ops.unshift(this._read_close_double_brace)}},{key:"_read_clob_string3",value:function(){this._read_string3(!1),13!=this._value_pop()&&this._error("string expected"),this._value_push(15),this._ops.unshift(this._read_close_double_brace)}},{key:"_read_blob",value:function(){var e,t=0,r=0;for(this._start=this._in.position();;)if(e=this._read(),u.is_base64_char(e))t++,this._end=this._in.position();else if(!u.is_whitespace(e))break;for(;61==e;)r++,e=this._read_after_whitespace(!1);if(125!=e||125!=this._read())throw new Error("Invalid blob");if(!function(e,t){return!(2<t)&&0==(e+t&3)}(t,r))throw new Error("Invalid base64 value");this._value_push(16)}},{key:"_read_comma",value:function(){44!=this._read_after_whitespace(!0)&&this._error("expected ','")}},{key:"_read_close_double_brace",value:function(){125==this._read_after_whitespace(!1)&&125==this._read()||this._error("expected '}}'")}},{key:"isHighSurrogate",value:function(e){return 55296<=e&&e<=56319}},{key:"isLowSurrogate",value:function(e){return 56320<=e&&e<=57343}},{key:"indexWhiteSpace",value:function(e,t){var r=this._in.valueAt(e);if(t){for(;l.is_whitespace(r)||r===f;r=this._in.valueAt(e++))if(r===f)switch(r=this._in.valueAt(e++)){case f:e=this.indexToNewLine(e);break;case 42:e=this.indexToCloseComment(e);break;default:e--}}else for(;l.is_whitespace(r);r=this._in.valueAt(e++));return e}},{key:"indexToNewLine",value:function(e){for(var t=this._in.valueAt(e);-1!==t&&t!==c;){if(t===h&&this._in.valueAt(e+1)!==c)return e;t=this._in.valueAt(e++)}return e}},{key:"indexToCloseComment",value:function(e){for(;42!==this._in.valueAt(e)&&this._in.valueAt(e+1)!==f;)e++;return e}},{key:"_skip_triple_quote_gap",value:function(e,t,r){var i=e+3;this._in.valueAt(i);return(i=this.indexWhiteSpace(i,r))+2<=t&&this.verifyTriple(i)?i+4:i+1}},{key:"readClobEscapes",value:function(e,t){var r;if(!(t<=e+1)){switch(r=this._in.valueAt(e+1),this._esc_len=1,r){case 48:return 0;case 97:return 7;case 98:return 8;case 116:return 9;case 110:return 10;case 102:return 12;case 114:return 13;case 118:return 11;case y:return 34;case 39:return 39;case 63:return 63;case 92:return 92;case 47:return 47;case 10:return-1;case 13:return e+3<t&&this._in.valueAt(e+3)==c&&(this._esc_len=2),u.ESCAPED_NEWLINE;case 120:if(t<=e+3)return void this._error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+4),this._esc_len=3;break;default:throw new Error("Invalid escape: /"+r)}return r}this._error("invalid escape sequence")}},{key:"_read_escape_sequence",value:function(e,t){var r;if(t<=e+1)throw new Error("Invalid escape sequence.");switch(r=this._in.valueAt(e+1),this._esc_len=1,r){case 48:return 0;case 97:return 7;case 98:return 8;case 116:return 9;case 110:return 10;case 102:return 12;case 114:return 13;case 118:return 11;case y:return 34;case 39:return 39;case 63:return 63;case 92:return 92;case 47:return 47;case 10:return-1;case 13:return e+3<t&&this._in.valueAt(e+3)==c&&(this._esc_len=2),u.ESCAPED_NEWLINE;case 120:if(t<=e+3)return void this._error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+4),this._esc_len=3;break;case 117:if(t<=e+5)return void this._error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+6),this._esc_len=5;break;case 85:if(t<=e+9)return void this._error("invalid escape sequence");r=this._get_N_hexdigits(e+2,e+10),this._esc_len=9;break;default:this._error("unexpected character after escape slash")}return r}},{key:"_get_N_hexdigits",value:function(e,t){for(var r=0;e<t;)r=16*r+b(this._in.valueAt(e)),e++;return r}},{key:"_value_push",value:function(e){-2!==this._value_type&&this._error("unexpected double push of value type!"),this._value_type=e}},{key:"_value_pop",value:function(){var e=this._value_type;return this._value_type=-2,e}},{key:"_run",value:function(){for(;0<this._ops.length&&-2===this._value_type;)this._ops.shift().call(this)}},{key:"_read",value:function(){return this._in.next()}},{key:"_read_skipping_comments",value:function(){var e=this._read();return e==f&&(e=(e=this._read())==f?(this._read_to_newline(),u.WHITESPACE_COMMENT1):42==e?(this._read_to_close_comment(),u.WHITESPACE_COMMENT2):(this._unread(e),f)),e}},{key:"_read_to_newline",value:function(){for(var e;-1!=(e=this._read())&&e!=c;)if(e==h){(e=this._read())!=c&&this._unread(e);break}}},{key:"_read_to_close_comment",value:function(){for(var e;-1!=(e=this._read())&&(42!=e||(e=this._read())!=f););}},{key:"_unread",value:function(e){this._in.unread(e)}},{key:"_read_after_whitespace",value:function(e){var t;if(e)for(t=this._read_skipping_comments();u.is_whitespace(t);)t=this._read_skipping_comments();else for(t=this._read();u.is_whitespace(t);)t=this._read();return t}},{key:"_peek",value:function(e){var t,r=0;if(void 0===e||e.length<1)return this._in.valueAt(this._in.position());for(;r<e.length&&(t=this._read())==e.charCodeAt(r);)r++;for(t=r===e.length?this._peek():(this._unread(t),-2);0<r;)r--,this._unread(e.charCodeAt(r));return t}},{key:"_peek_after_whitespace",value:function(e){var t=this._read_after_whitespace(e);return this._unread(t),t}},{key:"_peek_4_digits",value:function(e){var t,r,i=!0,n=[];if(!u.is_digit(e))return-2;for(t=0;t<3;t++)if(r=this._read(),n.push(r),!u.is_digit(r)){i=!1;break}for(r=i&&3==t?this._peek():-2;0<n.length;)this._unread(n.pop());return r}},{key:"_read_required_digits",value:function(e){if(!u.is_digit(e))return-2;for(;e=this._read(),u.is_digit(e););return e}},{key:"_read_optional_digits",value:function(e){for(;u.is_digit(e);)e=this._read();return e}},{key:"_readNDigits",value:function(e){var t;if(e<=0)throw new Error("Cannot read a lack of or negative number of digits.");for(;e--;)if(!u.is_digit(t=this._read()))throw new Error("Expected digit, got: "+String.fromCharCode(t));return t}},{key:"_readPastNDigits",value:function(e){return this._readNDigits(e),this._read()}},{key:"_read_required_hex_digits",value:function(e){if(!u.is_hex_digit(e))return-2;for(;e=this._read(),u.is_hex_digit(e););return e}},{key:"_read_N_hexdigits",value:function(e){for(var t,r=0;r<e;){if(t=this._read(),!u.is_hex_digit(t))return this._error(e+" digits required "+r+" found"),-2;r++}return t}},{key:"_read_hours_and_minutes",value:function(e){return u.is_digit(e)?e=58==(e=this._readPastNDigits(1))?this._readPastNDigits(2):-2:-2}},{key:"_check_for_keywords",value:function(){var e,t=this._value_pop();9==t&&3<=(e=this._end-this._start)&&e<=5&&(t=g(this.get_value_as_string(t))),this._value_push(t)}},{key:"_error",value:function(e){this._ops.unshift(this._done_with_error),this._error_msg=e}}]),r}();r.ParserTextRaw=T},{"./IonText":21,"./IonTypes":26,"./JsbiSupport":30,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],15:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=i(e("@babel/runtime/helpers/possibleConstructorReturn")),o=i(e("@babel/runtime/helpers/getPrototypeOf")),u=i(e("@babel/runtime/helpers/inherits"));Object.defineProperty(r,"__esModule",{value:!0});var l=e("./IonTextWriter"),_=e("./IonText"),h=e("./IonTypes"),c=function(e){function i(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;return(0,n.default)(this,i),(t=(0,s.default)(this,(0,o.default)(i).call(this,e))).indentSize=r,t.indentCount=0,t}return(0,u.default)(i,e),(0,a.default)(i,[{key:"writeFieldName",value:function(e){if(this.currentContainer.containerType!==h.IonTypes.STRUCT)throw new Error("Cannot write field name outside of a struct");if(this.currentContainer.state!==l.State.STRUCT_FIELD)throw new Error("Expecting a struct value");this.currentContainer.clean||(this.writeable.writeByte(_.CharCodes.COMMA),this.writePrettyNewLine(0)),this.writePrettyIndent(0),this.writeSymbolToken(e),this.writeable.writeByte(_.CharCodes.COLON),this.currentContainer.state=l.State.VALUE}},{key:"writeNull",value:function(e){if(null==e||e.binaryTypeId<0||13<e.binaryTypeId)throw new Error("Cannot write null for type ".concat(e));this.handleSeparator(),this.writePrettyValue(),this.writeAnnotations(),this.writeUtf8("null."+e.name),this.currentContainer.containerType===h.IonTypes.STRUCT&&(this.currentContainer.state=l.State.STRUCT_FIELD)}},{key:"stepOut",value:function(){var e=this.containerContext.pop();if(!e||!e.containerType)throw new Error("Can't step out when not in a container");if(e.containerType===h.IonTypes.STRUCT&&e.state===l.State.VALUE)throw new Error("Expecting a struct value");switch(e.clean||this.writePrettyNewLine(0),this.writePrettyIndent(-1),e.containerType){case h.IonTypes.LIST:this.writeable.writeByte(_.CharCodes.RIGHT_BRACKET);break;case h.IonTypes.SEXP:this.writeable.writeByte(_.CharCodes.RIGHT_PARENTHESIS);break;case h.IonTypes.STRUCT:this.writeable.writeByte(_.CharCodes.RIGHT_BRACE);break;default:throw new Error("Unexpected container type")}}},{key:"_serializeValue",value:function(e,t,r){if(this.currentContainer.state===l.State.STRUCT_FIELD)throw new Error("Expecting a struct field");null!=t?(this.handleSeparator(),this.writePrettyValue(),this.writeAnnotations(),r(t),this.currentContainer.containerType===h.IonTypes.STRUCT&&(this.currentContainer.state=l.State.STRUCT_FIELD)):this.writeNull(e)}},{key:"writeContainer",value:function(e,t){this.currentContainer.containerType===h.IonTypes.STRUCT&&this.currentContainer.state===l.State.VALUE&&(this.currentContainer.state=l.State.STRUCT_FIELD),this.handleSeparator(),this.writePrettyValue(),this.writeAnnotations(),this.writeable.writeByte(t),this.writePrettyNewLine(1),this._stepIn(e)}},{key:"handleSeparator",value:function(){if(0===this.depth())this.currentContainer.clean?this.currentContainer.clean=!1:this.writeable.writeByte(_.CharCodes.LINE_FEED);else if(this.currentContainer.clean)this.currentContainer.clean=!1;else switch(this.currentContainer.containerType){case h.IonTypes.LIST:this.writeable.writeByte(_.CharCodes.COMMA),this.writePrettyNewLine(0);break;case h.IonTypes.SEXP:this.writeable.writeByte(_.CharCodes.SPACE),this.writePrettyNewLine(0)}}},{key:"writePrettyValue",value:function(){0<this.depth()&&this.currentContainer.containerType&&this.currentContainer.containerType!==h.IonTypes.STRUCT&&this.writePrettyIndent(0)}},{key:"writePrettyNewLine",value:function(e){this.indentCount=this.indentCount+e,this.indentSize&&0<this.indentSize&&this.writeable.writeByte(_.CharCodes.LINE_FEED)}},{key:"writePrettyIndent",value:function(e){if(this.indentCount=this.indentCount+e,this.indentSize&&0<this.indentSize)for(var t=0;t<this.indentCount*this.indentSize;t++)this.writeable.writeByte(_.CharCodes.SPACE)}}]),i}(l.TextWriter);r.PrettyTextWriter=c},{"./IonText":21,"./IonTextWriter":23,"./IonTypes":26,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/getPrototypeOf":40,"@babel/runtime/helpers/inherits":41,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/possibleConstructorReturn":45}],16:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),a=i(e("@babel/runtime/helpers/classCallCheck")),s=i(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function n(e,t,r){(0,a.default)(this,n),this._name=e,this._version=t,this._symbols=r,this._idsByText=new Map,this._numberOfSymbols=this._symbols.length;for(var i=r.length-1;0<=i;i--)this._idsByText[r[i]]=i}return(0,s.default)(n,[{key:"getSymbolText",value:function(e){if(e<0)throw new Error("Index ".concat(e," is out of bounds for the SharedSymbolTable name=").concat(this.name,", version=").concat(this.version));if(!(e>=this.numberOfSymbols))return this._symbols[e]}},{key:"getSymbolId",value:function(e){var t=this._idsByText[e];return void 0===t?null:t}},{key:"numberOfSymbols",get:function(){return this._numberOfSymbols}},{key:"name",get:function(){return this._name}},{key:"version",get:function(){return this._version}}]),n}();r.SharedSymbolTable=n},{"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],17:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/possibleConstructorReturn")),a=i(e("@babel/runtime/helpers/getPrototypeOf")),s=i(e("@babel/runtime/helpers/inherits")),o=i(e("@babel/runtime/helpers/classCallCheck")),u=i(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var l=e("./IonConstants"),_=function(){function t(e){(0,o.default)(this,t),this._type=e}return(0,u.default)(t,[{key:"write",value:function(){throw new Error("not implemented")}}],[{key:"error",value:function(){throw new Error("span error")}}]),t}(),h=function(e){function r(e){var t;return(0,o.default)(this,r),(t=(0,n.default)(this,(0,a.default)(r).call(this,0)))._line=1,t._src=e,t._limit=e.length,t._start=0,t._pos=0,t._line_start=0,t._old_line_start=0,t}return(0,s.default)(r,e),(0,u.default)(r,[{key:"viewSource",value:function(){return this._src}},{key:"position",value:function(){return this._pos-this._start}},{key:"getRemaining",value:function(){return this._limit-this._pos}},{key:"setRemaining",value:function(e){this._limit=e+this._pos}},{key:"is_empty",value:function(){return this._pos>=this._limit}},{key:"next",value:function(){var e;if(this.is_empty()){if(1073741824<this._pos)throw new Error("span position is out of bounds");return this._pos++,l.EOF}return 13===(e=this._src.charCodeAt(this._pos))?10!=this.peek()&&this._inc_line():10==e&&this._inc_line(),this._pos++,e}},{key:"_inc_line",value:function(){this._old_line_start=this._line_start,this._line++,this._line_start=this._pos}},{key:"unread",value:function(e){this._pos<=this._start&&_.error(),this._pos--,e<0?1!=this.is_empty()&&_.error():(this._pos==this._line_start&&(this._line_start=this._old_line_start,this._line--),e!=this.peek()&&_.error())}},{key:"peek",value:function(){return this.valueAt(this._pos)}},{key:"skip",value:function(e){this._pos+=e,this._pos>this._limit&&(this._pos=this._limit)}},{key:"valueAt",value:function(e){return e<this._start||e>=this._limit?l.EOF:this._src.charCodeAt(e)}},{key:"chunk",value:function(e){var t=this._src.substr(this._pos,e);return this._pos+=e,t}},{key:"getCodePoint",value:function(e){return this._src.codePointAt(e)}},{key:"line_number",value:function(){return this._line}},{key:"offset",value:function(){return this._pos-this._line_start}},{key:"clone",value:function(){return new r(this._src.substr(this._pos))}}]),r}(r.Span=_);r.StringSpan=h;var c=function(e){function r(e){var t;return(0,o.default)(this,r),(t=(0,n.default)(this,(0,a.default)(r).call(this,1)))._src=e,t._limit=e.length,t._start=0,t._pos=0,t}return(0,s.default)(r,e),(0,u.default)(r,[{key:"position",value:function(){return this._pos-this._start}},{key:"getRemaining",value:function(){return this._limit-this._pos}},{key:"setRemaining",value:function(e){this._limit=e+this._pos}},{key:"is_empty",value:function(){return this._pos>=this._limit}},{key:"next",value:function(){return this.is_empty()?l.EOF:this._src[this._pos++]}},{key:"view",value:function(e){if(this._pos+e>this._limit)throw new Error("Unable to read "+e+" bytes (position: "+this.position()+", limit: "+this._limit+")");return this._src.subarray(this._pos,this._pos+=e)}},{key:"chunk",value:function(e){return new Uint8Array(this.view(e))}},{key:"unread",value:function(e){this._pos<=this._start&&_.error(),this._pos--,e==l.EOF&&0==this.is_empty()&&_.error(),e!=this.peek()&&_.error()}},{key:"peek",value:function(){return this.is_empty()?l.EOF:this._src[this._pos]}},{key:"skip",value:function(e){if(this._pos+=e,this._pos>this._limit)throw new Error("Skipped over end of source.")}},{key:"valueAt",value:function(e){if(!(e<this._start||e>=this._limit))return this._src[e]}},{key:"clone",value:function(){return new r(this._src.subarray(this._pos))}}]),r}(_);r.BinarySpan=c},{"./IonConstants":8,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/getPrototypeOf":40,"@babel/runtime/helpers/inherits":41,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/possibleConstructorReturn":45}],18:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=i(e("@babel/runtime/helpers/possibleConstructorReturn")),o=i(e("@babel/runtime/helpers/getPrototypeOf")),u=i(e("@babel/runtime/helpers/inherits"));Object.defineProperty(r,"__esModule",{value:!0});var l=function(e){function r(e){var t;if((0,n.default)(this,r),e<0)throw new Error("Cannot instantiate a SubstituteSymbolTable with a negative length. ("+e+")");return(t=(0,s.default)(this,(0,o.default)(r).call(this,"_substitute",void 0,[])))._numberOfSymbols=e,t}return(0,u.default)(r,e),(0,a.default)(r,[{key:"getSymbolText",value:function(e){if(e<0)throw new Error("Index ".concat(e," is out of bounds for the SharedSymbolTable name=").concat(this.name,", version=").concat(this.version))}},{key:"getSymbolId",value:function(){}}]),r}(e("./IonSharedSymbolTable").SharedSymbolTable);r.SubstituteSymbolTable=l},{"./IonSharedSymbolTable":16,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/getPrototypeOf":40,"@babel/runtime/helpers/inherits":41,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/possibleConstructorReturn":45}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("./IonSystemSymbolTable"),u=e("./IonImport"),s=e("./IonLocalSymbolTable"),l=e("./IonSubstituteSymbolTable");r.ion_symbol_table="$ion_symbol_table",r.ion_symbol_table_sid=3;function _(e,t){var r=o.getSystemSymbolTableImport();for(e.stepIn();e.next();){e.stepIn();for(var i=void 0,n=1,a=void 0;e.next();)switch(e.fieldName()){case"name":i=e.stringValue();break;case"version":n=e.numberValue();break;case"max_id":a=e.numberValue()}if(n<1&&(n=1),i&&"$ion"!==i){var s=t.getVersion(i,n);if(!s){if(void 0===a)throw new Error("No exact match found when trying to import symbol table ".concat(i," version ").concat(n));s=t.getTable(i)}s=s||new l.SubstituteSymbolTable(a),r=new u.Import(r,s,a)}e.stepOut()}return e.stepOut(),r}function h(e){var t=[];for(e.stepIn();e.next();)t.push(e.stringValue());return e.stepOut(),t}r.makeSymbolTable=function(e,t){var r,i,n=!1,a=!1;for(t.stepIn();t.next();)switch(t.fieldName()){case"imports":if(a)throw new Error("Multiple import fields found.");r=_(t,e),a=!0;break;case"symbols":if(n)throw new Error("Multiple symbol fields found.");i=h(t),n=!0}return t.stepOut(),new s.LocalSymbolTable(r,i)}},{"./IonImport":10,"./IonLocalSymbolTable":11,"./IonSubstituteSymbolTable":18,"./IonSystemSymbolTable":20}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./IonImport"),n=new(e("./IonSharedSymbolTable").SharedSymbolTable)("$ion",1,["$ion","$ion_1_0","$ion_symbol_table","name","version","imports","symbols","max_id","$ion_shared_symbol_table"]);function a(){return n}r.getSystemSymbolTable=a,r.getSystemSymbolTableImport=function(){return new i.Import(null,a())}},{"./IonImport":10,"./IonSharedSymbolTable":16}],21:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/extends"));Object.defineProperty(r,"__esModule",{value:!0}),r.WHITESPACE_COMMENT1=-2,r.WHITESPACE_COMMENT2=-3,r.ESCAPED_NEWLINE=-4;var n=34,a=39,s=92,o={0:"\\0",8:"\\b",9:"\\t",10:"\\n",13:"\\r",DOUBLE_QUOTE:'\\"',SINGLE_QUOTE:"\\'",SLASH:"\\\\"};function u(e){var t=e.length,r=[];for(r[128]=!1;0<t;)--t,r[e.charCodeAt(t)]=!0;return r}var l=u("+/0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),_=u("0123456789abcdefABCDEF"),h=u("_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),c=u("_$0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),f=u("{}[](),\"' \t\n\r\v\f"),d=u("!#%&*+-./;<=>?@^`|~"),p=u(" \t\r\n\v\f"),y=u("_$0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");function v(e){return!(e<48||57<e)}function g(e,t){for(;0<t--&&!b(e.charCodeAt(t)););return t}function b(e){return e<32||(126<e||(e===n||e===a||e===s))}function m(e,t){for(var r,i,n,a=[];0<=t&&b(r=e.charCodeAt(t));)a.push([t,r]),t=g(e,t);if(0<a.length){for(n="",i=a.length,t=e.length;i--;){var s=a[i];n=0<t-s[0]-1?T(s[1])+e.substring(s[0]+1,t)+n:e.substring(s[0]+1,t)+n,t=s[0]-1}0<=t&&(n=e.substring(0,t)+n),e=n}return e}function T(e){var t=o[e];return void 0===t&&(t=e<256?"\\x"+w(e,2):e<=65535?"\\u"+w(e,4):"\\U"+w(e,8)),t}function w(e,t){for(var r="";0<e;)r+="0123456789ABCDEF".charAt(e&&15),e/=16;return r.length<t&&(r=(r="000000000"+r).substring(r.length-t,r.length)),r}r.is_digit=v,r.is_keyword=function(e){return"null"===e||"true"===e||"false"===e||"nan"===e||"+inf"===e||"-inf"===e},r.asAscii=function(e){if(void 0===e)e="undefined::null";else if("number"==typeof e)e=""+e;else if("string"!=typeof e){var t=g(e,e.length);0<=t&&(e=m(e,t))}return e},r.nextEscape=g,r.needsEscape=b,r.escapeString=m,r.escapeSequence=T,r.toHex=w,r.is_letter=function(e){return h[e]},r.isNumericTerminator=function(e){return-1==e||f[e]},r.is_letter_or_digit=function(e){return c[e]},r.is_operator_char=function(e){return d[e]},r.is_whitespace=function(e){return!(32<e)&&(e==this.WHITESPACE_COMMENT1||(e==this.WHITESPACE_COMMENT2||(e==this.ESCAPED_NEWLINE||p[e])))},r.is_base64_char=function(e){return l[e]},r.is_hex_digit=function(e){return _[e]};var I,S,k=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],E={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63};function C(e){return[I.BACKSLASH,e.charCodeAt(0)]}r.fromBase64=function(e){for(var t=0,r=e.length-1;"="==e.charAt(r);r--)t++;for(var i=new Uint8Array(3*e.length/4-t),n=0;n<e.length-t;n+=4){var a=E[e.charAt(n)],s=E[e.charAt(n+1)],o=E[e.charAt(n+2)],u=E[e.charAt(n+3)];i[3*n/4]=a<<2&255|s>>>4,n+2<e.length-t&&(i[3*n/4+1]=s<<4&255|o>>>2,n+3<e.length-t&&(i[3*n/4+2]=o<<6&255|u))}return i},r.toBase64=function(e){for(var t=new Array(Math.ceil(4*e.length/3)),r=0;r<e.length;r+=3){var i=e[r],n=e[r+1],a=e[r+2];e[r+3];if(t[4*r/3]=k[i>>>2],t[4*r/3+1]=k[i<<4&63|(n||0)>>>4],!(r+1<e.length))return t.join("")+"==";if(t[4*r/3+2]=k[n<<2&63|(a||0)>>>6],!(r+2<e.length))return t.join("")+"=";t[4*r/3+3]=k[63&a]}return t.join("")},(S=I=r.CharCodes||(r.CharCodes={}))[S.NULL=0]="NULL",S[S.BELL=7]="BELL",S[S.BACKSPACE=8]="BACKSPACE",S[S.HORIZONTAL_TAB=9]="HORIZONTAL_TAB",S[S.LINE_FEED=10]="LINE_FEED",S[S.VERTICAL_TAB=11]="VERTICAL_TAB",S[S.FORM_FEED=12]="FORM_FEED",S[S.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",S[S.DOUBLE_QUOTE=34]="DOUBLE_QUOTE",S[S.SINGLE_QUOTE=39]="SINGLE_QUOTE",S[S.FORWARD_SLASH=47]="FORWARD_SLASH",S[S.QUESTION_MARK=63]="QUESTION_MARK",S[S.BACKSLASH=92]="BACKSLASH",S[S.LEFT_PARENTHESIS=40]="LEFT_PARENTHESIS",S[S.RIGHT_PARENTHESIS=41]="RIGHT_PARENTHESIS",S[S.LEFT_BRACE=123]="LEFT_BRACE",S[S.RIGHT_BRACE=125]="RIGHT_BRACE",S[S.LEFT_BRACKET=91]="LEFT_BRACKET",S[S.RIGHT_BRACKET=93]="RIGHT_BRACKET",S[S.COMMA=44]="COMMA",S[S.SPACE=32]="SPACE",S[S.LOWERCASE_X=120]="LOWERCASE_X",S[S.COLON=58]="COLON";var A=[I.BACKSLASH,I.LOWERCASE_X];function N(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return A.concat(function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(t))}function O(e,t,r){if(void 0===r)e[t]=N(t);else for(var i=t;i<r;i++)e[i]=N(i)}var B={};B[I.NULL]=C("0"),O(B,1,7),B[I.BELL]=C("a"),B[I.BACKSPACE]=C("b"),B[I.HORIZONTAL_TAB]=C("t"),B[I.LINE_FEED]=C("n"),B[I.VERTICAL_TAB]=C("v"),B[I.FORM_FEED]=C("f"),B[I.CARRIAGE_RETURN]=C("r"),O(B,14,32),B[I.BACKSLASH]=C("\\"),O(B,127,160),r.ClobEscapes=(0,i.default)({},B),r.ClobEscapes[I.DOUBLE_QUOTE]=C('"'),r.ClobEscapes[I.SINGLE_QUOTE]=C("'"),r.ClobEscapes[I.FORWARD_SLASH]=C("/"),r.ClobEscapes[I.QUESTION_MARK]=C("?"),r.StringEscapes=(0,i.default)({},B),r.StringEscapes[I.DOUBLE_QUOTE]=C('"'),r.SymbolEscapes=(0,i.default)({},B),r.SymbolEscapes[I.SINGLE_QUOTE]=C("'"),r.isIdentifier=function(e){if(v(e.charCodeAt(0)))return!1;for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(!y[r])return!1}return!0},r.isOperator=function(e){for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(!d[r])return!1}return!0},r.isDigit=function(e){return e<58&&47<e},r.escape=function(e,t){for(var r,i="",n="",a=0,s=0;s<e.length;s++)if(void 0!==(r=t[e.charCodeAt(s)])){for(var o=0;o<r.length;o++)n+=String.fromCharCode(r[o]);i+=e.slice(a,s)+n,a=s+1,n=""}return i+e.slice(a,e.length)}},{"@babel/runtime/helpers/extends":38,"@babel/runtime/helpers/interopRequireDefault":42}],22:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=e("./IonCatalog"),u=e("./IonDecimal"),l=e("./IonLocalSymbolTable"),_=e("./IonParserTextRaw"),h=e("./IonSymbols"),c=e("./IonType"),f=e("./IonTypes"),d=e("./IonTimestamp"),p=e("./IonText"),y=e("./JsbiSupport"),v=s(e("./IntSize")),g=(new c.IonType(-1,"raw_input",!0,!1,!1,!1),function(){function r(e,t){if((0,n.default)(this,r),!e)throw new Error("a source Span is required to make a reader");this._parser=new _.ParserTextRaw(e),this._depth=0,this._cat=t||new o.Catalog,this._symtab=l.defaultLocalSymbolTable(),this._type=null,this._raw_type=void 0,this._raw=void 0}return(0,a.default)(r,[{key:"load_raw",value:function(){var e=this;void 0===e._raw&&(14===e._raw_type||15===e._raw_type?e._raw=e._parser.get_value_as_uint8array(e._raw_type):e._raw=e._parser.get_value_as_string(e._raw_type))}},{key:"skip_past_container",value:function(){var e,t=this.depth();for(this.stepIn();this.depth()>t;)null===(e=this.next())?this.stepOut():e.isContainer&&!this.isNull()&&this.stepIn()}},{key:"isIVM",value:function(e,t,r){if(0<t)return!1;var i="$ion_1_0";if(e.length<i.length||0<r.length)return!1;for(var n=0;n<"$ion_".length;){if("$ion_".charAt(n)!==e.charAt(n))return!1;n++}for(;n<e.length&&"_"!=e.charAt(n);){var a=e.charAt(n);if(a<"0"||"9"<a)return!1;n++}for(n++;n<e.length;){var s=e.charAt(n);if(s<"0"||"9"<s)return!1;n++}if(e!==i)throw new Error("Only Ion version 1.0 is supported.");return!0}},{key:"isLikeIVM",value:function(){return!1}},{key:"next",value:function(){if(this._raw=void 0,-1===this._raw_type)return null;-2!==this._raw_type&&!this.isNull()&&this._type&&this._type.isContainer&&this.skip_past_container();for(var e=this._parser;;)if(this._raw_type=e.next(),9===this._raw_type){if(0<this._depth)break;if(this.load_raw(),!this.isIVM(this._raw,this.depth(),this.annotations()))break;this._symtab=l.defaultLocalSymbolTable(),this._raw=void 0,this._raw_type=void 0}else if(11===this._raw_type){if(0<this._depth)break;if(this.load_raw(),"$ion_1_0"!==this._raw)break;this._raw=void 0,this._raw_type=void 0}else{if(19!==this._raw_type)break;if(1!==e.annotations().length)break;if(e.annotations()[0]!=h.ion_symbol_table)break;this._type=_.get_ion_type(this._raw_type),this._symtab=h.makeSymbolTable(this._cat,this),this._raw=void 0,this._raw_type=void 0}return this._type=_.get_ion_type(this._raw_type),this._type}},{key:"stepIn",value:function(){if(!this._type.isContainer)throw new Error("can't step in to a scalar value");if(this.isNull())throw new Error("Can't step into a null container");this._parser.clearFieldName(),this._type=null,this._raw_type=-2,this._depth++}},{key:"stepOut",value:function(){for(this._parser.clearFieldName();-1!=this._raw_type;)this.next();this._raw_type=void 0,this._depth--}},{key:"type",value:function(){return this._type}},{key:"depth",value:function(){return this._depth}},{key:"fieldName",value:function(){var e=this._parser.fieldName();if(9===this._parser.fieldNameType()&&1<e.length&&e.charAt(0)==="$".charAt(0)){var t=e.substr(1,e.length);if(+t==+t){var r=this._symtab.getSymbolText(Number(t));if(void 0===r)throw new Error("Unresolveable symbol ID, symboltokens unsupported.");return r}}return e}},{key:"annotations",value:function(){return this._parser.annotations()}},{key:"isNull",value:function(){return this._type===f.IonTypes.NULL||this._parser.isNull()}},{key:"_stringRepresentation",value:function(){if(this.load_raw(),this.isNull())return this._type===f.IonTypes.NULL?"null":"null."+this._type.name;if(!this._type.isScalar)throw new Error("Cannot create string representation of non-scalar values.");switch(this._type){case f.IonTypes.BLOB:return this._raw;case f.IonTypes.SYMBOL:if(9===this._raw_type&&1<this._raw.length&&this._raw.charAt(0)==="$".charAt(0)){var e=this._raw.substr(1,this._raw.length);if(+e==+e){var t=this._symtab.getSymbolText(Number(e));if(void 0===t)throw new Error("Unresolvable symbol ID, symboltokens unsupported.");return t}}return this._raw;default:return this._raw}}},{key:"booleanValue",value:function(){switch(this._type){case f.IonTypes.NULL:return null;case f.IonTypes.BOOL:return this._parser.booleanValue()}throw new Error("Current value is not a Boolean.")}},{key:"byteValue",value:function(){switch(this.load_raw(),this._type){case f.IonTypes.NULL:return null;case f.IonTypes.BLOB:return this.isNull()?null:p.fromBase64(this._raw);case f.IonTypes.CLOB:return this.isNull()?null:this._raw}throw new Error("Current value is not a blob or clob.")}},{key:"decimalValue",value:function(){switch(this._type){case f.IonTypes.NULL:return null;case f.IonTypes.DECIMAL:return u.Decimal.parse(this._stringRepresentation())}throw new Error("Current value is not a decimal.")}},{key:"bigIntValue",value:function(){switch(this._type){case f.IonTypes.NULL:return null;case f.IonTypes.INT:return this._parser.bigIntValue()}throw new Error("bigIntValue() was called when the current value was a(n) "+this._type.name)}},{key:"intSize",value:function(){return y.JsbiSupport.isSafeInteger(this.bigIntValue())?v.default.Number:v.default.BigInt}},{key:"numberValue",value:function(){switch(this._type){case f.IonTypes.NULL:return null;case f.IonTypes.FLOAT:case f.IonTypes.INT:return this._parser.numberValue()}throw new Error("Current value is not a float or int.")}},{key:"stringValue",value:function(){switch(this.load_raw(),this._type){case f.IonTypes.NULL:return null;case f.IonTypes.STRING:return this._parser.isNull()?null:this._raw;case f.IonTypes.SYMBOL:if(this._parser.isNull())return null;if(9===this._raw_type&&1<this._raw.length&&this._raw.charAt(0)==="$".charAt(0)){var e=this._raw.substr(1,this._raw.length);if(+e==+e){var t=Number(e),r=this._symtab.getSymbolText(t);if(void 0===r)throw new Error("Unresolvable symbol ID, symboltokens unsupported.");return r}}return this._raw}throw new Error("Current value is not a string or symbol.")}},{key:"timestampValue",value:function(){switch(this._type){case f.IonTypes.NULL:return null;case f.IonTypes.TIMESTAMP:return d.Timestamp.parse(this._stringRepresentation())}throw new Error("Current value is not a timestamp.")}},{key:"value",value:function(){if(this._type&&this._type.isContainer){if(this.isNull())return null;throw new Error("Unable to provide a value for "+this._type.name+" containers.")}switch(this._type){case f.IonTypes.NULL:return null;case f.IonTypes.BLOB:case f.IonTypes.CLOB:return this.byteValue();case f.IonTypes.BOOL:return this.booleanValue();case f.IonTypes.DECIMAL:return this.decimalValue();case f.IonTypes.INT:return this.bigIntValue();case f.IonTypes.FLOAT:return this.numberValue();case f.IonTypes.STRING:case f.IonTypes.SYMBOL:return this.stringValue();case f.IonTypes.TIMESTAMP:return this.timestampValue();default:throw new Error("There is no current value.")}}}]),r}());r.TextReader=g},{"./IntSize":2,"./IonCatalog":7,"./IonDecimal":9,"./IonLocalSymbolTable":11,"./IonParserTextRaw":14,"./IonSymbols":19,"./IonText":21,"./IonTimestamp":24,"./IonType":25,"./IonTypes":26,"./JsbiSupport":30,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],23:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/createClass")),a=i(e("@babel/runtime/helpers/possibleConstructorReturn")),s=i(e("@babel/runtime/helpers/getPrototypeOf")),o=i(e("@babel/runtime/helpers/assertThisInitialized")),u=i(e("@babel/runtime/helpers/inherits")),l=i(e("@babel/runtime/helpers/classCallCheck"));Object.defineProperty(r,"__esModule",{value:!0});var _,h,c=e("./AbstractWriter"),f=e("./IonUnicode"),d=e("./IonText"),p=e("./IonTypes"),y=e("./util"),v=e("./JsbiSupport");(h=_=r.State||(r.State={}))[h.VALUE=0]="VALUE",h[h.STRUCT_FIELD=1]="STRUCT_FIELD";function g(e){(0,l.default)(this,g),this.state=e===p.IonTypes.STRUCT?_.STRUCT_FIELD:_.VALUE,this.clean=!0,this.containerType=e}r.Context=g;var b=function(e){function r(e){var t;return(0,l.default)(this,r),(t=(0,a.default)(this,(0,s.default)(r).call(this))).writeable=e,t._floatSerializer=function(e){r._serializeFloat((0,o.default)(t),e)},t.containerContext=[new g(void 0)],t}return(0,u.default)(r,e),(0,n.default)(r,[{key:"getBytes",value:function(){return this.writeable.getBytes()}},{key:"writeBlob",value:function(e){var t=this;this._serializeValue(p.IonTypes.BLOB,e,function(e){t.writeable.writeBytes(f.encodeUtf8("{{"+d.toBase64(e)+"}}"))})}},{key:"writeBoolean",value:function(e){var t=this;this._serializeValue(p.IonTypes.BOOL,e,function(e){t.writeUtf8(e?"true":"false")})}},{key:"writeClob",value:function(e){var o=this;this._serializeValue(p.IonTypes.CLOB,e,function(e){var t;o.writeUtf8('{{"');for(var r=0;r<e.length;r++){var i=e[r];if(127<i&&i<256){t="\\x"+i.toString(16);for(var n=0;n<t.length;n++)o.writeable.writeByte(t.charCodeAt(n))}else{var a=d.ClobEscapes[i];if(void 0===a)if(i<32){t="\\x"+i.toString(16);for(var s=0;s<t.length;s++)o.writeable.writeByte(t.charCodeAt(s))}else o.writeable.writeByte(i);else o.writeable.writeBytes(new Uint8Array(a))}}o.writeUtf8('"}}')})}},{key:"writeDecimal",value:function(e){var n=this;this._serializeValue(p.IonTypes.DECIMAL,e,function(e){if(null===e)n.writeUtf8("null.decimal");else{var t="",r=e.getCoefficient();v.JsbiSupport.isZero(r)&&e.isNegative()&&(t+="-"),t+=r.toString()+"d";var i=e.getExponent();0===i&&-1===y._sign(i)&&(t+="-"),t+=i,n.writeUtf8(t)}})}},{key:"writeFieldName",value:function(e){if(this.currentContainer.containerType!==p.IonTypes.STRUCT)throw new Error("Cannot write field name outside of a struct");if(this.currentContainer.state!==_.STRUCT_FIELD)throw new Error("Expecting a struct value");this.currentContainer.clean||this.writeable.writeByte(d.CharCodes.COMMA),this.writeSymbolToken(e),this.writeable.writeByte(d.CharCodes.COLON),this.currentContainer.state=_.VALUE}},{key:"writeFloat32",value:function(e){this._writeFloat(e)}},{key:"writeFloat64",value:function(e){this._writeFloat(e)}},{key:"writeInt",value:function(e){var t=this;this._serializeValue(p.IonTypes.INT,e,function(e){t.writeUtf8(e.toString(10))})}},{key:"writeNull",value:function(e){if(null==e||e.binaryTypeId<0||13<e.binaryTypeId)throw new Error("Cannot write null for type ".concat(e));this.handleSeparator(),this.writeAnnotations(),this.writeUtf8("null."+e.name),this.currentContainer.containerType===p.IonTypes.STRUCT&&(this.currentContainer.state=_.STRUCT_FIELD)}},{key:"writeString",value:function(e){var t=this;this._serializeValue(p.IonTypes.STRING,e,function(e){t.writeable.writeBytes(f.encodeUtf8('"'+d.escape(e,d.StringEscapes)+'"'))})}},{key:"writeSymbol",value:function(e){var t=this;this._serializeValue(p.IonTypes.SYMBOL,e,function(e){t.writeSymbolToken(e)})}},{key:"writeTimestamp",value:function(e){var t=this;this._serializeValue(p.IonTypes.TIMESTAMP,e,function(e){t.writeUtf8(e.toString())})}},{key:"stepIn",value:function(e){if(this.currentContainer.state===_.STRUCT_FIELD)throw new Error("Started writing a ".concat(this.currentContainer.containerType.name," inside a struct without writing the field name first. Call writeFieldName(string) with the desired name before calling stepIn(").concat(this.currentContainer.containerType.name,")."));switch(e){case p.IonTypes.LIST:this.writeContainer(e,d.CharCodes.LEFT_BRACKET);break;case p.IonTypes.SEXP:this.writeContainer(e,d.CharCodes.LEFT_PARENTHESIS);break;case p.IonTypes.STRUCT:if(void 0!==this._annotations&&"$ion_symbol_table"===this._annotations[0]&&0===this.depth())throw new Error("Unable to alter symbol table context, it allows invalid ion to be written.");this.writeContainer(e,d.CharCodes.LEFT_BRACE);break;default:throw new Error("Unrecognized container type")}}},{key:"stepOut",value:function(){var e=this.containerContext.pop();if(!e||!e.containerType)throw new Error("Can't step out when not in a container");if(e.containerType===p.IonTypes.STRUCT&&e.state===_.VALUE)throw new Error("Expecting a struct value");switch(e.containerType){case p.IonTypes.LIST:this.writeable.writeByte(d.CharCodes.RIGHT_BRACKET);break;case p.IonTypes.SEXP:this.writeable.writeByte(d.CharCodes.RIGHT_PARENTHESIS);break;case p.IonTypes.STRUCT:this.writeable.writeByte(d.CharCodes.RIGHT_BRACE);break;default:throw new Error("Unexpected container TypeCode")}}},{key:"close",value:function(){if(0<this.depth())throw new Error("Writer has one or more open containers; call stepOut() for each container prior to close()")}},{key:"depth",value:function(){return this.containerContext.length-1}},{key:"_serializeValue",value:function(e,t,r){if(this.currentContainer.state===_.STRUCT_FIELD)throw new Error("Expecting a struct field");null!=t?(this.handleSeparator(),this.writeAnnotations(),r(t),this.currentContainer.containerType===p.IonTypes.STRUCT&&(this.currentContainer.state=_.STRUCT_FIELD)):this.writeNull(e)}},{key:"writeContainer",value:function(e,t){this.currentContainer.containerType===p.IonTypes.STRUCT&&this.currentContainer.state===_.VALUE&&(this.currentContainer.state=_.STRUCT_FIELD),this.handleSeparator(),this.writeAnnotations(),this.writeable.writeByte(t),this._stepIn(e)}},{key:"handleSeparator",value:function(){if(0===this.depth())this.currentContainer.clean?this.currentContainer.clean=!1:this.writeable.writeByte(d.CharCodes.LINE_FEED);else if(this.currentContainer.clean)this.currentContainer.clean=!1;else switch(this.currentContainer.containerType){case p.IonTypes.LIST:this.writeable.writeByte(d.CharCodes.COMMA);break;case p.IonTypes.SEXP:this.writeable.writeByte(d.CharCodes.SPACE)}}},{key:"writeUtf8",value:function(e){this.writeable.writeBytes(f.encodeUtf8(e))}},{key:"writeAnnotations",value:function(){var e=!0,t=!1,r=void 0;try{for(var i,n=this._annotations[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){var a=i.value;this.writeSymbolToken(a),this.writeUtf8("::")}}catch(e){t=!0,r=e}finally{try{e||null==n.return||n.return()}finally{if(t)throw r}}this._clearAnnotations()}},{key:"_stepIn",value:function(e){this.containerContext.push(new g(e))}},{key:"writeSymbolToken",value:function(e){0===e.length||d.is_keyword(e)||this.isSid(e)||!d.isIdentifier(e)&&!d.isOperator(e)||d.isOperator(e)&&this.currentContainer.containerType!=p.IonTypes.SEXP?this.writeable.writeBytes(f.encodeUtf8("'"+d.escape(e,d.SymbolEscapes)+"'")):this.writeUtf8(e)}},{key:"_writeFloat",value:function(e){this._serializeValue(p.IonTypes.FLOAT,e,this._floatSerializer)}},{key:"isSid",value:function(e){if(1<e.length&&e.charAt(0)==="$".charAt(0)){var t=e.substr(1,e.length);return+t==+t}return!1}},{key:"isTopLevel",get:function(){return 0===this.depth()}},{key:"currentContainer",get:function(){return this.containerContext[this.depth()]}}],[{key:"_serializeFloat",value:function(e,t){var r;if(t===Number.POSITIVE_INFINITY)r="+inf";else if(t===Number.NEGATIVE_INFINITY)r="-inf";else if(Object.is(t,Number.NaN))r="nan";else if(Object.is(t,-0))r="-0e0";else{var i=(r=t.toExponential()).lastIndexOf("+");-1<i&&(r=r.slice(0,i)+r.slice(i+1))}e.writeUtf8(r)}}]),r}(c.AbstractWriter);r.TextWriter=b},{"./AbstractWriter":1,"./IonText":21,"./IonTypes":26,"./IonUnicode":27,"./JsbiSupport":30,"./util":32,"@babel/runtime/helpers/assertThisInitialized":34,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/getPrototypeOf":40,"@babel/runtime/helpers/inherits":41,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/possibleConstructorReturn":45}],24:[function(e,t,r){"use strict";var i,n=e("@babel/runtime/helpers/interopRequireDefault"),a=n(e("@babel/runtime/helpers/defineProperty")),_=n(e("@babel/runtime/helpers/slicedToArray")),h=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var c,o,g=e("./IonDecimal"),u=e("./IonText"),f=e("./util");(o=c=r.TimestampPrecision||(r.TimestampPrecision={}))[o.YEAR=1]="YEAR",o[o.MONTH=2]="MONTH",o[o.DAY=3]="DAY",o[o.HOUR_AND_MINUTE=4]="HOUR_AND_MINUTE",o[o.SECONDS=5]="SECONDS";var b,l,m=function(){function l(e,t,r,i,n,a,s){if((0,h.default)(this,l),this._localOffset=e,this._year=t,this._precision=c.YEAR,this._checkRequiredField("Offset",this._localOffset,l._MIN_OFFSET,l._MAX_OFFSET),this._checkRequiredField("Year",this._year,l._MIN_YEAR,l._MAX_YEAR),this._month=this._checkOptionalField("Month",r,l._MIN_MONTH,l._MAX_MONTH,1,c.MONTH),this._day=this._checkOptionalField("Day",i,l._MIN_DAY,l._MAX_DAY,1,c.DAY),this._hour=this._checkOptionalField("Hour",n,l._MIN_HOUR,l._MAX_HOUR,0,c.HOUR_AND_MINUTE),this._minutes=this._checkOptionalField("Minutes",a,l._MIN_MINUTE,l._MAX_MINUTE,0,c.HOUR_AND_MINUTE),"number"==typeof s){if(!Number.isInteger(s))throw new Error("The provided seconds number was not an integer ("+s+")");this._secondsDecimal=new g.Decimal(s,0)}else this._secondsDecimal=s;if(null===this._secondsDecimal||void 0===this._secondsDecimal?this._secondsDecimal=g.Decimal.ZERO:(this._checkFieldRange("Seconds",this._secondsDecimal,l._MIN_SECONDS,l._MAX_SECONDS),this._precision=c.SECONDS),this._precision<=c.DAY&&(this._localOffset=-0),this._precision>c.MONTH){var o=new Date(this._year,this._month,0);if(o.setUTCFullYear(this._year),this._day>o.getDate())throw new Error("Month ".concat(this._month," has less than ").concat(this._day," days"));if(2===this._month&&29===this._day&&!this._isLeapYear(this._year))throw new Error("Given February 29th but year ".concat(this._year," is not a leap year"))}var u=this.getDate().getUTCFullYear();this._checkFieldRange("Year",u,l._MIN_YEAR,l._MAX_YEAR)}return(0,s.default)(l,[{key:"getLocalOffset",value:function(){return this._localOffset}},{key:"getPrecision",value:function(){return this._precision}},{key:"getDate",value:function(){var e=null;this._precision===c.SECONDS&&(e=Math.round(1e3*(this._secondsDecimal.numberValue()-this.getSecondsInt())));var t=Date.UTC(this._year,this._precision===c.YEAR?0:this._month-1,this._day,this._hour,this._minutes,this.getSecondsInt(),e);t=l._adjustMsSinceEpochIfNeeded(this._year,t);var r=60*this._localOffset*1e3;return new Date(t-r)}},{key:"getSecondsInt",value:function(){return this._secondsDecimal.intValue()}},{key:"getSecondsDecimal",value:function(){return this._secondsDecimal}},{key:"_getFractionalSeconds",value:function(){var e=l._splitSecondsDecimal(this._secondsDecimal),t=(0,_.default)(e,2),r=(t[0],t[1]);return""===r?g.Decimal.ZERO:g.Decimal.parse(r+"d-"+r.length)}},{key:"equals",value:function(e){return this.getPrecision()===e.getPrecision()&&this.getLocalOffset()===e.getLocalOffset()&&f._sign(this.getLocalOffset())===f._sign(e.getLocalOffset())&&0===this.compareTo(e)&&this._secondsDecimal.equals(e._secondsDecimal)}},{key:"compareTo",value:function(e){var t=this.getDate().getTime(),r=e.getDate().getTime();return t===r?this.getSecondsDecimal().compareTo(e.getSecondsDecimal()):t<r?-1:1}},{key:"toString",value:function(){var e="";switch(this._precision){default:throw new Error("unrecognized timestamp precision "+this._precision);case c.SECONDS:var t=l._splitSecondsDecimal(this._secondsDecimal),r=(0,_.default)(t,2),i=r[0],n=r[1];e=this._lpadZeros(i,2),0<n.length&&(e+="."+n);case c.HOUR_AND_MINUTE:e=this._lpadZeros(this._minutes,2)+(e?":"+e:""),e=this._lpadZeros(this._hour,2)+(e?":"+e:"");case c.DAY:e=this._lpadZeros(this._day,2)+(e?"T"+e:"T");case c.MONTH:e=this._lpadZeros(this._month,2)+(e?"-"+e:"");case c.YEAR:e=this._precision===c.YEAR?this._lpadZeros(this._year,4)+"T":this._precision===c.MONTH?this._lpadZeros(this._year,4)+"-"+e+"T":this._lpadZeros(this._year,4)+"-"+e}var a=this._localOffset;return this._precision>c.DAY&&(0===a&&1===f._sign(a)?e+="Z":e+=(-1===f._sign(a)?"-":"+")+this._lpadZeros(Math.floor(Math.abs(a)/60),2)+":"+this._lpadZeros(Math.abs(a)%60,2)),e}},{key:"_checkRequiredField",value:function(e,t,r,i){if(!f._hasValue(t))throw new Error("".concat(e," cannot be ").concat(t));this._checkFieldRange(e,t,r,i)}},{key:"_checkOptionalField",value:function(e,t,r,i,n,a){return f._hasValue(t)?(this._checkFieldRange(e,t,r,i),this._precision=a,t):n}},{key:"_checkFieldRange",value:function(e,t,r,i){if(t instanceof g.Decimal){if(f._hasValue(t)&&(t.compareTo(r)<0||0<=t.compareTo(i)))throw new Error("".concat(e," ").concat(t," must be between ").concat(r," inclusive, and ").concat(i," exclusive"))}else{if(!Number.isInteger(t))throw new Error("".concat(e," ").concat(t," must be an integer"));if(t<r||i<t)throw new Error("".concat(e," ").concat(t," must be between ").concat(r," and ").concat(i," inclusive"))}}},{key:"_isLeapYear",value:function(e){return e%4==0&&(e%400==0||(e%100!=0||e<1600))}},{key:"_lpadZeros",value:function(e,t){var r=e.toString();if(r.length<=t)return"0".repeat(t-r.length)+r;throw new Error("Unable to fit '"+r+"' into "+t+" characters")}}],[{key:"parse",value:function(e){return p._parse(e)}},{key:"_adjustMsSinceEpochIfNeeded",value:function(e,t){if(100<=e)return t;var r=new Date(t);return r.setUTCFullYear(e),r.getTime()}},{key:"_splitSecondsDecimal",value:function(e){var t=e.getCoefficient().toString(),r=e.getExponent(),i="",n="";if(r<0){var a=Math.max(t.length+r,0);i=t.substr(0,a),n=t.substr(a),0<-e.getExponent()-t.length&&(n="0".repeat(-r-t.length)+n)}else i=0<r?t+"0".repeat(r):t;return[i,n]}},{key:"_valueOf",value:function(e,t,r,i){var n,a=e.getTime()+60*t*1e3;if(e=new Date(a),null!=r){var s=l._splitSecondsDecimal(r),o=(0,_.default)(s,2),u=(o[0],o[1]);n=g.Decimal.parse(e.getUTCSeconds()+"."+u)}else n=g.Decimal.parse(e.getUTCSeconds()+"."+e.getUTCMilliseconds());switch(i){case c.YEAR:return new l(t,e.getUTCFullYear());case c.MONTH:return new l(t,e.getUTCFullYear(),e.getUTCMonth()+1);case c.DAY:return new l(t,e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate());case c.HOUR_AND_MINUTE:return new l(t,e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes());case c.SECONDS:default:return new l(t,e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),n)}}}]),l}();(r.Timestamp=m)._MIN_SECONDS=g.Decimal.ZERO,m._MAX_SECONDS=g.Decimal.parse("60"),m._MIN_MINUTE=0,m._MAX_MINUTE=59,m._MIN_HOUR=0,m._MAX_HOUR=23,m._MIN_DAY=1,m._MAX_DAY=31,m._MIN_MONTH=1,m._MAX_MONTH=12,m._MIN_YEAR=1,m._MAX_YEAR=9999,m._MIN_OFFSET=-1439,m._MAX_OFFSET=1439,(l=b=b||{})[l.YEAR=0]="YEAR",l[l.MONTH=1]="MONTH",l[l.DAY=2]="DAY",l[l.HOUR=3]="HOUR",l[l.MINUTE=4]="MINUTE",l[l.SECONDS=5]="SECONDS",l[l.FRACTIONAL_SECONDS=6]="FRACTIONAL_SECONDS",l[l.OFFSET_POSITIVE=7]="OFFSET_POSITIVE",l[l.OFFSET_NEGATIVE=8]="OFFSET_NEGATIVE",l[l.OFFSET_MINUTES=9]="OFFSET_MINUTES",l[l.OFFSET_ZULU=10]="OFFSET_ZULU",l[l.OFFSET_UNKNOWN=11]="OFFSET_UNKNOWN";function d(e,t,r){(0,h.default)(this,d),this.f=e,this.len=t,this.t=r}var p=function(){function v(){(0,h.default)(this,v)}return(0,s.default)(v,null,[{key:"_parse",value:function(e){if(e.length<1)return null;if(110===e.charCodeAt(0)){if("null"===e||"null.timestamp"===e)return null;throw new Error("Illegal timestamp: "+e)}for(var t,r,i,n,a,s,o,u,l,_=0,h="",c=0,f=v._timeParserStates[b.YEAR],d=e.length;c<d;){if(void 0===f.len){var p=v._readUnknownDigits(e,c);if(0===p.length)throw new Error("No digits found at pos: "+c);u=parseInt(p,10),c+=p.length}else if(0<f.len){if((u=v._readDigits(e,c,f.len))<0)throw new Error("Non digit value found at pos "+c);c+=f.len}switch(f.f){case b.YEAR:_=u;break;case b.MONTH:i=u;break;case b.DAY:n=u;break;case b.HOUR:a=u;break;case b.MINUTE:s=u;break;case b.SECONDS:o=u;break;case b.FRACTIONAL_SECONDS:h=e.substring(20,c);break;case b.OFFSET_POSITIVE:t=1,r=60*u;break;case b.OFFSET_NEGATIVE:t=-1,r=60*u;break;case b.OFFSET_MINUTES:if(r+=u,60<=u)throw new Error("Minute offset "+String(u)+" above maximum or equal to : 60");break;case b.OFFSET_ZULU:t=1,r=0;break;case b.OFFSET_UNKNOWN:r=-0;break;default:throw new Error("invalid internal state")}if(d<=c)break;if(void 0!==f.t){var y=String.fromCharCode(e.charCodeAt(c));if(void 0===(f=v._timeParserStates[f.t[y]]))throw new Error("State was not set pos:"+c);f.f===b.OFFSET_ZULU&&(t=1,r=0)}c++}if(void 0===r){if(void 0!==s)throw new Error('invalid timestamp, missing local offset: "'+e+'"');r=-0}else r*=t;return null==o&&!h||(l=g.Decimal.parse(o+"."+(h||""))),new m(r,_,i,n,a,s,l)}},{key:"_readUnknownDigits",value:function(e,t){for(var r=t;r<e.length&&u.isDigit(e.charCodeAt(r));r++);return e.substring(t,r)}},{key:"_readDigits",value:function(e,t,r){for(var i=0,n=t;n<t+r;n++){var a=e.charCodeAt(n)-48;if(a<0&&9<a)return-1;i=10*i+a}return i}}]),v}();p._timeParserStates=(i={},(0,a.default)(i,b.YEAR,new d(b.YEAR,4,{T:b.OFFSET_UNKNOWN,"-":b.MONTH})),(0,a.default)(i,b.MONTH,new d(b.MONTH,2,{T:b.OFFSET_UNKNOWN,"-":b.DAY})),(0,a.default)(i,b.DAY,new d(b.DAY,2,{T:b.HOUR})),(0,a.default)(i,b.HOUR,new d(b.HOUR,2,{":":b.MINUTE})),(0,a.default)(i,b.MINUTE,new d(b.MINUTE,2,{":":b.SECONDS,"+":b.OFFSET_POSITIVE,"-":b.OFFSET_NEGATIVE,Z:b.OFFSET_ZULU})),(0,a.default)(i,b.SECONDS,new d(b.SECONDS,2,{".":b.FRACTIONAL_SECONDS,"+":b.OFFSET_POSITIVE,"-":b.OFFSET_NEGATIVE,Z:b.OFFSET_ZULU})),(0,a.default)(i,b.FRACTIONAL_SECONDS,new d(b.FRACTIONAL_SECONDS,void 0,{"+":b.OFFSET_POSITIVE,"-":b.OFFSET_NEGATIVE,Z:b.OFFSET_ZULU})),(0,a.default)(i,b.OFFSET_POSITIVE,new d(b.OFFSET_POSITIVE,2,{":":b.OFFSET_MINUTES})),(0,a.default)(i,b.OFFSET_NEGATIVE,new d(b.OFFSET_NEGATIVE,2,{":":b.OFFSET_MINUTES})),(0,a.default)(i,b.OFFSET_MINUTES,new d(b.OFFSET_MINUTES,2,void 0)),(0,a.default)(i,b.OFFSET_ZULU,new d(b.OFFSET_ZULU,0,void 0)),(0,a.default)(i,b.OFFSET_UNKNOWN,new d(b.OFFSET_UNKNOWN,0,void 0)),i)},{"./IonDecimal":9,"./IonText":21,"./util":32,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/defineProperty":37,"@babel/runtime/helpers/interopRequireDefault":42,"@babel/runtime/helpers/slicedToArray":47}],25:[function(e,t,r){"use strict";var o=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/classCallCheck"));Object.defineProperty(r,"__esModule",{value:!0});r.IonType=function e(t,r,i,n,a,s){(0,o.default)(this,e),this.binaryTypeId=t,this.name=r,this.isScalar=i,this.isLob=n,this.isNumeric=a,this.isContainer=s}},{"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/interopRequireDefault":42}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./IonType");r.IonTypes={NULL:new i.IonType(0,"null",!0,!1,!1,!1),BOOL:new i.IonType(1,"bool",!0,!1,!1,!1),INT:new i.IonType(2,"int",!0,!1,!0,!1),FLOAT:new i.IonType(4,"float",!0,!1,!0,!1),DECIMAL:new i.IonType(5,"decimal",!0,!1,!1,!1),TIMESTAMP:new i.IonType(6,"timestamp",!0,!1,!1,!1),SYMBOL:new i.IonType(7,"symbol",!0,!1,!1,!1),STRING:new i.IonType(8,"string",!0,!1,!1,!1),CLOB:new i.IonType(9,"clob",!0,!0,!1,!1),BLOB:new i.IonType(10,"blob",!0,!0,!1,!1),LIST:new i.IonType(11,"list",!1,!1,!1,!0),SEXP:new i.IonType(12,"sexp",!1,!1,!1,!0),STRUCT:new i.IonType(13,"struct",!1,!1,!1,!0)}},{"./IonType":25}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.encodeUtf8=function(e){for(var t,r=0,i=new Uint8Array(4*e.length),n=0;n<e.length;n++)if((t=e.charCodeAt(n))<128)i[r++]=t;else{if(t<2048)i[r++]=t>>6|192;else{if(55295<t&&t<56320){if(++n>=e.length)throw new Error("UTF-8 encode: incomplete surrogate pair");var a=e.charCodeAt(n);if(a<56320||57343<a)throw new Error("UTF-8 encode: second surrogate character 0x"+a.toString(16)+" at index "+n+" out of range");t=65536+((1023&t)<<10)+(1023&a),i[r++]=t>>18|240,i[r++]=t>>12&63|128}else i[r++]=t>>12|224;i[r++]=t>>6&63|128}i[r++]=63&t|128}return i.subarray(0,r)},r.decodeUtf8=function(e){for(var t,r=0,i="";r<e.length;){if(127<(t=e[r++]))if(191<t&&t<224){if(r>=e.length)throw new Error("UTF-8 decode: incomplete 2-byte sequence");t=(31&t)<<6|63&e[r++]}else if(223<t&&t<240){if(r+1>=e.length)throw new Error("UTF-8 decode: incomplete 3-byte sequence");t=(15&t)<<12|(63&e[r++])<<6|63&e[r++]}else{if(!(239<t&&t<248))throw new Error("UTF-8 decode: unknown multibyte start 0x"+t.toString(16)+" at index "+(r-1));if(r+2>=e.length)throw new Error("UTF-8 decode: incomplete 4-byte sequence");t=(7&t)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++]}if(t<=65535)i+=String.fromCharCode(t);else{if(!(t<=1114111))throw new Error("UTF-8 decode: code point 0x"+t.toString(16)+" exceeds UTF-16 reach");t-=65536,i+=String.fromCharCode(t>>10|55296),i+=String.fromCharCode(1023&t|56320)}}return i}},{}],28:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass"));Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(e){(0,n.default)(this,t),this.bufferSize=e||4096,this.buffers=[new Uint8Array(this.bufferSize)],this.index=0,this.clean=!1}return(0,a.default)(t,[{key:"writeByte",value:function(e){this.clean=!1,this.currentBuffer[this.index]=e,this.index++,this.index===this.bufferSize&&(this.buffers.push(new Uint8Array(this.bufferSize)),this.index=0)}},{key:"writeBytes",value:function(e,t,r){void 0===t&&(t=0);var i=void 0!==r?Math.min(e.length-t,r):e.length-t;i<this.currentBuffer.length-this.index-1?(this.currentBuffer.set(e.subarray(t,t+i),this.index),this.index+=i):(this.buffers[this.buffers.length-1]=this.currentBuffer.slice(0,this.index),this.buffers.push(e.subarray(t,r)),this.buffers.push(new Uint8Array(this.bufferSize)),this.clean=!1,this.index=0)}},{key:"getBytes",value:function(){if(this.clean)return this.buffers[0];for(var e=new Uint8Array(this.totalSize),t=0,r=0;r<this.buffers.length-1;r++)e.set(this.buffers[r],t),t+=this.buffers[r].length;return e.set(this.currentBuffer.subarray(0,this.index),t),this.buffers=[e,new Uint8Array(this.bufferSize)],this.index=0,this.clean=!0,e}},{key:"currentBuffer",get:function(){return this.buffers[this.buffers.length-1]}},{key:"totalSize",get:function(){for(var e=0,t=0;t<this.buffers.length-1;t++)e+=this.buffers[t].length;return e+this.index}}]),t}();r.Writeable=s},{"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42}],29:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=s(e("jsbi")),u=e("./JsbiSupport"),l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"toSignedIntBytes",value:function(e,t){var r=this.toUnsignedIntBytes(e);if(128<=r[0]){var i=new Uint8Array(r.length+1);i.set(r,1),r=i}return t&&(r[0]+=128),r}},{key:"fromUnsignedBytes",value:function(e){for(var t=u.JsbiSupport.ZERO,r=0;r<e.length;r++){var i=o.default.BigInt(e[r]);t=o.default.leftShift(t,this.BITS_PER_BYTE),t=o.default.bitwiseOr(t,i)}return t}},{key:"toUnsignedIntBytes",value:function(e){u.JsbiSupport.isNegative(e)&&(e=o.default.unaryMinus(e));for(var t=this.getUnsignedIntSizeInBytes(e),r=new Uint8Array(t),i=t-1;0<=i;i--){var n=o.default.toNumber(o.default.bitwiseAnd(e,this.BYTE_MAX_VALUE));e=o.default.signedRightShift(e,this.BITS_PER_BYTE),r[i]=n}return r}},{key:"getUnsignedIntSizeInBytes",value:function(e){for(var t=0;t<this.SIZE_THRESHOLDS.length;t++){var r=this.SIZE_THRESHOLDS[t];if(o.default.lessThanOrEqual(e,r))return t+1}for(var i=this.SIZE_THRESHOLDS.length,n=this.calculateSizeThreshold(i);o.default.greaterThan(e,n);)i++,n=this.calculateSizeThreshold(i);return i}},{key:"calculateSizeThresholds",value:function(){for(var e=[],t=1;t<=this.SERIALIZED_JSBI_SIZES_TO_PRECOMPUTE;t++)e.push(this.calculateSizeThreshold(t));return e}},{key:"calculateSizeThreshold",value:function(e){var t=o.default.multiply(o.default.BigInt(e),this.BITS_PER_BYTE),r=o.default.exponentiate(u.JsbiSupport.TWO,t);return o.default.subtract(r,u.JsbiSupport.ONE)}}]),e}();(r.JsbiSerde=l).SERIALIZED_JSBI_SIZES_TO_PRECOMPUTE=64,l.BITS_PER_BYTE=o.default.BigInt(8),l.BYTE_MAX_VALUE=o.default.BigInt(255),l.SIZE_THRESHOLDS=l.calculateSizeThresholds()},{"./JsbiSupport":30,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42,jsbi:50}],30:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=s(e("jsbi")),u=function(){function t(){(0,n.default)(this,t)}return(0,a.default)(t,null,[{key:"isZero",value:function(e){return o.default.equal(e,t.ZERO)}},{key:"isNegative",value:function(e){return o.default.lessThan(e,t.ZERO)}},{key:"bigIntFromString",value:function(e){var t=!1,r=e.trimLeft();e.startsWith("-")&&(t=!0,r=e.substring(1));var i=o.default.BigInt(r);return t&&(i=o.default.unaryMinus(i)),i}},{key:"clampToSafeIntegerRange",value:function(e){return o.default.greaterThan(e,this.NUMBER_MAX_SAFE_INTEGER)?Number.MAX_SAFE_INTEGER:o.default.lessThan(e,this.NUMBER_MIN_SAFE_INTEGER)?Number.MIN_SAFE_INTEGER:o.default.toNumber(e)}},{key:"isSafeInteger",value:function(e){return o.default.greaterThanOrEqual(e,this.NUMBER_MIN_SAFE_INTEGER)&&o.default.lessThanOrEqual(e,this.NUMBER_MAX_SAFE_INTEGER)}}]),t}();(r.JsbiSupport=u).ZERO=o.default.BigInt(0),u.ONE=o.default.BigInt(1),u.TWO=o.default.BigInt(2),u.NUMBER_MAX_SAFE_INTEGER=o.default.BigInt(Number.MAX_SAFE_INTEGER),u.NUMBER_MIN_SAFE_INTEGER=o.default.BigInt(Number.MIN_SAFE_INTEGER)},{"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42,jsbi:50}],31:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/helpers/classCallCheck")),a=i(e("@babel/runtime/helpers/createClass")),s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=s(e("jsbi")),u=e("./JsbiSupport"),l=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:u.JsbiSupport.isNegative(e);(0,n.default)(this,i),this._magnitude=e,this._isNegative=t}return(0,a.default)(i,[{key:"equals",value:function(e){return o.default.equal(this._magnitude,e._magnitude)&&this._isNegative===e._isNegative}},{key:"magnitude",get:function(){return this._magnitude}},{key:"isNegative",get:function(){return this._isNegative}}],[{key:"fromNumber",value:function(e){var t=e<0||Object.is(e,-0),r=Math.abs(e);return new i(o.default.BigInt(r),t)}}]),i}();r.default=l},{"./JsbiSupport":30,"@babel/runtime/helpers/classCallCheck":35,"@babel/runtime/helpers/createClass":36,"@babel/runtime/helpers/interopRequireDefault":42,jsbi:50}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._sign=function(e){return e<0||0===e&&1/e==-1/0?-1:1},r._hasValue=function(e){return null!=e}},{}],33:[function(e,t,r){t.exports=function(e){if(Array.isArray(e))return e}},{}],34:[function(e,t,r){t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},{}],35:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],36:[function(e,t,r){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}t.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}},{}],37:[function(e,t,r){t.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},{}],38:[function(e,t,r){function i(){return t.exports=i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},i.apply(this,arguments)}t.exports=i},{}],39:[function(e,i,t){var a=e("./superPropBase");function n(e,t,r){return"undefined"!=typeof Reflect&&Reflect.get?i.exports=n=Reflect.get:i.exports=n=function(e,t,r){var i=a(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(r):n.value}},n(e,t,r||e)}i.exports=n},{"./superPropBase":48}],40:[function(e,t,r){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}t.exports=i},{}],41:[function(e,t,r){var i=e("./setPrototypeOf");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}},{"./setPrototypeOf":46}],42:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],43:[function(e,t,r){t.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw a}}return r}}},{}],44:[function(e,t,r){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},{}],45:[function(e,t,r){var i=e("../helpers/typeof"),n=e("./assertThisInitialized");t.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?n(e):t}},{"../helpers/typeof":49,"./assertThisInitialized":34}],46:[function(e,r,t){function i(e,t){return r.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}r.exports=i},{}],47:[function(e,t,r){var i=e("./arrayWithHoles"),n=e("./iterableToArrayLimit"),a=e("./nonIterableRest");t.exports=function(e,t){return i(e)||n(e,t)||a()}},{"./arrayWithHoles":33,"./iterableToArrayLimit":43,"./nonIterableRest":44}],48:[function(e,t,r){var i=e("./getPrototypeOf");t.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}},{"./getPrototypeOf":40}],49:[function(e,t,r){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return"function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?t.exports=n=function(e){return i(e)}:t.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},n(e)}t.exports=n},{}],50:[function(e,t,r){var i,n;i=this,n=function(){"use strict";function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e(e,t){for(var r,i=0;i<t.length;i++)(r=t[i]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(){return(n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&a(n,r.prototype),n}).apply(null,arguments)}function t(e){var r="function"==typeof Map?new Map:void 0;return(t=function(e){function t(){return n(e,arguments,i(this).constructor)}if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)})(e)}function s(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var r,o,l,_,h,c,I,b,f=(_=t(Array),h=Math.abs,c=Math.max,I=Math.imul,b=Math.clz32,function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(k,_),r=k,l=[{key:"BigInt",value:function(e){var t=Math.floor,r=Number.isFinite;if("number"==typeof e){if(0===e)return k.__zero();if((0|e)===e)return e<0?k.__oneDigit(-e,!0):k.__oneDigit(e,!1);if(!r(e)||t(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return k.__fromDouble(e)}if("string"==typeof e){var i=k.__fromString(e);if(null===i)throw new SyntaxError("Cannot convert "+e+" to a BigInt");return i}if("boolean"==typeof e)return!0===e?k.__oneDigit(1,!1):k.__zero();if("object"!==u(e))throw new TypeError("Cannot convert "+e+" to a BigInt");if(e.constructor===k)return e;var n=k.__toPrimitive(e);return k.BigInt(n)}},{key:"toNumber",value:function(e){var t=e.length;if(0===t)return 0;if(1===t){var r=e.__unsignedDigit(0);return e.sign?-r:r}var i=e.__digit(t-1),n=b(i),a=32*t-n;if(1024<a)return e.sign?-1/0:1/0;var s=a-1,o=i,u=t-1,l=n+1,_=32===l?0:o<<l;_>>>=12;var h=l-12,c=12<=l?0:o<<20+l,f=20+l;0<h&&0<u&&(u--,_|=(o=e.__digit(u))>>>32-h,c=o<<h,f=h),0<f&&0<u&&(u--,c|=(o=e.__digit(u))>>>32-f,f-=32);var d=k.__decideRounding(e,f,u,o);if((1===d||0===d&&1==(1&c))&&0==(c=c+1>>>0)&&0!=++_>>>20&&(_=0,1023<++s))return e.sign?-1/0:1/0;var p=e.sign?-2147483648:0;return s=s+1023<<20,k.__kBitConversionInts[1]=p|s|_,k.__kBitConversionInts[0]=c,k.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(e){if(0===e.length)return e;var t=e.__copy();return t.sign=!e.sign,t}},{key:"bitwiseNot",value:function(e){return e.sign?k.__absoluteSubOne(e).__trim():k.__absoluteAddOne(e,!0)}},{key:"exponentiate",value:function(e,t){if(t.sign)throw new RangeError("Exponent must be positive");if(0===t.length)return k.__oneDigit(1,!1);if(0===e.length)return e;if(1===e.length&&1===e.__digit(0))return e.sign&&0==(1&t.__digit(0))?k.unaryMinus(e):e;if(1<t.length)throw new RangeError("BigInt too big");var r=t.__unsignedDigit(0);if(1===r)return e;if(k.__kMaxLengthBits<=r)throw new RangeError("BigInt too big");if(1===e.length&&2===e.__digit(0)){var i=1+(r>>>5),n=new k(i,e.sign&&0!=(1&r));n.__initializeDigits();var a=1<<(31&r);return n.__setDigit(i-1,a),n}var s=null,o=e;for(0!=(1&r)&&(s=e),r>>=1;0!==r;r>>=1)o=k.multiply(o,o),0!=(1&r)&&(s=null===s?o:k.multiply(s,o));return s}},{key:"multiply",value:function(e,t){if(0===e.length)return e;if(0===t.length)return t;var r=e.length+t.length;32<=e.__clzmsd()+t.__clzmsd()&&r--;var i=new k(r,e.sign!==t.sign);i.__initializeDigits();for(var n=0;n<e.length;n++)k.__multiplyAccumulate(t,e.__digit(n),i,n);return i.__trim()}},{key:"divide",value:function(e,t){if(0===t.length)throw new RangeError("Division by zero");if(k.__absoluteCompare(e,t)<0)return k.__zero();var r,i=e.sign!==t.sign,n=t.__unsignedDigit(0);if(1===t.length&&n<=65535){if(1===n)return i===e.sign?e:k.unaryMinus(e);r=k.__absoluteDivSmall(e,n,null)}else r=k.__absoluteDivLarge(e,t,!0,!1);return r.sign=i,r.__trim()}},{key:"remainder",value:function(e,t){if(0===t.length)throw new RangeError("Division by zero");if(k.__absoluteCompare(e,t)<0)return e;var r=t.__unsignedDigit(0);if(1===t.length&&r<=65535){if(1===r)return k.__zero();var i=k.__absoluteModSmall(e,r);return 0===i?k.__zero():k.__oneDigit(i,e.sign)}var n=k.__absoluteDivLarge(e,t,!1,!0);return n.sign=e.sign,n.__trim()}},{key:"add",value:function(e,t){var r=e.sign;return r===t.sign?k.__absoluteAdd(e,t,r):0<=k.__absoluteCompare(e,t)?k.__absoluteSub(e,t,r):k.__absoluteSub(t,e,!r)}},{key:"subtract",value:function(e,t){var r=e.sign;return r===t.sign?0<=k.__absoluteCompare(e,t)?k.__absoluteSub(e,t,r):k.__absoluteSub(t,e,!r):k.__absoluteAdd(e,t,r)}},{key:"leftShift",value:function(e,t){return 0===t.length||0===e.length?e:t.sign?k.__rightShiftByAbsolute(e,t):k.__leftShiftByAbsolute(e,t)}},{key:"signedRightShift",value:function(e,t){return 0===t.length||0===e.length?e:t.sign?k.__leftShiftByAbsolute(e,t):k.__rightShiftByAbsolute(e,t)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(e,t){return k.__compareToBigInt(e,t)<0}},{key:"lessThanOrEqual",value:function(e,t){return k.__compareToBigInt(e,t)<=0}},{key:"greaterThan",value:function(e,t){return 0<k.__compareToBigInt(e,t)}},{key:"greaterThanOrEqual",value:function(e,t){return 0<=k.__compareToBigInt(e,t)}},{key:"equal",value:function(e,t){if(e.sign!==t.sign)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e.__digit(r)!==t.__digit(r))return!1;return!0}},{key:"notEqual",value:function(e,t){return!k.equal(e,t)}},{key:"bitwiseAnd",value:function(e,t){if(!e.sign&&!t.sign)return k.__absoluteAnd(e,t).__trim();if(e.sign&&t.sign){var r=c(e.length,t.length)+1,i=k.__absoluteSubOne(e,r),n=k.__absoluteSubOne(t);return i=k.__absoluteOr(i,n,i),k.__absoluteAddOne(i,!0,i).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}return k.__absoluteAndNot(e,k.__absoluteSubOne(t)).__trim()}},{key:"bitwiseXor",value:function(e,t){if(!e.sign&&!t.sign)return k.__absoluteXor(e,t).__trim();if(e.sign&&t.sign){var r=c(e.length,t.length),i=k.__absoluteSubOne(e,r),n=k.__absoluteSubOne(t);return k.__absoluteXor(i,n,i).__trim()}var a=c(e.length,t.length)+1;if(e.sign){var s=[t,e];e=s[0],t=s[1]}var o=k.__absoluteSubOne(t,a);return o=k.__absoluteXor(o,e,o),k.__absoluteAddOne(o,!0,o).__trim()}},{key:"bitwiseOr",value:function(e,t){var r=c(e.length,t.length);if(!e.sign&&!t.sign)return k.__absoluteOr(e,t).__trim();if(e.sign&&t.sign){var i=k.__absoluteSubOne(e,r),n=k.__absoluteSubOne(t);return i=k.__absoluteAnd(i,n,i),k.__absoluteAddOne(i,!0,i).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}var s=k.__absoluteSubOne(t,r);return s=k.__absoluteAndNot(s,e,s),k.__absoluteAddOne(s,!0,s).__trim()}},{key:"asIntN",value:function(e,t){if(0===t.length)return t;if(0===e)return k.__zero();if(k.__kMaxLengthBits<=e)return t;var r=e+31>>>5;if(t.length<r)return t;var i=t.__unsignedDigit(r-1),n=1<<(31&e-1);if(t.length===r&&i<n)return t;if((i&n)!=n)return k.__truncateToNBits(e,t);if(!t.sign)return k.__truncateAndSubFromPowerOfTwo(e,t,!0);if(0!=(i&n-1))return k.__truncateAndSubFromPowerOfTwo(e,t,!1);for(var a=r-2;0<=a;a--)if(0!==t.__digit(a))return k.__truncateAndSubFromPowerOfTwo(e,t,!1);return t.length===r&&i===n?t:k.__truncateToNBits(e,t)}},{key:"asUintN",value:function(e,t){if(0===t.length)return t;if(0===e)return k.__zero();if(t.sign){if(k.__kMaxLengthBits<e)throw new RangeError("BigInt too big");return k.__truncateAndSubFromPowerOfTwo(e,t,!1)}if(k.__kMaxLengthBits<=e)return t;var r=e+31>>>5;if(t.length<r)return t;var i=31&e;if(t.length==r){if(0==i)return t;if(0==t.__digit(r-1)>>>i)return t}return k.__truncateToNBits(e,t)}},{key:"ADD",value:function(e,t){if(e=k.__toPrimitive(e),t=k.__toPrimitive(t),"string"==typeof e)return"string"!=typeof t&&(t=t.toString()),e+t;if("string"==typeof t)return e.toString()+t;if(e=k.__toNumeric(e),t=k.__toNumeric(t),k.__isBigInt(e)&&k.__isBigInt(t))return k.add(e,t);if("number"==typeof e&&"number"==typeof t)return e+t;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(e,t){return k.__compare(e,t,0)}},{key:"LE",value:function(e,t){return k.__compare(e,t,1)}},{key:"GT",value:function(e,t){return k.__compare(e,t,2)}},{key:"GE",value:function(e,t){return k.__compare(e,t,3)}},{key:"EQ",value:function(e,t){for(;;){if(k.__isBigInt(e))return k.__isBigInt(t)?k.equal(e,t):k.EQ(t,e);if("number"==typeof e){if(k.__isBigInt(t))return k.__equalToNumber(t,e);if("object"!==u(t))return e==t;t=k.__toPrimitive(t)}else if("string"==typeof e){if(k.__isBigInt(t))return null!==(e=k.__fromString(e))&&k.equal(e,t);if("object"!==u(t))return e==t;t=k.__toPrimitive(t)}else if("boolean"==typeof e){if(k.__isBigInt(t))return k.__equalToNumber(t,+e);if("object"!==u(t))return e==t;t=k.__toPrimitive(t)}else if("symbol"===u(e)){if(k.__isBigInt(t))return!1;if("object"!==u(t))return e==t;t=k.__toPrimitive(t)}else{if("object"!==u(e))return e==t;if("object"===u(t)&&t.constructor!==k)return e==t;e=k.__toPrimitive(e)}}}},{key:"NE",value:function(e,t){return!k.EQ(e,t)}},{key:"__zero",value:function(){return new k(0,!1)}},{key:"__oneDigit",value:function(e,t){var r=new k(1,t);return r.__setDigit(0,e),r}},{key:"__decideRounding",value:function(e,t,r,i){if(0<t)return-1;var n;if(t<0)n=-t-1;else{if(0===r)return-1;r--,i=e.__digit(r),n=31}var a=1<<n;if(0==(i&a))return-1;if(0!=(i&(a-=1)))return 1;for(;0<r;)if(r--,0!==e.__digit(r))return 1;return 0}},{key:"__fromDouble",value:function(e){k.__kBitConversionDouble[0]=e;var t,r=(2047&k.__kBitConversionInts[1]>>>20)-1023,i=1+(r>>>5),n=new k(i,e<0),a=1048575&k.__kBitConversionInts[1]|1048576,s=k.__kBitConversionInts[0],o=31&r,u=0;if(o<20){var l=20-o;u=32+l,t=a>>>l,a=a<<32-l|s>>>l,s<<=32-l}else if(20==o)u=32,t=a,a=s;else{var _=o-20;t=a<<_|s>>>(u=32-_),a=s<<_}n.__setDigit(i-1,t);for(var h=i-2;0<=h;h--)0<u?(u-=32,t=a,a=s):t=0,n.__setDigit(h,t);return n.__trim()}},{key:"__isWhitespace",value:function(e){return!!(e<=13&&9<=e)||(e<=159?32==e:e<=131071?160==e||5760==e:e<=196607?(e&=131071)<=10||40==e||41==e||47==e||95==e||4096==e:65279==e)}},{key:"__fromString",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=0,i=e.length,n=0;if(n===i)return k.__zero();for(var a=e.charCodeAt(n);k.__isWhitespace(a);){if(++n===i)return k.__zero();a=e.charCodeAt(n)}if(43===a){if(++n===i)return null;a=e.charCodeAt(n),r=1}else if(45===a){if(++n===i)return null;a=e.charCodeAt(n),r=-1}if(0===t){if(t=10,48===a){if(++n===i)return k.__zero();if(88===(a=e.charCodeAt(n))||120===a){if(t=16,++n===i)return null;a=e.charCodeAt(n)}else if(79===a||111===a){if(t=8,++n===i)return null;a=e.charCodeAt(n)}else if(66===a||98===a){if(t=2,++n===i)return null;a=e.charCodeAt(n)}}}else if(16===t&&48===a){if(++n===i)return k.__zero();if(88===(a=e.charCodeAt(n))||120===a){if(++n===i)return null;a=e.charCodeAt(n)}}for(;48===a;){if(++n===i)return k.__zero();a=e.charCodeAt(n)}var s=i-n,o=k.__kMaxBitsPerChar[t],u=k.__kBitsPerCharTableMultiplier-1;if(1073741824/o<s)return null;var l=new k(31+(o*s+u>>>k.__kBitsPerCharTableShift)>>>5,!1),_=t<10?t:10,h=10<t?t-10:0;if(0==(t&t-1)){o>>=k.__kBitsPerCharTableShift;var c=[],f=[],d=!1;do{for(var p,y=0,v=0;;){if(p=void 0,a-48>>>0<_)p=a-48;else{if(!((32|a)-97>>>0<h)){d=!0;break}p=(32|a)-87}if(v+=o,y=y<<o|p,++n===i){d=!0;break}if(a=e.charCodeAt(n),32<v+o)break}c.push(y),f.push(v)}while(!d);k.__fillFromParts(l,c,f)}else{l.__initializeDigits();var g=!1,b=0;do{for(var m,T=0,w=1;;){if(m=void 0,a-48>>>0<_)m=a-48;else{if(!((32|a)-97>>>0<h)){g=!0;break}m=(32|a)-87}var I=w*t;if(4294967295<I)break;if(w=I,T=T*t+m,b++,++n===i){g=!0;break}a=e.charCodeAt(n)}var S=o*b+(u=32*k.__kBitsPerCharTableMultiplier-1)>>>k.__kBitsPerCharTableShift+5;l.__inplaceMultiplyAdd(w,T,S)}while(!g)}for(;n!==i;){if(!k.__isWhitespace(a))return null;a=e.charCodeAt(n++)}return 0!==r&&10!==t?null:(l.sign=-1===r,l.__trim())}},{key:"__fillFromParts",value:function(e,t,r){for(var i=0,n=0,a=0,s=t.length-1;0<=s;s--){var o=t[s],u=r[s];n|=o<<a,32===(a+=u)?(e.__setDigit(i++,n),n=a=0):32<a&&(e.__setDigit(i++,n),n=o>>>u-(a-=32))}if(0!==n){if(i>=e.length)throw new Error("implementation bug");e.__setDigit(i++,n)}for(;i<e.length;i++)e.__setDigit(i,0)}},{key:"__toStringBasePowerOfTwo",value:function(e,t){var r=e.length,i=t-1,n=i=(15&(i=(51&(i=(85&i>>>1)+(85&i))>>>2)+(51&i))>>>4)+(15&i),a=t-1,s=e.__digit(r-1),o=0|(32*r-b(s)+n-1)/n;if(e.sign&&o++,268435456<o)throw new Error("string too long");for(var u=Array(o),l=o-1,_=0,h=0,c=0;c<r-1;c++){var f=e.__digit(c),d=(_|f<<h)&a;u[l--]=k.__kConversionChars[d];var p=n-h;for(_=f>>>p,h=32-p;n<=h;)u[l--]=k.__kConversionChars[_&a],_>>>=n,h-=n}var y=(_|s<<h)&a;for(u[l--]=k.__kConversionChars[y],_=s>>>n-h;0!==_;)u[l--]=k.__kConversionChars[_&a],_>>>=n;if(e.sign&&(u[l--]="-"),-1!==l)throw new Error("implementation bug");return u.join("")}},{key:"__toStringGeneric",value:function(e,t,r){var i=e.length;if(0===i)return"";if(1===i){var n=e.__unsignedDigit(0).toString(t);return!1===r&&e.sign&&(n="-"+n),n}var a,s,o=32*i-b(e.__digit(i-1)),u=k.__kMaxBitsPerChar[t]-1,l=o*k.__kBitsPerCharTableMultiplier,_=1+(l=0|(l+=u-1)/u)>>1,h=k.exponentiate(k.__oneDigit(t,!1),k.__oneDigit(_,!1)),c=h.__unsignedDigit(0);if(1===h.length&&c<=65535){(a=new k(e.length,!1)).__initializeDigits();for(var f,d=0,p=2*e.length-1;0<=p;p--)f=d<<16|e.__halfDigit(p),a.__setHalfDigit(p,0|f/c),d=0|f%c;s=d.toString(t)}else{var y=k.__absoluteDivLarge(e,h,!0,!0);a=y.quotient;var v=y.remainder.__trim();s=k.__toStringGeneric(v,t,!0)}a.__trim();for(var g=k.__toStringGeneric(a,t,!0);s.length<_;)s="0"+s;return!1===r&&e.sign&&(g="-"+g),g+s}},{key:"__unequalSign",value:function(e){return e?-1:1}},{key:"__absoluteGreater",value:function(e){return e?-1:1}},{key:"__absoluteLess",value:function(e){return e?1:-1}},{key:"__compareToBigInt",value:function(e,t){var r=e.sign;if(r!==t.sign)return k.__unequalSign(r);var i=k.__absoluteCompare(e,t);return 0<i?k.__absoluteGreater(r):i<0?k.__absoluteLess(r):0}},{key:"__compareToNumber",value:function(e,t){if(!0|t){var r=e.sign,i=t<0;if(r!==i)return k.__unequalSign(r);if(0===e.length){if(i)throw new Error("implementation bug");return 0===t?0:-1}if(1<e.length)return k.__absoluteGreater(r);var n=h(t),a=e.__unsignedDigit(0);return n<a?k.__absoluteGreater(r):a<n?k.__absoluteLess(r):0}return k.__compareToDouble(e,t)}},{key:"__compareToDouble",value:function(e,t){if(t!=t)return t;if(t===1/0)return-1;if(t===-1/0)return 1;var r=e.sign;if(r!==t<0)return k.__unequalSign(r);if(0===t)throw new Error("implementation bug: should be handled elsewhere");if(0===e.length)return-1;k.__kBitConversionDouble[0]=t;var i=2047&k.__kBitConversionInts[1]>>>20;if(2047==i)throw new Error("implementation bug: handled elsewhere");var n=i-1023;if(n<0)return k.__absoluteGreater(r);var a=e.length,s=e.__digit(a-1),o=b(s),u=32*a-o,l=1+n;if(u<l)return k.__absoluteLess(r);if(l<u)return k.__absoluteGreater(r);var _=1048576|1048575&k.__kBitConversionInts[1],h=k.__kBitConversionInts[0],c=31-o;if(c!=(u-1)%31)throw new Error("implementation bug");var f,d=0;if(c<20){var p=20-c;d=32+p,f=_>>>p,_=_<<32-p|h>>>p,h<<=32-p}else if(20==c)d=32,f=_,_=h;else{var y=c-20;f=_<<y|h>>>(d=32-y),_=h<<y}if((f>>>=0)<(s>>>=0))return k.__absoluteGreater(r);if(s<f)return k.__absoluteLess(r);for(var v=a-2;0<=v;v--){0<d?(d-=32,f=_>>>0,_=h,h=0):f=0;var g=e.__unsignedDigit(v);if(f<g)return k.__absoluteGreater(r);if(g<f)return k.__absoluteLess(r)}if(0===_&&0===h)return 0;if(0===d)throw new Error("implementation bug");return k.__absoluteLess(r)}},{key:"__equalToNumber",value:function(e,t){return t|0===t?0===t?0===e.length:1===e.length&&e.sign===t<0&&e.__unsignedDigit(0)===h(t):0===k.__compareToDouble(e,t)}},{key:"__comparisonResultToBool",value:function(e,t){switch(t){case 0:return e<0;case 1:return e<=0;case 2:return 0<e;case 3:return 0<=e}throw new Error("unreachable")}},{key:"__compare",value:function(e,t,r){if(e=k.__toPrimitive(e),t=k.__toPrimitive(t),"string"==typeof e&&"string"==typeof t)switch(r){case 0:return e<t;case 1:return e<=t;case 2:return t<e;case 3:return t<=e}if(k.__isBigInt(e)&&"string"==typeof t)return null!==(t=k.__fromString(t))&&k.__comparisonResultToBool(k.__compareToBigInt(e,t),r);if("string"==typeof e&&k.__isBigInt(t))return null!==(e=k.__fromString(e))&&k.__comparisonResultToBool(k.__compareToBigInt(e,t),r);if(e=k.__toNumeric(e),t=k.__toNumeric(t),k.__isBigInt(e)){if(k.__isBigInt(t))return k.__comparisonResultToBool(k.__compareToBigInt(e,t),r);if("number"!=typeof t)throw new Error("implementation bug");return k.__comparisonResultToBool(k.__compareToNumber(e,t),r)}if("number"!=typeof e)throw new Error("implementation bug");if(k.__isBigInt(t))return k.__comparisonResultToBool(k.__compareToNumber(t,e),2^r);if("number"!=typeof t)throw new Error("implementation bug");return 0===r?e<t:1===r?e<=t:2===r?t<e:3===r?t<=e:void 0}},{key:"__absoluteAdd",value:function(e,t,r){if(e.length<t.length)return k.__absoluteAdd(t,e,r);if(0===e.length)return e;if(0===t.length)return e.sign===r?e:k.unaryMinus(e);var i=e.length;(0===e.__clzmsd()||t.length===e.length&&0===t.__clzmsd())&&i++;for(var n=new k(i,r),a=0,s=0;s<t.length;s++){var o=t.__digit(s),u=e.__digit(s),l=(65535&u)+(65535&o)+a,_=(u>>>16)+(o>>>16)+(l>>>16);a=_>>>16,n.__setDigit(s,65535&l|_<<16)}for(;s<e.length;s++){var h=e.__digit(s),c=(65535&h)+a,f=(h>>>16)+(c>>>16);a=f>>>16,n.__setDigit(s,65535&c|f<<16)}return s<n.length&&n.__setDigit(s,a),n.__trim()}},{key:"__absoluteSub",value:function(e,t,r){if(0===e.length)return e;if(0===t.length)return e.sign===r?e:k.unaryMinus(e);for(var i=new k(e.length,r),n=0,a=0;a<t.length;a++){var s=e.__digit(a),o=t.__digit(a),u=(65535&s)-(65535&o)-n,l=(s>>>16)-(o>>>16)-(n=1&u>>>16);n=1&l>>>16,i.__setDigit(a,65535&u|l<<16)}for(;a<e.length;a++){var _=e.__digit(a),h=(65535&_)-n,c=(_>>>16)-(n=1&h>>>16);n=1&c>>>16,i.__setDigit(a,65535&h|c<<16)}return i.__trim()}},{key:"__absoluteAddOne",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=e.length;null===r?r=new k(i,t):r.sign=t;for(var n=!0,a=0;a<i;a++){var s=e.__digit(a),o=-1===s;n&&(s=0|s+1),n=o,r.__setDigit(a,s)}return n&&r.__setDigitGrow(i,1),r}},{key:"__absoluteSubOne",value:function(e,t){for(var r=e.length,i=new k(t=t||r,!1),n=!0,a=0;a<r;a++){var s=e.__digit(a),o=0===s;n&&(s=0|s-1),n=o,i.__setDigit(a,s)}for(var u=r;u<t;u++)i.__setDigit(u,0);return i}},{key:"__absoluteAnd",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=e.length,n=t.length,a=n;if(i<n){var s=e,o=a=i;e=t,i=n,t=s,n=o}var u=a;null===r?r=new k(u,!1):u=r.length;for(var l=0;l<a;l++)r.__setDigit(l,e.__digit(l)&t.__digit(l));for(;l<u;l++)r.__setDigit(l,0);return r}},{key:"__absoluteAndNot",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=e.length,n=t.length,a=n;i<n&&(a=i);var s=i;null===r?r=new k(s,!1):s=r.length;for(var o=0;o<a;o++)r.__setDigit(o,e.__digit(o)&~t.__digit(o));for(;o<i;o++)r.__setDigit(o,e.__digit(o));for(;o<s;o++)r.__setDigit(o,0);return r}},{key:"__absoluteOr",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=e.length,n=t.length,a=n;if(i<n){var s=e,o=a=i;e=t,i=n,t=s,n=o}var u=i;null===r?r=new k(u,!1):u=r.length;for(var l=0;l<a;l++)r.__setDigit(l,e.__digit(l)|t.__digit(l));for(;l<i;l++)r.__setDigit(l,e.__digit(l));for(;l<u;l++)r.__setDigit(l,0);return r}},{key:"__absoluteXor",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=e.length,n=t.length,a=n;if(i<n){var s=e,o=a=i;e=t,i=n,t=s,n=o}var u=i;null===r?r=new k(u,!1):u=r.length;for(var l=0;l<a;l++)r.__setDigit(l,e.__digit(l)^t.__digit(l));for(;l<i;l++)r.__setDigit(l,e.__digit(l));for(;l<u;l++)r.__setDigit(l,0);return r}},{key:"__absoluteCompare",value:function(e,t){var r=e.length-t.length;if(0!=r)return r;for(var i=e.length-1;0<=i&&e.__digit(i)===t.__digit(i);)i--;return i<0?0:e.__unsignedDigit(i)>t.__unsignedDigit(i)?1:-1}},{key:"__multiplyAccumulate",value:function(e,t,r,i){if(0!==t){for(var n=65535&t,a=t>>>16,s=0,o=0,u=0,l=0;l<e.length;l++,i++){var _=r.__digit(i),h=65535&_,c=_>>>16,f=e.__digit(l),d=65535&f,p=f>>>16,y=I(d,n),v=I(d,a),g=I(p,n),b=I(p,a);s=(o=(v>>>16)+(g>>>16)+(65535&b)+(s=(c+=u+s+((h+=o+(65535&y))>>>16)+(y>>>16)+(65535&v)+(65535&g))>>>16))>>>16,o&=65535,u=b>>>16,_=65535&h|c<<16,r.__setDigit(i,_)}for(;0!==s||0!==o||0!==u;i++){var m=r.__digit(i),T=(65535&m)+o,w=(m>>>16)+(T>>>16)+u+s;u=o=0,s=w>>>16,m=65535&T|w<<16,r.__setDigit(i,m)}}}},{key:"__internalMultiplyAdd",value:function(e,t,r,i,n){for(var a=r,s=0,o=0;o<i;o++){var u=e.__digit(o),l=I(65535&u,t),_=(65535&l)+s+a;a=_>>>16;var h=I(u>>>16,t),c=(65535&h)+(l>>>16)+a;a=c>>>16,s=h>>>16,n.__setDigit(o,c<<16|65535&_)}if(n.length>i)for(n.__setDigit(i++,a+s);i<n.length;)n.__setDigit(i++,0);else if(0!==a+s)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(e,t,r){null===r&&(r=new k(e.length,!1));for(var i=0,n=2*e.length-1;0<=n;n-=2){var a=(i<<16|e.__halfDigit(n))>>>0,s=0|a/t,o=0|(a=((i=0|a%t)<<16|e.__halfDigit(n-1))>>>0)/t;i=0|a%t,r.__setDigit(n>>>1,s<<16|o)}return r}},{key:"__absoluteModSmall",value:function(e,t){for(var r=0,i=2*e.length-1;0<=i;i--)r=0|((r<<16|e.__halfDigit(i))>>>0)%t;return r}},{key:"__absoluteDivLarge",value:function(e,t,r,i){var n=t.__halfDigitLength(),a=t.length,s=e.__halfDigitLength()-n,o=null;r&&(o=new k(2+s>>>1,!1)).__initializeDigits();var u=new k(n+2>>>1,!1);u.__initializeDigits();var l=k.__clz16(t.__halfDigit(n-1));0<l&&(t=k.__specialLeftShift(t,l,0));for(var _=k.__specialLeftShift(e,l,1),h=t.__halfDigit(n-1),c=0,f=s;0<=f;f--){var d=65535,p=_.__halfDigit(f+n);if(p!==h){var y=(p<<16|_.__halfDigit(f+n-1))>>>0;d=0|y/h;for(var v=0|y%h,g=t.__halfDigit(n-2),b=_.__halfDigit(f+n-2);I(d,g)>>>0>(v<<16|b)>>>0&&(d--,!(65535<(v+=h))););}k.__internalMultiplyAdd(t,d,0,a,u);var m=_.__inplaceSub(u,f,n+1);0!==m&&(m=_.__inplaceAdd(t,f,n),_.__setHalfDigit(f+n,_.__halfDigit(f+n)+m),d--),r&&(1&f?c=d<<16:o.__setDigit(f>>>1,c|d))}return i?(_.__inplaceRightShift(l),r?{quotient:o,remainder:_}:_):r?o:void 0}},{key:"__clz16",value:function(e){return b(e)-16}},{key:"__specialLeftShift",value:function(e,t,r){var i=e.length,n=new k(i+r,!1);if(0===t){for(var a=0;a<i;a++)n.__setDigit(a,e.__digit(a));return 0<r&&n.__setDigit(i,0),n}for(var s,o=0,u=0;u<i;u++)s=e.__digit(u),n.__setDigit(u,s<<t|o),o=s>>>32-t;return 0<r&&n.__setDigit(i,o),n}},{key:"__leftShiftByAbsolute",value:function(e,t){var r=k.__toShiftAmount(t);if(r<0)throw new RangeError("BigInt too big");var i=r>>>5,n=31&r,a=e.length,s=0!=n&&0!=e.__digit(a-1)>>>32-n,o=a+i+(s?1:0),u=new k(o,e.sign);if(0==n){for(var l=0;l<i;l++)u.__setDigit(l,0);for(;l<o;l++)u.__setDigit(l,e.__digit(l-i))}else{for(var _=0,h=0;h<i;h++)u.__setDigit(h,0);for(var c,f=0;f<a;f++)c=e.__digit(f),u.__setDigit(f+i,c<<n|_),_=c>>>32-n;if(s)u.__setDigit(a+i,_);else if(0!==_)throw new Error("implementation bug")}return u.__trim()}},{key:"__rightShiftByAbsolute",value:function(e,t){var r=e.length,i=e.sign,n=k.__toShiftAmount(t);if(n<0)return k.__rightShiftByMaximum(i);var a=n>>>5,s=31&n,o=r-a;if(o<=0)return k.__rightShiftByMaximum(i);var u=!1;if(i)if(0!=(e.__digit(a)&(1<<s)-1))u=!0;else for(var l=0;l<a;l++)if(0!==e.__digit(l)){u=!0;break}u&&0==s&&0==~e.__digit(r-1)&&o++;var _=new k(o,i);if(0==s)for(var h=a;h<r;h++)_.__setDigit(h-a,e.__digit(h));else{for(var c,f=e.__digit(a)>>>s,d=r-a-1,p=0;p<d;p++)c=e.__digit(p+a+1),_.__setDigit(p,c<<32-s|f),f=c>>>s;_.__setDigit(d,f)}return u&&(_=k.__absoluteAddOne(_,!0,_)),_.__trim()}},{key:"__rightShiftByMaximum",value:function(e){return e?k.__oneDigit(1,!0):k.__zero()}},{key:"__toShiftAmount",value:function(e){if(1<e.length)return-1;var t=e.__unsignedDigit(0);return k.__kMaxLengthBits<t?-1:t}},{key:"__toPrimitive",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==u(e))return e;if(e.constructor===k)return e;var r=e[Symbol.toPrimitive];if(r){var i=r(t);if("object"!==u(i))return i;throw new TypeError("Cannot convert object to primitive value")}var n=e.valueOf;if(n){var a=n.call(e);if("object"!==u(a))return a}var s=e.toString;if(s){var o=s.call(e);if("object"!==u(o))return o}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(e){return k.__isBigInt(e)?e:+e}},{key:"__isBigInt",value:function(e){return"object"===u(e)&&e.constructor===k}},{key:"__truncateToNBits",value:function(e,t){for(var r=e+31>>>5,i=new k(r,t.sign),n=r-1,a=0;a<n;a++)i.__setDigit(a,t.__digit(a));var s=t.__digit(n);if(0!=(31&e)){var o=32-(31&e);s=s<<o>>>o}return i.__setDigit(n,s),i.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(e,t,r){for(var i=Math.min,n=e+31>>>5,a=new k(n,r),s=0,o=n-1,u=0,l=i(o,t.length);s<l;s++){var _=t.__digit(s),h=0-(65535&_)-u,c=0-(_>>>16)-(u=1&h>>>16);u=1&c>>>16,a.__setDigit(s,65535&h|c<<16)}for(;s<o;s++)a.__setDigit(s,0|-u);var f,d=o<t.length?t.__digit(o):0,p=31&e;if(0==p){var y=0-(65535&d)-u;f=65535&y|0-(d>>>16)-(u=1&y>>>16)<<16}else{var v=32-p,g=1<<32-v,b=(65535&g)-(65535&(d=d<<v>>>v))-u;f=65535&b|(g>>>16)-(d>>>16)-(u=1&b>>>16)<<16,f&=g-1}return a.__setDigit(o,f),a.__trim()}},{key:"__digitPow",value:function(e,t){for(var r=1;0<t;)1&t&&(r*=e),t>>>=1,e*=e;return r}}],(o=[{key:"toDebugString",value:function(){var e=["BigInt["],t=!0,r=!1,i=void 0;try{for(var n,a,s=this[Symbol.iterator]();!(t=(n=s.next()).done);t=!0)a=n.value,e.push((a?(a>>>0).toString(16):a)+", ")}catch(e){r=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw i}}return e.push("]"),e.join("")}},{key:"toString",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(e<2||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(e&e-1)?k.__toStringBasePowerOfTwo(this,e):k.__toStringGeneric(this,e,!1)}},{key:"__copy",value:function(){for(var e=new k(this.length,this.sign),t=0;t<this.length;t++)e[t]=this[t];return e}},{key:"__trim",value:function(){for(var e=this.length,t=this[e-1];0===t;)t=this[--e-1],this.pop();return 0===e&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var e=0;e<this.length;e++)this[e]=0}},{key:"__clzmsd",value:function(){return b(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(e,t,r){r>this.length&&(r=this.length);for(var i=65535&e,n=e>>>16,a=0,s=65535&t,o=t>>>16,u=0;u<r;u++){var l=this.__digit(u),_=65535&l,h=l>>>16,c=I(_,i),f=I(_,n),d=I(h,i),p=I(h,n),y=s+(65535&c),v=o+a+(y>>>16)+(c>>>16)+(65535&f)+(65535&d);a=(s=(f>>>16)+(d>>>16)+(65535&p)+(v>>>16))>>>16,s&=65535,o=p>>>16,this.__setDigit(u,65535&y|v<<16)}if(0!==a||0!==s||0!==o)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(e,t,r){for(var i,n=0,a=0;a<r;a++)n=(i=this.__halfDigit(t+a)+e.__halfDigit(a)+n)>>>16,this.__setHalfDigit(t+a,i);return n}},{key:"__inplaceSub",value:function(e,t,r){var i=0;if(1&t){t>>=1;for(var n=this.__digit(t),a=65535&n,s=0;s<r-1>>>1;s++){var o=e.__digit(s),u=(n>>>16)-(65535&o)-i;i=1&u>>>16,this.__setDigit(t+s,u<<16|65535&a),i=1&(a=(65535&(n=this.__digit(t+s+1)))-(o>>>16)-i)>>>16}var l=e.__digit(s),_=(n>>>16)-(65535&l)-i;if(i=1&_>>>16,this.__setDigit(t+s,_<<16|65535&a),t+s+1>=this.length)throw new RangeError("out of bounds");0==(1&r)&&(i=1&(a=(65535&(n=this.__digit(t+s+1)))-(l>>>16)-i)>>>16,this.__setDigit(t+e.length,4294901760&n|65535&a))}else{t>>=1;for(var h=0;h<e.length-1;h++){var c=this.__digit(t+h),f=e.__digit(h),d=(65535&c)-(65535&f)-i,p=(c>>>16)-(f>>>16)-(i=1&d>>>16);i=1&p>>>16,this.__setDigit(t+h,p<<16|65535&d)}var y=this.__digit(t+h),v=e.__digit(h),g=(65535&y)-(65535&v)-i;i=1&g>>>16;var b=0;0==(1&r)&&(i=1&(b=(y>>>16)-(v>>>16)-i)>>>16),this.__setDigit(t+h,b<<16|65535&g)}return i}},{key:"__inplaceRightShift",value:function(e){if(0!==e){for(var t,r=this.__digit(0)>>>e,i=this.length-1,n=0;n<i;n++)t=this.__digit(n+1),this.__setDigit(n,t<<32-e|r),r=t>>>e;this.__setDigit(i,r)}}},{key:"__digit",value:function(e){return this[e]}},{key:"__unsignedDigit",value:function(e){return this[e]>>>0}},{key:"__setDigit",value:function(e,t){this[e]=0|t}},{key:"__setDigitGrow",value:function(e,t){this[e]=0|t}},{key:"__halfDigitLength",value:function(){var e=this.length;return this.__unsignedDigit(e-1)<=65535?2*e-1:2*e}},{key:"__halfDigit",value:function(e){return 65535&this[e>>>1]>>>((1&e)<<4)}},{key:"__setHalfDigit",value:function(e,t){var r=e>>>1,i=this.__digit(r),n=1&e?65535&i|t<<16:4294901760&i|65535&t;this.__setDigit(r,n)}}])&&e(r.prototype,o),void(l&&e(r,l)),k);function k(e,t){var r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,k),k.__kMaxLength<e)throw new RangeError("Maximum BigInt size exceeded");return(r=s(this,i(k).call(this,e))).sign=t,r}return f.__kMaxLength=33554432,f.__kMaxLengthBits=f.__kMaxLength<<5,f.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],f.__kBitsPerCharTableShift=5,f.__kBitsPerCharTableMultiplier=1<<f.__kBitsPerCharTableShift,f.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],f.__kBitConversionBuffer=new ArrayBuffer(8),f.__kBitConversionDouble=new Float64Array(f.__kBitConversionBuffer),f.__kBitConversionInts=new Int32Array(f.__kBitConversionBuffer),f},"object"==typeof r&&void 0!==t?t.exports=n():(i=i||self).JSBI=n()},{}]},{},[3])(3)});